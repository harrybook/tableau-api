/*! tableau-2.0.3 */
(function(){
/*! BEGIN MscorlibSlim */
var global={};(function(global){"use strict";var ss={__assemblies:{}};ss.initAssembly=function assembly(obj,name,res){res=res||{};obj.name=name;obj.toString=function(){return this.name};obj.__types={};obj.getResourceNames=function(){return Object.keys(res)};obj.getResourceDataBase64=function(name){return res[name]||null};obj.getResourceData=function(name){var r=res[name];return r?ss.dec64(r):null};ss.__assemblies[name]=obj};ss.initAssembly(ss,'mscorlib');ss.getAssemblies=function ss$getAssemblies(){return Object.keys(ss.__assemblies).map(function(n){return ss.__assemblies[n]})};ss.isNullOrUndefined=function ss$isNullOrUndefined(o){return(o===null)||(o===undefined)};ss.isValue=function ss$isValue(o){return(o!==null)&&(o!==undefined)};ss.referenceEquals=function ss$referenceEquals(a,b){return ss.isValue(a)?a===b:!ss.isValue(b)};ss.mkdict=function ss$mkdict(){var a=(arguments.length!=1?arguments:arguments[0]);var r={};for(var i=0;i<a.length;i+=2){r[a[i]]=a[i+1]}return r};ss.clone=function ss$clone(t,o){return o?t.$clone(o):o};ss.coalesce=function ss$coalesce(a,b){return ss.isValue(a)?a:b};ss.isDate=function ss$isDate(obj){return Object.prototype.toString.call(obj)==='[object Date]'};ss.isArray=function ss$isArray(obj){return Object.prototype.toString.call(obj)==='[object Array]'};ss.isTypedArrayType=function ss$isTypedArrayType(type){return['Float32Array','Float64Array','Int8Array','Int16Array','Int32Array','Uint8Array','Uint16Array','Uint32Array','Uint8ClampedArray'].indexOf(ss.getTypeFullName(type))>=0};ss.isArrayOrTypedArray=function ss$isArray(obj){return ss.isArray(obj)||ss.isTypedArrayType(ss.getInstanceType(obj))};ss.getHashCode=function ss$getHashCode(obj){if(!ss.isValue(obj))throw new ss_NullReferenceException('Cannot get hash code of null');else if(typeof(obj.getHashCode)==='function')return obj.getHashCode();else if(typeof(obj)==='boolean'){return obj?1:0}else if(typeof(obj)==='number'){var s=obj.toExponential();s=s.substr(0,s.indexOf('e'));return parseInt(s.replace('.',''),10)&0xffffffff}else if(typeof(obj)==='string'){var res=0;for(var i=0;i<obj.length;i++)res=(res*31+obj.charCodeAt(i))&0xffffffff;return res}else if(ss.isDate(obj)){return obj.valueOf()&0xffffffff}else{return ss.defaultHashCode(obj)}};ss.defaultHashCode=function ss$defaultHashCode(obj){return obj.$__hashCode__||(obj.$__hashCode__=(Math.random()*0x100000000)|0)};ss.equals=function ss$equals(a,b){if(!ss.isValue(a))throw new ss_NullReferenceException('Object is null');else if(a!==ss&&typeof(a.equals)==='function')return a.equals(b);if(ss.isDate(a)&&ss.isDate(b))return a.valueOf()===b.valueOf();else if(typeof(a)==='function'&&typeof(b)==='function')return ss.delegateEquals(a,b);else if(ss.isNullOrUndefined(a)&&ss.isNullOrUndefined(b))return true;else return a===b};ss.compare=function ss$compare(a,b){if(!ss.isValue(a))throw new ss_NullReferenceException('Object is null');else if(typeof(a)==='number'||typeof(a)==='string'||typeof(a)==='boolean')return a<b?-1:(a>b?1:0);else if(ss.isDate(a))return ss.compare(a.valueOf(),b.valueOf());else return a.compareTo(b)};ss.equalsT=function ss$equalsT(a,b){if(!ss.isValue(a))throw new ss_NullReferenceException('Object is null');else if(typeof(a)==='number'||typeof(a)==='string'||typeof(a)==='boolean')return a===b;else if(ss.isDate(a))return a.valueOf()===b.valueOf();else return a.equalsT(b)};ss.staticEquals=function ss$staticEquals(a,b){if(!ss.isValue(a))return!ss.isValue(b);else return ss.isValue(b)?ss.equals(a,b):false};ss.shallowCopy=function ss$shallowCopy(source,target){var keys=Object.keys(source);for(var i=0,l=keys.length;i<l;i++){var k=keys[i];target[k]=source[k]}};ss.isLower=function ss$isLower(c){var s=String.fromCharCode(c);return s===s.toLowerCase()&&s!==s.toUpperCase()};ss.isUpper=function ss$isUpper(c){var s=String.fromCharCode(c);return s!==s.toLowerCase()&&s===s.toUpperCase()};if(typeof(window)=='object'){if(!window.Element){window.Element=function(){};window.Element.isInstanceOfType=function(instance){return instance&&typeof instance.constructor==='undefined'&&typeof instance.tagName==='string'}}window.Element.__typeName='Element'}ss.clearKeys=function ss$clearKeys(d){for(var n in d){if(d.hasOwnProperty(n))delete d[n]}};ss.keyExists=function ss$keyExists(d,key){return d[key]!==undefined};if(!Object.keys){Object.keys=(function(){var hasOwnProperty=Object.prototype.hasOwnProperty,hasDontEnumBug=!({toString:null}).propertyIsEnumerable('toString'),dontEnums=['toString','toLocaleString','valueOf','hasOwnProperty','isPrototypeOf','propertyIsEnumerable','constructor'],dontEnumsLength=dontEnums.length;return function(obj){if(typeof obj!=='object'&&(typeof obj!=='function'||obj===null)){throw new TypeError('Object.keys called on non-object')}var result=[],prop,i;for(prop in obj){if(hasOwnProperty.call(obj,prop)){result.push(prop)}}if(hasDontEnumBug){for(i=0;i<dontEnumsLength;i++){if(hasOwnProperty.call(obj,dontEnums[i])){result.push(dontEnums[i])}}}return result}}())}ss.getKeyCount=function ss$getKeyCount(d){return Object.keys(d).length};ss.__genericCache={};ss._makeGenericTypeName=function ss$_makeGenericTypeName(genericType,typeArguments){var result=genericType.__typeName;for(var i=0;i<typeArguments.length;i++)result+=(i===0?'[':',')+'['+ss.getTypeQName(typeArguments[i])+']';result+=']';return result};ss.makeGenericType=function ss$makeGenericType(genericType,typeArguments){var name=ss._makeGenericTypeName(genericType,typeArguments);return ss.__genericCache[name]||genericType.apply(null,typeArguments)};ss.registerGenericClassInstance=function ss$registerGenericClassInstance(instance,genericType,typeArguments,members,baseType,interfaceTypes){var name=ss._makeGenericTypeName(genericType,typeArguments);ss.__genericCache[name]=instance;instance.__typeName=name;instance.__genericTypeDefinition=genericType;instance.__typeArguments=typeArguments;ss.initClass(instance,genericType.__assembly,members,baseType(),interfaceTypes())};ss.registerGenericInterfaceInstance=function ss$registerGenericInterfaceInstance(instance,genericType,typeArguments,members,baseInterfaces){var name=ss._makeGenericTypeName(genericType,typeArguments);ss.__genericCache[name]=instance;instance.__typeName=name;instance.__genericTypeDefinition=genericType;instance.__typeArguments=typeArguments;ss.initInterface(instance,genericType.__assembly,members,baseInterfaces())};ss.isGenericTypeDefinition=function ss$isGenericTypeDefinition(type){return type.__isGenericTypeDefinition||false};ss.getGenericTypeDefinition=function ss$getGenericTypeDefinition(type){return type.__genericTypeDefinition||null};ss.getGenericParameterCount=function ss$getGenericParameterCount(type){return type.__typeArgumentCount||0};ss.getGenericArguments=function ss$getGenericArguments(type){return type.__typeArguments||null};ss.setMetadata=function ss$_setMetadata(type,metadata){if(metadata.members){for(var i=0;i<metadata.members.length;i++){var m=metadata.members[i];m.typeDef=type;if(m.adder)m.adder.typeDef=type;if(m.remover)m.remover.typeDef=type;if(m.getter)m.getter.typeDef=type;if(m.setter)m.setter.typeDef=type}}type.__metadata=metadata;if(metadata.variance){type.isAssignableFrom=function(source){var check=function(target,type){if(type.__genericTypeDefinition===target.__genericTypeDefinition&&type.__typeArguments.length==target.__typeArguments.length){for(var i=0;i<target.__typeArguments.length;i++){var v=target.__metadata.variance[i],t=target.__typeArguments[i],s=type.__typeArguments[i];switch(v){case 1:if(!ss.isAssignableFrom(t,s))return false;break;case 2:if(!ss.isAssignableFrom(s,t))return false;break;default:if(s!==t)return false}}return true}return false};if(source.__interface&&check(this,source))return true;var ifs=ss.getInterfaces(source);for(var i=0;i<ifs.length;i++){if(ifs[i]===this||check(this,ifs[i]))return true}return false}}};ss.setMetadata=function ss$_setMetadata(type,metadata){};ss.initClass=function ss$initClass(ctor,asm,members,baseType,interfaces){ctor.__class=true;ctor.__assembly=asm;if(!ctor.__typeArguments)asm.__types[ctor.__typeName]=ctor;if(baseType&&baseType!==Object){var f=function(){};f.prototype=baseType.prototype;ctor.prototype=new f;ctor.prototype.constructor=ctor}ss.shallowCopy(members,ctor.prototype);if(interfaces)ctor.__interfaces=interfaces};ss.initGenericClass=function ss$initGenericClass(ctor,asm,typeArgumentCount){ctor.__class=true;ctor.__assembly=asm;asm.__types[ctor.__typeName]=ctor;ctor.__typeArgumentCount=typeArgumentCount;ctor.__isGenericTypeDefinition=true};ss.initInterface=function ss$initInterface(ctor,asm,members,baseInterfaces){ctor.__interface=true;ctor.__assembly=asm;if(!ctor.__typeArguments)asm.__types[ctor.__typeName]=ctor;if(baseInterfaces)ctor.__interfaces=baseInterfaces;ss.shallowCopy(members,ctor.prototype);ctor.isAssignableFrom=function(type){return ss.contains(ss.getInterfaces(type),this)}};ss.initGenericInterface=function ss$initGenericClass(ctor,asm,typeArgumentCount){ctor.__interface=true;ctor.__assembly=asm;asm.__types[ctor.__typeName]=ctor;ctor.__typeArgumentCount=typeArgumentCount;ctor.__isGenericTypeDefinition=true};ss.initEnum=function ss$initEnum(ctor,asm,members,namedValues){ctor.__enum=true;ctor.__assembly=asm;asm.__types[ctor.__typeName]=ctor;ss.shallowCopy(members,ctor.prototype);ctor.getDefaultValue=ctor.createInstance=function(){return namedValues?null:0};ctor.isInstanceOfType=function(instance){return typeof(instance)==(namedValues?'string':'number')}};ss.getBaseType=function ss$getBaseType(type){if(type===Object||type.__interface){return null}else if(Object.getPrototypeOf){return Object.getPrototypeOf(type.prototype).constructor}else{var p=type.prototype;if(Object.prototype.hasOwnProperty.call(p,'constructor')){try{var ownValue=p.constructor;delete p.constructor;return p.constructor}finally{p.constructor=ownValue}}return p.constructor}};ss.getTypeFullName=function ss$getTypeFullName(type){return type.__typeName||type.name||(type.toString().match(/^\s*function\s*([^\s(]+)/)||[])[1]||'Object'};ss.getTypeQName=function ss$getTypeFullName(type){return ss.getTypeFullName(type)+(type.__assembly?', '+type.__assembly.name:'')};ss.getTypeName=function ss$getTypeName(type){var fullName=ss.getTypeFullName(type);var bIndex=fullName.indexOf('[');var nsIndex=fullName.lastIndexOf('.',bIndex>=0?bIndex:fullName.length);return nsIndex>0?fullName.substr(nsIndex+1):fullName};ss.getTypeNamespace=function ss$getTypeNamespace(type){var fullName=ss.getTypeFullName(type);var bIndex=fullName.indexOf('[');var nsIndex=fullName.lastIndexOf('.',bIndex>=0?bIndex:fullName.length);return nsIndex>0?fullName.substr(0,nsIndex):''};ss.getTypeAssembly=function ss$getTypeAssembly(type){if(ss.contains([Date,Number,Boolean,String,Function,Array],type))return ss;else return type.__assembly||null};ss._getAssemblyType=function ss$_getAssemblyType(asm,name){var result=[];if(asm.__types){return asm.__types[name]||null}else{var a=name.split('.');for(var i=0;i<a.length;i++){asm=asm[a[i]];if(!ss.isValue(asm))return null}if(typeof asm!=='function')return null;return asm}};ss.getAssemblyTypes=function ss$getAssemblyTypes(asm){var result=[];if(asm.__types){for(var t in asm.__types){if(asm.__types.hasOwnProperty(t))result.push(asm.__types[t])}}else{var traverse=function(s,n){for(var c in s){if(s.hasOwnProperty(c))traverse(s[c],c)}if(typeof(s)==='function'&&ss.isUpper(n.charCodeAt(0)))result.push(s)};traverse(asm,'')}return result};ss.createAssemblyInstance=function ss$createAssemblyInstance(asm,typeName){var t=ss.getType(typeName,asm);return t?ss.createInstance(t):null};ss.getInterfaces=function ss$getInterfaces(type){if(type.__interfaces)return type.__interfaces;else if(type===Date||type===Number)return[ss_IEquatable,ss_IComparable,ss_IFormattable];else if(type===Boolean||type===String)return[ss_IEquatable,ss_IComparable];else if(type===Array||ss.isTypedArrayType(type))return[ss_IEnumerable,ss_ICollection,ss_IList];else return[]};ss.isInstanceOfType=function ss$isInstanceOfType(instance,type){if(ss.isNullOrUndefined(instance))return false;if(typeof(type.isInstanceOfType)==='function')return type.isInstanceOfType(instance);return ss.isAssignableFrom(type,ss.getInstanceType(instance))};ss.isAssignableFrom=function ss$isAssignableFrom(target,type){return target===type||(typeof(target.isAssignableFrom)==='function'&&target.isAssignableFrom(type))||type.prototype instanceof target};ss.isClass=function Type$isClass(type){return(type.__class==true||type===Array||type===Function||type===RegExp||type===String||type===Error||type===Object)};ss.isEnum=function Type$isEnum(type){return!!type.__enum};ss.isFlags=function Type$isFlags(type){return type.__metadata&&type.__metadata.enumFlags||false};ss.isInterface=function Type$isInterface(type){return!!type.__interface};ss.safeCast=function ss$safeCast(instance,type){if(type===true)return instance;else if(type===false)return null;else return ss.isInstanceOfType(instance,type)?instance:null};ss.cast=function ss$cast(instance,type){if(instance===null||typeof(instance)==='undefined')return instance;else if(type===true||(type!==false&&ss.isInstanceOfType(instance,type)))return instance;throw new ss_InvalidCastException('Cannot cast object to type '+ss.getTypeFullName(type))};ss.getInstanceType=function ss$getInstanceType(instance){if(!ss.isValue(instance))throw new ss_NullReferenceException('Cannot get type of null');try{return instance.constructor}catch(ex){return Object}};ss._getType=function(typeName,asm,re){var outer=!re;re=re||/[[,\]]/g;var last=re.lastIndex,m=re.exec(typeName),tname,targs=[];if(m){tname=typeName.substring(last,m.index);switch(m[0]){case'[':if(typeName[m.index+1]!='[')return null;for(;;){re.exec(typeName);var t=ss._getType(typeName,global,re);if(!t)return null;targs.push(t);m=re.exec(typeName);if(m[0]===']')break;else if(m[0]!==',')return null}m=re.exec(typeName);if(m&&m[0]===','){re.exec(typeName);if(!(asm=ss.__assemblies[(re.lastIndex>0?typeName.substring(m.index+1,re.lastIndex-1):typeName.substring(m.index+1)).trim()]))return null}break;case']':break;case',':re.exec(typeName);if(!(asm=ss.__assemblies[(re.lastIndex>0?typeName.substring(m.index+1,re.lastIndex-1):typeName.substring(m.index+1)).trim()]))return null;break}}else{tname=typeName.substring(last)}if(outer&&re.lastIndex)return null;var t=ss._getAssemblyType(asm,tname.trim());return targs.length?ss.makeGenericType(t,targs):t};ss.getType=function ss$getType(typeName,asm){return typeName?ss._getType(typeName,asm||global):null};ss.getDefaultValue=function ss$getDefaultValue(type){if(typeof(type.getDefaultValue)==='function')return type.getDefaultValue();else if(type===Boolean)return false;else if(type===Date)return new Date(0);else if(type===Number)return 0;return null};ss.createInstance=function ss$createInstance(type){if(typeof(type.createInstance)==='function')return type.createInstance();else if(type===Boolean)return false;else if(type===Date)return new Date(0);else if(type===Number)return 0;else if(type===String)return'';else return new type};var ss_IFormattable=function IFormattable$(){};ss_IFormattable.__typeName='ss.IFormattable';ss.IFormattable=ss_IFormattable;ss.initInterface(ss_IFormattable,ss,{format:null});var ss_IComparable=function IComparable$(){};ss_IComparable.__typeName='ss.IComparable';ss.IComparable=ss_IComparable;ss.initInterface(ss_IComparable,ss,{compareTo:null});var ss_IEquatable=function IEquatable$(){};ss_IEquatable.__typeName='ss.IEquatable';ss.IEquatable=ss_IEquatable;ss.initInterface(ss_IEquatable,ss,{equalsT:null});ss.isNullOrEmptyString=function ss$isNullOrEmptyString(s){return!s||!s.length};if(!String.prototype.trim){String.prototype.trim=function String$trim(){return ss.trimStartString(ss.trimEndString(this))}}ss.trimEndString=function ss$trimEndString(s,chars){return s.replace(chars?new RegExp('['+String.fromCharCode.apply(null,chars)+']+$'):/\s*$/,'')};ss.trimStartString=function ss$trimStartString(s,chars){return s.replace(chars?new RegExp('^['+String.fromCharCode.apply(null,chars)+']+'):/^\s*/,'')};ss.trimString=function ss$trimString(s,chars){return ss.trimStartString(ss.trimEndString(s,chars),chars)};ss.arrayClone=function ss$arrayClone(arr){if(arr.length===1){return[arr[0]]}else{return Array.apply(null,arr)}};if(!Array.prototype.map){Array.prototype.map=function Array$map(callback,instance){var length=this.length;var mapped=new Array(length);for(var i=0;i<length;i++){if(i in this){mapped[i]=callback.call(instance,this[i],i,this)}}return mapped}}if(!Array.prototype.some){Array.prototype.some=function Array$some(callback,instance){var length=this.length;for(var i=0;i<length;i++){if(i in this&&callback.call(instance,this[i],i,this)){return true}}return false}}if(!Array.prototype.forEach){Array.prototype.forEach=function(callback,thisArg){var T,k;if(this==null){throw new TypeError(' this is null or not defined')}var O=Object(this);var len=O.length>>>0;if(typeof callback!=="function"){throw new TypeError(callback+' is not a function')}if(arguments.length>1){T=thisArg}k=0;while(k<len){var kValue;if(k in O){kValue=O[k];callback.call(T,kValue,k,O)}k++}}}if(!Array.prototype.filter){Array.prototype.filter=function(fun){if(this===void 0||this===null){throw new TypeError}var t=Object(this);var len=t.length>>>0;if(typeof fun!=='function'){throw new TypeError}var res=[];var thisArg=arguments.length>=2?arguments[1]:void 0;for(var i=0;i<len;i++){if(i in t){var val=t[i];if(fun.call(thisArg,val,i,t)){res.push(val)}}}return res}}ss._delegateContains=function ss$_delegateContains(targets,object,method){for(var i=0;i<targets.length;i+=2){if(targets[i]===object&&targets[i+1]===method){return true}}return false};ss._mkdel=function ss$_mkdel(targets){var delegate=function(){if(targets.length==2){return targets[1].apply(targets[0],arguments)}else{var clone=ss.arrayClone(targets);for(var i=0;i<clone.length;i+=2){if(ss._delegateContains(targets,clone[i],clone[i+1])){clone[i+1].apply(clone[i],arguments)}}return null}};delegate._targets=targets;return delegate};ss.mkdel=function ss$mkdel(object,method){if(!object){return method}return ss._mkdel([object,method])};ss.delegateCombine=function ss$delegateCombine(delegate1,delegate2){if(!delegate1){if(!delegate2._targets){return ss.mkdel(null,delegate2)}return delegate2}if(!delegate2){if(!delegate1._targets){return ss.mkdel(null,delegate1)}return delegate1}var targets1=delegate1._targets?delegate1._targets:[null,delegate1];var targets2=delegate2._targets?delegate2._targets:[null,delegate2];return ss._mkdel(targets1.concat(targets2))};ss.delegateRemove=function ss$delegateRemove(delegate1,delegate2){if(!delegate1||(delegate1===delegate2)){return null}if(!delegate2){return delegate1}var targets=delegate1._targets;var object=null;var method;if(delegate2._targets){object=delegate2._targets[0];method=delegate2._targets[1]}else{method=delegate2}for(var i=0;i<targets.length;i+=2){if((targets[i]===object)&&(targets[i+1]===method)){if(targets.length==2){return null}var t=ss.arrayClone(targets);t.splice(i,2);return ss._mkdel(t)}}return delegate1};ss.delegateEquals=function ss$delegateEquals(a,b){if(a===b)return true;if(!a._targets&&!b._targets)return false;var ta=a._targets||[null,a],tb=b._targets||[null,b];if(ta.length!=tb.length)return false;for(var i=0;i<ta.length;i++){if(ta[i]!==tb[i])return false}return true};var ss_Enum=function Enum$(){};ss_Enum.__typeName='ss.Enum';ss.Enum=ss_Enum;ss.initClass(ss_Enum,ss,{});ss_Enum.getValues=function Enum$getValues(enumType){var parts=[];var values=enumType.prototype;for(var i in values){if(values.hasOwnProperty(i))parts.push(values[i])}return parts};var ss_IEnumerator=function IEnumerator$(){};ss_IEnumerator.__typeName='ss.IEnumerator';ss.IEnumerator=ss_IEnumerator;ss.initInterface(ss_IEnumerator,ss,{current:null,moveNext:null,reset:null},[ss_IDisposable]);var ss_IEnumerable=function IEnumerable$(){};ss_IEnumerable.__typeName='ss.IEnumerable';ss.IEnumerable=ss_IEnumerable;ss.initInterface(ss_IEnumerable,ss,{getEnumerator:null});ss.getEnumerator=function ss$getEnumerator(obj){return obj.getEnumerator?obj.getEnumerator():new ss_ArrayEnumerator(obj)};var ss_ICollection=function ICollection$(){};ss_ICollection.__typeName='ss.ICollection';ss.ICollection=ss_ICollection;ss.initInterface(ss_ICollection,ss,{get_count:null,add:null,clear:null,contains:null,remove:null});ss.count=function ss$count(obj){return obj.get_count?obj.get_count():obj.length};ss.add=function ss$add(obj,item){if(obj.add)obj.add(item);else if(ss.isArray(obj))obj.push(item);else throw new ss_NotSupportedException};ss.clear=function ss$clear(obj){if(obj.clear)obj.clear();else if(ss.isArray(obj))obj.length=0;else throw new ss_NotSupportedException};ss.remove=function ss$remove(obj,item){if(obj.remove)return obj.remove(item);else if(ss.isArray(obj)){var index=ss.indexOf(obj,item);if(index>=0){obj.splice(index,1);return true}return false}else throw new ss_NotSupportedException};ss.contains=function ss$contains(obj,item){if(obj.contains)return obj.contains(item);else return ss.indexOf(obj,item)>=0};var ss_IEqualityComparer=function IEqualityComparer$(){};ss_IEqualityComparer.__typeName='ss.IEqualityComparer';ss.IEqualityComparer=ss_IEqualityComparer;ss.initInterface(ss_IEqualityComparer,ss,{areEqual:null,getObjectHashCode:null});var ss_IComparer=function IComparer$(){};ss_IComparer.__typeName='ss.IComparer';ss.IComparer=ss_IComparer;ss.initInterface(ss_IComparer,ss,{compare:null});ss.unbox=function ss$unbox(instance){if(!ss.isValue(instance))throw new ss_InvalidOperationException('Nullable object must have a value.');return instance};var ss_Nullable$1=function Nullable$1$(T){var $type=function(){};$type.isInstanceOfType=function(instance){return ss.isInstanceOfType(instance,T)};ss.registerGenericClassInstance($type,ss_Nullable$1,[T],{},function(){return null},function(){return[]});return $type};ss_Nullable$1.__typeName='ss.Nullable$1';ss.Nullable$1=ss_Nullable$1;ss.initGenericClass(ss_Nullable$1,ss,1);ss_Nullable$1.eq=function Nullable$eq(a,b){return!ss.isValue(a)?!ss.isValue(b):(a===b)};ss_Nullable$1.ne=function Nullable$eq(a,b){return!ss.isValue(a)?ss.isValue(b):(a!==b)};ss_Nullable$1.le=function Nullable$le(a,b){return ss.isValue(a)&&ss.isValue(b)&&a<=b};ss_Nullable$1.ge=function Nullable$ge(a,b){return ss.isValue(a)&&ss.isValue(b)&&a>=b};ss_Nullable$1.lt=function Nullable$lt(a,b){return ss.isValue(a)&&ss.isValue(b)&&a<b};ss_Nullable$1.gt=function Nullable$gt(a,b){return ss.isValue(a)&&ss.isValue(b)&&a>b};ss_Nullable$1.sub=function Nullable$sub(a,b){return ss.isValue(a)&&ss.isValue(b)?a-b:null};ss_Nullable$1.add=function Nullable$add(a,b){return ss.isValue(a)&&ss.isValue(b)?a+b:null};ss_Nullable$1.mod=function Nullable$mod(a,b){return ss.isValue(a)&&ss.isValue(b)?a%b:null};ss_Nullable$1.div=function Nullable$divf(a,b){return ss.isValue(a)&&ss.isValue(b)?a/b:null};ss_Nullable$1.mul=function Nullable$mul(a,b){return ss.isValue(a)&&ss.isValue(b)?a*b:null};ss_Nullable$1.band=function Nullable$band(a,b){return ss.isValue(a)&&ss.isValue(b)?a&b:null};ss_Nullable$1.bor=function Nullable$bor(a,b){return ss.isValue(a)&&ss.isValue(b)?a|b:null};ss_Nullable$1.xor=function Nullable$xor(a,b){return ss.isValue(a)&&ss.isValue(b)?a^b:null};ss_Nullable$1.shl=function Nullable$shl(a,b){return ss.isValue(a)&&ss.isValue(b)?a<<b:null};ss_Nullable$1.srs=function Nullable$srs(a,b){return ss.isValue(a)&&ss.isValue(b)?a>>b:null};ss_Nullable$1.sru=function Nullable$sru(a,b){return ss.isValue(a)&&ss.isValue(b)?a>>>b:null};ss_Nullable$1.and=function Nullable$and(a,b){if(a===true&&b===true)return true;else if(a===false||b===false)return false;else return null};ss_Nullable$1.or=function Nullable$or(a,b){if(a===true||b===true)return true;else if(a===false&&b===false)return false;else return null};ss_Nullable$1.not=function Nullable$not(a){return ss.isValue(a)?!a:null};ss_Nullable$1.neg=function Nullable$neg(a){return ss.isValue(a)?-a:null};ss_Nullable$1.pos=function Nullable$pos(a){return ss.isValue(a)?+a:null};ss_Nullable$1.cpl=function Nullable$cpl(a){return ss.isValue(a)?~a:null};ss_Nullable$1.lift=function Nullable$lift(){for(var i=0;i<arguments.length;i++){if(!ss.isValue(arguments[i]))return null}return arguments[0].apply(null,Array.prototype.slice.call(arguments,1))};var ss_IList=function IList$(){};ss_IList.__typeName='ss.IList';ss.IList=ss_IList;ss.initInterface(ss_IList,ss,{get_item:null,set_item:null,indexOf:null,insert:null,removeAt:null},[ss_ICollection,ss_IEnumerable]);ss.getItem=function ss$getItem(obj,index){return obj.get_item?obj.get_item(index):obj[index]};ss.setItem=function ss$setItem(obj,index,value){obj.set_item?obj.set_item(index,value):(obj[index]=value)};ss.indexOf=function ss$indexOf(obj,item){var itemType=typeof(item);if((!item||typeof(item.equals)!=='function')&&typeof(obj.indexOf)==='function'){return obj.indexOf(item)}else if(ss.isArrayOrTypedArray(obj)){for(var i=0;i<obj.length;i++){if(ss.staticEquals(obj[i],item)){return i}}return-1}else return obj.indexOf(item)};ss.insert=function ss$insert(obj,index,item){if(obj.insert)obj.insert(index,item);else if(ss.isArray(obj))obj.splice(index,0,item);else throw new ss_NotSupportedException};ss.removeAt=function ss$removeAt(obj,index){if(obj.removeAt)obj.removeAt(index);else if(ss.isArray(obj))obj.splice(index,1);else throw new ss_NotSupportedException};var ss_IDictionary=function IDictionary$(){};ss_IDictionary.__typeName='ss.IDictionary';ss.IDictionary=ss_IDictionary;ss.initInterface(ss_IDictionary,ss,{get_item:null,set_item:null,get_keys:null,get_values:null,containsKey:null,add:null,remove:null,tryGetValue:null},[ss_IEnumerable]);var ss_Int32=function Int32$(){};ss_Int32.__typeName='ss.Int32';ss.Int32=ss_Int32;ss.initClass(ss_Int32,ss,{},Object,[ss_IEquatable,ss_IComparable,ss_IFormattable]);ss_Int32.__class=false;ss_Int32.isInstanceOfType=function Int32$isInstanceOfType(instance){return typeof(instance)==='number'&&isFinite(instance)&&Math.round(instance,0)==instance};ss_Int32.getDefaultValue=ss_Int32.createInstance=function Int32$getDefaultValue(){return 0};ss_Int32.div=function Int32$div(a,b){if(!ss.isValue(a)||!ss.isValue(b))return null;if(b===0)throw new ss_DivideByZeroException;return ss_Int32.trunc(a/b)};ss_Int32.trunc=function Int32$trunc(n){return ss.isValue(n)?(n>0?Math.floor(n):Math.ceil(n)):null};ss_Int32.tryParse=function Int32$tryParse(s,result,min,max){result.$=0;if(!/^[+-]?[0-9]+$/.test(s))return 0;var n=parseInt(s,10);if(n<min||n>max)return false;result.$=n;return true};var ss_JsDate=function JsDate$(){};ss_JsDate.__typeName='ss.JsDate';ss.JsDate=ss_JsDate;ss.initClass(ss_JsDate,ss,{},Object,[ss_IEquatable,ss_IComparable]);ss_JsDate.createInstance=function JsDate$createInstance(){return new Date};ss_JsDate.isInstanceOfType=function JsDate$isInstanceOfType(instance){return instance instanceof Date};var ss_ArrayEnumerator=function ArrayEnumerator$(array){this._array=array;this._index=-1};ss_ArrayEnumerator.__typeName='ss.ArrayEnumerator';ss.ArrayEnumerator=ss_ArrayEnumerator;ss.initClass(ss_ArrayEnumerator,ss,{moveNext:function ArrayEnumerator$moveNext(){this._index++;return(this._index<this._array.length)},reset:function ArrayEnumerator$reset(){this._index=-1},current:function ArrayEnumerator$current(){if(this._index<0||this._index>=this._array.length)throw'Invalid operation';return this._array[this._index]},dispose:function ArrayEnumerator$dispose(){}},null,[ss_IEnumerator,ss_IDisposable]);var ss_ObjectEnumerator=function ObjectEnumerator$(o){this._keys=Object.keys(o);this._index=-1;this._object=o};ss_ObjectEnumerator.__typeName='ss.ObjectEnumerator';ss.ObjectEnumerator=ss_ObjectEnumerator;ss.initClass(ss_ObjectEnumerator,ss,{moveNext:function ObjectEnumerator$moveNext(){this._index++;return(this._index<this._keys.length)},reset:function ObjectEnumerator$reset(){this._index=-1},current:function ObjectEnumerator$current(){if(this._index<0||this._index>=this._keys.length)throw new ss_InvalidOperationException('Invalid operation');var k=this._keys[this._index];return{key:k,value:this._object[k]}},dispose:function ObjectEnumerator$dispose(){}},null,[ss_IEnumerator,ss_IDisposable]);var ss_EqualityComparer=function EqualityComparer$(){};ss_EqualityComparer.__typeName='ss.EqualityComparer';ss.EqualityComparer=ss_EqualityComparer;ss.initClass(ss_EqualityComparer,ss,{areEqual:function EqualityComparer$areEqual(x,y){return ss.staticEquals(x,y)},getObjectHashCode:function EqualityComparer$getObjectHashCode(obj){return ss.isValue(obj)?ss.getHashCode(obj):0}},null,[ss_IEqualityComparer]);ss_EqualityComparer.def=new ss_EqualityComparer;var ss_Comparer=function Comparer$(f){this.f=f};ss_Comparer.__typeName='ss.Comparer';ss.Comparer=ss_Comparer;ss.initClass(ss_Comparer,ss,{compare:function Comparer$compare(x,y){return this.f(x,y)}},null,[ss_IComparer]);ss_Comparer.def=new ss_Comparer(function Comparer$defaultCompare(a,b){if(!ss.isValue(a))return!ss.isValue(b)?0:-1;else if(!ss.isValue(b))return 1;else return ss.compare(a,b)});var ss_IDisposable=function IDisposable$(){};ss_IDisposable.__typeName='ss.IDisposable';ss.IDisposable=ss_IDisposable;ss.initInterface(ss_IDisposable,ss,{dispose:null});var ss_StringBuilder=function StringBuilder$(s){this._parts=(ss.isValue(s)&&s!='')?[s]:[];this.length=ss.isValue(s)?s.length:0};ss_StringBuilder.__typeName='ss.StringBuilder';ss.StringBuilder=ss_StringBuilder;ss.initClass(ss_StringBuilder,ss,{append:function StringBuilder$append(o){if(ss.isValue(o)){var s=o.toString();ss.add(this._parts,s);this.length+=s.length}return this},appendChar:function StringBuilder$appendChar(c){return this.append(String.fromCharCode(c))},appendLine:function StringBuilder$appendLine(s){this.append(s);this.append('\r\n');return this},appendLineChar:function StringBuilder$appendLineChar(c){return this.appendLine(String.fromCharCode(c))},clear:function StringBuilder$clear(){this._parts=[];this.length=0},toString:function StringBuilder$toString(){return this._parts.join('')}});var ss_EventArgs=function EventArgs$(){};ss_EventArgs.__typeName='ss.EventArgs';ss.EventArgs=ss_EventArgs;ss.initClass(ss_EventArgs,ss,{});ss_EventArgs.Empty=new ss_EventArgs;var ss_Exception=function Exception$(message,innerException){this._message=message||'An error occurred.';this._innerException=innerException||null;this._error=new Error};ss_Exception.__typeName='ss.Exception';ss.Exception=ss_Exception;ss.initClass(ss_Exception,ss,{get_message:function Exception$get_message(){return this._message},get_innerException:function Exception$get_innerException(){return this._innerException},get_stack:function Exception$get_stack(){return this._error.stack}});ss_Exception.wrap=function Exception$wrap(o){if(ss.isInstanceOfType(o,ss_Exception)){return o}else if(o instanceof TypeError){return new ss_NullReferenceException(o.message,new ss_JsErrorException(o))}else if(o instanceof RangeError){return new ss_ArgumentOutOfRangeException(null,o.message,new ss_JsErrorException(o))}else if(o instanceof Error){return new ss_JsErrorException(o)}else{return new ss_Exception(o.toString())}};var ss_NotImplementedException=function NotImplementedException$(message,innerException){ss_Exception.call(this,message||'The method or operation is not implemented.',innerException)};ss_NotImplementedException.__typeName='ss.NotImplementedException';ss.NotImplementedException=ss_NotImplementedException;ss.initClass(ss_NotImplementedException,ss,{},ss_Exception);var ss_NotSupportedException=function NotSupportedException$(message,innerException){ss_Exception.call(this,message||'Specified method is not supported.',innerException)};ss_NotSupportedException.__typeName='ss.NotSupportedException';ss.NotSupportedException=ss_NotSupportedException;ss.initClass(ss_NotSupportedException,ss,{},ss_Exception);var ss_AggregateException=function AggregateException$(message,innerExceptions){this.innerExceptions=ss.isValue(innerExceptions)?ss.arrayFromEnumerable(innerExceptions):[];ss_Exception.call(this,message||'One or more errors occurred.',this.innerExceptions.length?this.innerExceptions[0]:null)};ss_AggregateException.__typeName='ss.AggregateException';ss.AggregateException=ss_AggregateException;ss.initClass(ss_AggregateException,ss,{flatten:function AggregateException$flatten(){var inner=[];for(var i=0;i<this.innerExceptions.length;i++){var e=this.innerExceptions[i];if(ss.isInstanceOfType(e,ss_AggregateException)){inner.push.apply(inner,e.flatten().innerExceptions)}else{inner.push(e)}}return new ss_AggregateException(this._message,inner)}},ss_Exception);var ss_PromiseException=function PromiseException(args,message,innerException){ss_Exception.call(this,message||(args.length&&args[0]?args[0].toString():'An error occurred'),innerException);this.arguments=ss.arrayClone(args)};ss_PromiseException.__typeName='ss.PromiseException';ss.PromiseException=ss_PromiseException;ss.initClass(ss_PromiseException,ss,{get_arguments:function PromiseException$get_arguments(){return this._arguments}},ss_Exception);var ss_JsErrorException=function JsErrorException$(error,message,innerException){ss_Exception.call(this,message||error.message,innerException);this.error=error};ss_JsErrorException.__typeName='ss.JsErrorException';ss.JsErrorException=ss_JsErrorException;ss.initClass(ss_JsErrorException,ss,{get_stack:function Exception$get_stack(){return this.error.stack}},ss_Exception);var ss_ArgumentException=function ArgumentException$(message,paramName,innerException){ss_Exception.call(this,message||'Value does not fall within the expected range.',innerException);this.paramName=paramName||null};ss_ArgumentException.__typeName='ss.ArgumentException';ss.ArgumentException=ss_ArgumentException;ss.initClass(ss_ArgumentException,ss,{},ss_Exception);var ss_ArgumentNullException=function ArgumentNullException$(paramName,message,innerException){if(!message){message='Value cannot be null.';if(paramName)message+='\nParameter name: '+paramName}ss_ArgumentException.call(this,message,paramName,innerException)};ss_ArgumentNullException.__typeName='ss.ArgumentNullException';ss.ArgumentNullException=ss_ArgumentNullException;ss.initClass(ss_ArgumentNullException,ss,{},ss_ArgumentException);var ss_ArgumentOutOfRangeException=function ArgumentOutOfRangeException$(paramName,message,innerException,actualValue){if(!message){message='Value is out of range.';if(paramName)message+='\nParameter name: '+paramName}ss_ArgumentException.call(this,message,paramName,innerException);this.actualValue=actualValue||null};ss_ArgumentOutOfRangeException.__typeName='ss.ArgumentOutOfRangeException';ss.ArgumentOutOfRangeException=ss_ArgumentOutOfRangeException;ss.initClass(ss_ArgumentOutOfRangeException,ss,{},ss_ArgumentException);var ss_FormatException=function FormatException$(message,innerException){ss_Exception.call(this,message||'Invalid format.',innerException)};ss_FormatException.__typeName='ss.FormatException';ss.FormatException=ss_FormatException;ss.initClass(ss_FormatException,ss,{},ss_Exception);var ss_DivideByZeroException=function DivideByZeroException$(message,innerException){ss_Exception.call(this,message||'Division by 0.',innerException)};ss_DivideByZeroException.__typeName='ss.DivideByZeroException';ss.DivideByZeroException=ss_DivideByZeroException;ss.initClass(ss_DivideByZeroException,ss,{},ss_Exception);var ss_InvalidCastException=function InvalidCastException$(message,innerException){ss_Exception.call(this,message||'The cast is not valid.',innerException)};ss_InvalidCastException.__typeName='ss.InvalidCastException';ss.InvalidCastException=ss_InvalidCastException;ss.initClass(ss_InvalidCastException,ss,{},ss_Exception);var ss_InvalidOperationException=function InvalidOperationException$(message,innerException){ss_Exception.call(this,message||'Operation is not valid due to the current state of the object.',innerException)};ss_InvalidOperationException.__typeName='ss.InvalidOperationException';ss.InvalidOperationException=ss_InvalidOperationException;ss.initClass(ss_InvalidOperationException,ss,{},ss_Exception);var ss_NullReferenceException=function NullReferenceException$(message,innerException){ss_Exception.call(this,message||'Object is null.',innerException)};ss_NullReferenceException.__typeName='ss.NullReferenceException';ss.NullReferenceException=ss_NullReferenceException;ss.initClass(ss_NullReferenceException,ss,{},ss_Exception);var ss_KeyNotFoundException=function KeyNotFoundException$(message,innerException){ss_Exception.call(this,message||'Key not found.',innerException)};ss_KeyNotFoundException.__typeName='ss.KeyNotFoundException';ss.KeyNotFoundException=ss_KeyNotFoundException;ss.initClass(ss_KeyNotFoundException,ss,{},ss_Exception);var ss_AmbiguousMatchException=function AmbiguousMatchException$(message,innerException){ss_Exception.call(this,message||'Ambiguous match.',innerException)};ss_AmbiguousMatchException.__typeName='ss.AmbiguousMatchException';ss.AmbiguousMatchException=ss_AmbiguousMatchException;ss.initClass(ss_AmbiguousMatchException,ss,{},ss_Exception);var ss_IteratorBlockEnumerable=function IteratorBlockEnumerable$(getEnumerator,$this){this._getEnumerator=getEnumerator;this._this=$this};ss_IteratorBlockEnumerable.__typeName='ss.IteratorBlockEnumerable';ss.IteratorBlockEnumerable=ss_IteratorBlockEnumerable;ss.initClass(ss_IteratorBlockEnumerable,ss,{getEnumerator:function IteratorBlockEnumerable$getEnumerator(){return this._getEnumerator.call(this._this)}},null,[ss_IEnumerable]);var ss_IteratorBlockEnumerator=function IteratorBlockEnumerator$(moveNext,getCurrent,dispose,$this){this._moveNext=moveNext;this._getCurrent=getCurrent;this._dispose=dispose;this._this=$this};ss_IteratorBlockEnumerator.__typeName='ss.IteratorBlockEnumerator';ss.IteratorBlockEnumerator=ss_IteratorBlockEnumerator;ss.initClass(ss_IteratorBlockEnumerator,ss,{moveNext:function IteratorBlockEnumerator$moveNext(){try{return this._moveNext.call(this._this)}catch(ex){if(this._dispose)this._dispose.call(this._this);throw ex}},current:function IteratorBlockEnumerator$current(){return this._getCurrent.call(this._this)},reset:function IteratorBlockEnumerator$reset(){throw new ss_NotSupportedException('Reset is not supported.')},dispose:function IteratorBlockEnumerator$dispose(){if(this._dispose)this._dispose.call(this._this)}},null,[ss_IEnumerator,ss_IDisposable]);var ss_Lazy=function Lazy$(valueFactory){this._valueFactory=valueFactory;this.isValueCreated=false};ss_Lazy.__typeName='ss.Lazy';ss.Lazy=ss_Lazy;ss.initClass(ss_Lazy,ss,{value:function Lazy$value(){if(!this.isValueCreated){this._value=this._valueFactory();delete this._valueFactory;this.isValueCreated=true}return this._value}});if(typeof(global.HTMLElement)==='undefined'){global.HTMLElement=Element}if(typeof(global.MessageEvent)==='undefined'){global.MessageEvent=Event}Date.now=Date.now||function(){return+new Date};global.ss=ss})(global);var ss=global.ss;var HTMLElement=global.HTMLElement;var MessageEvent=global.MessageEvent;
/*! BEGIN CoreSlim */
(function(){'dont use strict';var a={};global.tab=global.tab||{};ss.initAssembly(a,'tabcoreslim');var b=function(){};b.__typeName='tab.EscapingUtil';b.escapeHtml=function(e){var f=ss.coalesce(e,'');f=f.replace(new RegExp('&','g'),'&amp;');f=f.replace(new RegExp('<','g'),'&lt;');f=f.replace(new RegExp('>','g'),'&gt;');f=f.replace(new RegExp('"','g'),'&quot;');f=f.replace(new RegExp("'",'g'),'&#39;');f=f.replace(new RegExp('/','g'),'&#47;');return f};global.tab.EscapingUtil=b;var c=function(){};c.__typeName='tab.ScriptEx';global.tab.ScriptEx=c;var d=function(e){this.$0=null;this.$0=e};d.__typeName='tab.WindowHelper';d.get_windowSelf=function(){return window.self};d.get_selection=function(){if(typeof(window['getSelection'])==='function'){return window.getSelection()}else if(typeof(document['getSelection'])==='function'){return document.getSelection()}return null};d.close=function(e){e.close()};d.getOpener=function(e){return e.opener};d.getLocation=function(e){return e.location};d.getPathAndSearch=function(e){return e.location.pathname+e.location.search};d.setLocationHref=function(e,f){e.location.href=f};d.locationReplace=function(e,f){e.location.replace(f)};d.open=function(e,f,g){return window.open(e,f,g)};d.reload=function(e,f){e.location.reload(f)};d.requestAnimationFrame=function(e){return d.$c(e)};d.cancelAnimationFrame=function(e){if(ss.isValue(e)){d.$b(e)}};d.setTimeout=function(e,f){window.setTimeout(e,f)};d.addListener=function(e,f,g){if('addEventListener'in e){e.addEventListener(f,g,false)}else{e.attachEvent('on'+f,g)}};d.removeListener=function(e,f,g){if('removeEventListener'in e){e.removeEventListener(f,g,false)}else{e.detachEvent('on'+f,g)}};d.$0=function(){var e=0;d.$c=function(f){var g=(new Date).getTime();var h=Math.max(0,16-(g-e));e=g+h;var i=window.setTimeout(f,h);return i}};d.clearSelection=function(){var e=d.get_selection();if(ss.isValue(e)){if(typeof(e['removeAllRanges'])==='function'){e.removeAllRanges()}else if(typeof(e['empty'])==='function'){e['empty']()}}};global.tab.WindowHelper=d;ss.initClass(b,a,{});ss.initClass(c,a,{});ss.initClass(d,a,{get_pageXOffset:function(){return d.$7(this.$0)},get_pageYOffset:function(){return d.$8(this.$0)},get_clientWidth:function(){return d.$2(this.$0)},get_clientHeight:function(){return d.$1(this.$0)},get_innerWidth:function(){return d.$4(this.$0)},get_outerWidth:function(){return d.$6(this.$0)},get_innerHeight:function(){return d.$3(this.$0)},get_outerHeight:function(){return d.$5(this.$0)},get_screenLeft:function(){return d.$9(this.$0)},get_screenTop:function(){return d.$a(this.$0)}});(function(){d.$4=null;d.$3=null;d.$2=null;d.$1=null;d.$7=null;d.$8=null;d.$9=null;d.$a=null;d.$6=null;d.$5=null;d.$c=null;d.$b=null;if('innerWidth'in window){d.$4=function(m){return m.innerWidth}}else{d.$4=function(m){return m.document.documentElement.offsetWidth}}if('outerWidth'in window){d.$6=function(m){return m.outerWidth}}else{d.$6=d.$4}if('innerHeight'in window){d.$3=function(m){return m.innerHeight}}else{d.$3=function(m){return m.document.documentElement.offsetHeight}}if('outerHeight'in window){d.$5=function(m){return m.outerHeight}}else{d.$5=d.$3}if('clientWidth'in window){d.$2=function(m){return m['clientWidth']}}else{d.$2=function(m){return m.document.documentElement.clientWidth}}if('clientHeight'in window){d.$1=function(m){return m['clientHeight']}}else{d.$1=function(m){return m.document.documentElement.clientHeight}}if(ss.isValue(window.self.pageXOffset)){d.$7=function(m){return m.pageXOffset}}else{d.$7=function(m){return m.document.documentElement.scrollLeft}}if(ss.isValue(window.self.pageYOffset)){d.$8=function(m){return m.pageYOffset}}else{d.$8=function(m){return m.document.documentElement.scrollTop}}if('screenLeft'in window){d.$9=function(m){return m.screenLeft}}else{d.$9=function(m){return m.screenX}}if('screenTop'in window){d.$a=function(m){return m.screenTop}}else{d.$a=function(m){return m.screenY}}{var e='requestAnimationFrame';var f='cancelAnimationFrame';var g=['ms','moz','webkit','o'];var h=null;var i=null;if(e in window){h=e}if(f in window){i=f}for(var j=0;j<g.length&&(ss.isNullOrUndefined(h)||ss.isNullOrUndefined(i));++j){var k=g[j];var l=k+'RequestAnimationFrame';if(ss.isNullOrUndefined(h)&&l in window){h=l}if(ss.isNullOrUndefined(i)){l=k+'CancelAnimationFrame';if(l in window){i=l}l=k+'CancelRequestAnimationFrame';if(l in window){i=l}}}if(ss.isValue(h)){d.$c=function(m){return window[h](m)}}else{d.$0()}if(ss.isValue(i)){d.$b=function(m){window[i](m)}}else{d.$b=function(m){window.clearTimeout(m)}}}})()})();var tab=global.tab;
/*! API */
(function(){'dont use strict';var a={};global.tab=global.tab||{};global.tableauSoftware=global.tableauSoftware||{};ss.initAssembly(a,'Tableau.JavaScript.Vql.Api');var b=function(){this.$9=0;this.$8={};this.$5={};this.$7={};this.$6={};if(H.hasWindowAddEventListener()){window.addEventListener('message',ss.mkdel(this,this.$0),false)}else if(H.hasDocumentAttachEvent()){var e=ss.mkdel(this,this.$0);document.attachEvent('onmessage',e);window.attachEvent('onmessage',e)}else{window.onmessage=ss.mkdel(this,this.$0)}this.$9=0};b.__typeName='tab.$0';var c=function(){this.$2=null;this.$1$1=null;this.$1$2=null};c.__typeName='tab.$1';var d=function(e,bY){this.$2=null;bh.call(this,e,null);this.$2=bY};d.__typeName='tab.$10';var f=function(e,bY){this.$2=null;bh.call(this,e,null);this.$2=bY};f.__typeName='tab.$2';var g=function(e,bY,bZ,ca){this.$3=null;this.$4=null;bh.call(this,e,bY);this.$3=bZ;this.$4=ca};g.__typeName='tab.$3';var h=function(){};h.__typeName='tab.$4';var i=function(){};i.__typeName='tab.$5';i.$0=function(e){var bY;if(e instanceof tableauSoftware.Promise){bY=e}else{if(ss.isValue(e)&&typeof(e['valueOf'])==='function'){e=e['valueOf']()}if(i.$1(e)){var bZ=new w;e.then(ss.mkdel(bZ,bZ.resolve),ss.mkdel(bZ,bZ.reject));bY=bZ.get_promise()}else{bY=i.$4(e)}}return bY};i.$2=function(e){return i.$0(e).then(function(bY){return i.$3(bY)},null)};i.$4=function(bY){var bZ=new z(function(ca,cb){try{return i.$0((ss.isValue(ca)?ca(bY):bY))}catch(cc){var e=ss.Exception.wrap(cc);return i.$3(e)}});return bZ};i.$3=function(bY){var bZ=new z(function(ca,cb){try{return(ss.isValue(cb)?i.$0(cb(bY)):i.$3(bY))}catch(cc){var e=ss.Exception.wrap(cc);return i.$3(e)}});return bZ};i.$1=function(e){return ss.isValue(e)&&typeof(e['then'])==='function'};var j=function(e){this.$4=null;this.$5=new tab._Collection;this.$6=0;if(x.isArray(e)){var bY=e;for(var bZ=0;bZ<bY.length;bZ++){var ca=bY[bZ];if(!ss.isValue(ca.fieldName)){throw G.createInvalidParameter('pair.fieldName')}if(!ss.isValue(ca.value)){throw G.createInvalidParameter('pair.value')}var cb=new bK(ca.fieldName,ca.value);this.$5._add(cb.fieldName,cb)}}else{this.$6=e}};j.__typeName='tab.$6';j.$0=function(e){var bY=new tab._Collection;if(ss.isNullOrUndefined(e)||H.isNullOrEmpty(e.marks)){return bY}for(var bZ=0;bZ<e.marks.length;bZ++){var ca=e.marks[bZ];var cb=ca.tupleId;var cc=new bJ(cb);bY._add(cb.toString(),cc);for(var cd=0;cd<ca.pairs.length;cd++){var ce=ca.pairs[cd];var cf=H.convertRawValue(ce.value,ce.valueDataType);var cg=new bK(ce.fieldName,cf);cg.formattedValue=ce.formattedValue;if(!cc.$0.$2()._has(cg.fieldName)){cc.$0.$0(cg)}}}return bY};var k=function(e){this.$i=null;this.$h=null;this.$c=null;this.$d=null;this.$b=null;this.$a=null;this.$g=null;this.$f=null;this.$j=null;this.$e=null;this.$h=e.name;this.$c=H.getDataValue(e.currentValue);this.$d=O.convertParameterDataType(e.dataType);this.$b=O.convertParameterAllowableValuesType(e.allowableValuesType);if(ss.isValue(e.allowableValues)&&this.$b==='list'){this.$a=[];for(var bY=0;bY<e.allowableValues.length;bY++){var bZ=e.allowableValues[bY];this.$a.push(H.getDataValue(bZ))}}if(this.$b==='range'){this.$g=H.getDataValue(e.minValue);this.$f=H.getDataValue(e.maxValue);this.$j=e.stepSize;if((this.$d==='date'||this.$d==='datetime')&&ss.isValue(this.$j)&&ss.isValue(e.dateStepPeriod)){this.$e=O.convertPeriodType(e.dateStepPeriod)}}};k.__typeName='tab.$7';var l=function(){};l.__typeName='tab.$8';l.$2=function(e){return function(bY,bZ){if(ss.isValue(bY)){var ca=bY.toString().toUpperCase();var cb=ss.Enum.getValues(e);for(var cc=0;cc<cb.length;cc++){var cd=cb[cc];var ce=cd.toUpperCase();if(ss.referenceEquals(ca,ce)){bZ.$=cd;return true}}}bZ.$=ss.getDefaultValue(e);return false}};l.$1=function(e){return function(bY,bZ){var ca={};if(!l.$2(e).call(null,bY,ca)){throw G.createInvalidParameter(bZ)}return ca.$}};l.$0=function(e){return function(bY){var bZ={};var ca=l.$2(e).call(null,bY,bZ);return ca}};var m=function(e,bY){bh.call(this,e,bY)};m.__typeName='tab.$9';var n=function(){};n.__typeName='tab._ApiBootstrap';n.initialize=function(){p.registerCrossDomainMessageRouter(function(){return new b})};global.tab._ApiBootstrap=n;var o=function(e,bY,bZ,ca){this.$2=null;this.$1=null;this.$0=null;this.$3=null;this.$2=e;this.$0=bY;this.$1=bZ;this.$3=ca};o.__typeName='tab._ApiCommand';o.generateNextCommandId=function(){var e='cmd'+o.$0;o.$0++;return e};o.parse=function(e){var bY;var bZ=e.indexOf(String.fromCharCode(44));if(bZ<0){bY=e;return new o(bY,null,null,null)}bY=e.substr(0,bZ);var ca;var cb=e.substr(bZ+1);bZ=cb.indexOf(String.fromCharCode(44));if(bZ<0){ca=cb;return new o(bY,ca,null,null)}ca=cb.substr(0,bZ);var cc;var cd=cb.substr(bZ+1);bZ=cd.indexOf(String.fromCharCode(44));if(bZ<0){cc=cd;return new o(bY,ca,cc,null)}cc=cd.substr(0,bZ);var ce=cd.substr(bZ+1);return new o(bY,ca,cc,ce)};global.tab._ApiCommand=o;var p=function(){};p.__typeName='tab._ApiObjectRegistry';p.registerCrossDomainMessageRouter=function(e){return p.$3(bl).call(null,e)};p.getCrossDomainMessageRouter=function(){return p.$2(bl).call(null)};p.disposeCrossDomainMessageRouter=function(){p.$0(bl).call(null)};p.$3=function(e){return function(bY){if(ss.isNullOrUndefined(p.$4)){p.$4={}}var bZ=ss.getTypeFullName(e);var ca=p.$4[bZ];p.$4[bZ]=bY;return ca}};p.$1=function(e){return function(){if(ss.isNullOrUndefined(p.$4)){throw G.createInternalError('No types registered')}var bY=ss.getTypeFullName(e);var bZ=p.$4[bY];if(ss.isNullOrUndefined(bZ)){throw G.createInternalError("No creation function has been registered for interface type '"+bY+"'.")}var ca=bZ();return ca}};p.$2=function(e){return function(){if(ss.isNullOrUndefined(p.$5)){p.$5={}}var bY=ss.getTypeFullName(e);var bZ=p.$5[bY];if(ss.isNullOrUndefined(bZ)){bZ=p.$1(e).call(null);p.$5[bY]=bZ}return bZ}};p.$0=function(e){return function(){if(ss.isNullOrUndefined(p.$5)){return null}var bY=ss.getTypeFullName(e);var bZ=p.$5[bY];delete p.$5[bY];return bZ}};global.tab._ApiObjectRegistry=p;var q=function(e,bY,bZ){this.$1=null;this.$2=null;this.$0=null;this.$1=e;this.$2=bY;this.$0=bZ};q.__typeName='tab._ApiServerNotification';q.deserialize=function(e){var bY=JSON.parse(e);var bZ=bY['api.workbookName'];var ca=bY['api.worksheetName'];var cb=bY['api.commandData'];return new q(bZ,ca,cb)};global.tab._ApiServerNotification=q;var r=function(e){this.$1=null;this.$0=null;var bY=JSON.parse(e);this.$1=bY['api.commandResult'];this.$0=bY['api.commandData']};r.__typeName='tab._ApiServerResultParser';global.tab._ApiServerResultParser=r;var s=function(){this.$4=[];this.$3={}};s.__typeName='tab._CollectionImpl';global.tab._CollectionImpl=s;var t=function(e,bY,bZ){this.$c=null;this.$j=null;this.$l=null;this.$g=null;this.$h=null;this.$i=null;this.$k=null;this.$e=false;this.$d=false;this.$f=false;this.$l=e;this.$h=bY;this.$g=bZ;this.$e=false;this.$d=false;this.$f=false};t.__typeName='tab._CustomViewImpl';t._getAsync=function(e){var bY=new tab._Deferred;bY.resolve(e.get__customViewImpl().$5());return bY.get_promise()};t._createNew=function(e,bY,bZ,ca){var cb=new t(e,bZ.name,bY);cb.$e=bZ.isPublic;cb.$k=bZ.url;cb.$i=bZ.owner.friendlyName;cb.$d=ss.isValue(ca)&&ss.unbox(ca)===bZ.id;cb.$j=bZ;return cb};t._saveNewAsync=function(e,bY,bZ){var ca=new tab._Deferred;var cb={};cb['api.customViewName']=bZ;var cc=t.$0('api.SaveNewCustomViewCommand',ca,function(cd){t._processCustomViewUpdate(e,bY,cd,true);var ce=null;if(ss.isValue(e.$p())){ce=e.$p().get_item(0)}ca.resolve(ce)});bY.sendCommand(Object).call(bY,cb,cc);return ca.get_promise()};t._showCustomViewAsync=function(e,bY,bZ){var ca=new tab._Deferred;var cb={};if(ss.isValue(bZ)){cb['api.customViewParam']=bZ}var cc=t.$0('api.ShowCustomViewCommand',ca,function(cd){var ce=e.get_activeCustomView();ca.resolve(ce)});bY.sendCommand(Object).call(bY,cb,cc);return ca.get_promise()};t._makeCurrentCustomViewDefaultAsync=function(e,bY){var bZ=new tab._Deferred;var ca={};var cb=t.$0('api.MakeCurrentCustomViewDefaultCommand',bZ,function(cc){var cd=e.get_activeCustomView();bZ.resolve(cd)});bY.sendCommand(Object).call(bY,ca,cb);return bZ.get_promise()};t._getCustomViewsAsync=function(e,bY){var bZ=new tab._Deferred;var ca=new(ss.makeGenericType(bd,[Object]))('api.FetchCustomViewsCommand',0,function(cb){t._processCustomViews(e,bY,cb);bZ.resolve(e.$i()._toApiCollection())},function(cb,cc){bZ.reject(G.create('serverError',cc))});bY.sendCommand(Object).call(bY,null,ca);return bZ.get_promise()};t._processCustomViews=function(e,bY,bZ){t._processCustomViewUpdate(e,bY,bZ,false)};t._processCustomViewUpdate=function(e,bY,bZ,ca){if(ca){e.$q(new tab._Collection)}e.$h(null);var cb=null;if(ss.isValue(bZ.currentView)){cb=bZ.currentView.name}var cc=bZ.defaultCustomViewId;if(ca&&ss.isValue(bZ.newView)){var cd=t._createNew(e,bY,bZ.newView,cc);e.$p()._add(cd.$7(),cd.$5())}e.$o(e.$i());e.$j(new tab._Collection);if(ss.isValue(bZ.customViews)){var ce=bZ.customViews;if(ce.length>0){for(var cf=0;cf<ce.length;cf++){var cg=t._createNew(e,bY,ce[cf],cc);e.$i()._add(cg.$7(),cg.$5());if(e.$n()._has(cg.$7())){e.$n()._remove(cg.$7())}else if(ca){if(!e.$p()._has(cg.$7())){e.$p()._add(cg.$7(),cg.$5())}}if(ss.isValue(cb)&&ss.referenceEquals(cg.$7(),cb)){e.$h(cg.$5())}}}}};t.$0=function(e,bY,bZ){var ca=function(cb,cc){bY.reject(G.create('serverError',cc))};return new(ss.makeGenericType(bd,[Object]))(e,0,bZ,ca)};var u=function(e,bY,bZ){this.$d=null;this.$f=new tab._Collection;this.$e=new tab._Collection;B.call(this,e,bY,bZ)};u.__typeName='tab._DashboardImpl';global.tab._DashboardImpl=u;var v=function(e,bY){this.$3=null;this.$1=new tab._Collection;this.$2=false;this.$0=null;y.verifyString(e,'name');this.$3=e;this.$2=bY};v.__typeName='tab._DataSourceImpl';v.processDataSource=function(e){var bY=new v(e.name,e.isPrimary);var bZ=ss.coalesce(e.fields,[]);for(var ca=0;ca<bZ.length;ca++){var cb=bZ[ca];var cc=O.convertFieldRole(cb.role);var cd=O.convertFieldAggregation(cb.aggregation);var ce=new bG(bY.get_dataSource(),cb.name,cc,cd);bY.addField(ce)}return bY};v.processDataSourcesForWorksheet=function(e){var bY=new tab._Collection;var bZ=null;for(var ca=0;ca<e.dataSources.length;ca++){var cb=e.dataSources[ca];var cc=v.processDataSource(cb);if(cb.isPrimary){bZ=cc}else{bY._add(cb.name,cc.get_dataSource())}}if(ss.isValue(bZ)){bY._addToFirst(bZ.get_name(),bZ.get_dataSource())}return bY};global.tab._DataSourceImpl=v;var w=function(){this.$3=null;this.$5=null;this.$2=[];this.$4=null;this.$3=new z(ss.mkdel(this,this.then));this.$5=ss.mkdel(this,this.$0);this.$4=ss.mkdel(this,this.$1)};w.__typeName='tab._DeferredImpl';global.tab._DeferredImpl=w;var x=function(){};x.__typeName='tab._jQueryShim';x.isFunction=function(e){return x.type(e)==='function'};x.isArray=function(e){if(ss.isValue(Array['isArray'])){return Array['isArray'](e)}return x.type(e)==='array'};x.type=function(e){return(ss.isNullOrUndefined(e)?String(e):(x.$8[x.$d.call(e)]||'object'))};x.trim=function(e){if(ss.isValue(x.$e)){return(ss.isNullOrUndefined(e)?'':x.$e.call(e))}return(ss.isNullOrUndefined(e)?'':e.toString().replace(x.$f,'').replace(x.$g,''))};x.parseJSON=function(e){if(typeof(e)!=='string'||ss.isNullOrUndefined(e)){return null}e=x.trim(e);if(ss.isValue(JSON)&&ss.isValue(JSON['parse'])){return JSON.parse(e)}if(x.$a.test(e.replace(x.$b,'@').replace(x.$c,']').replace(x.$9,''))){return(new Function('return '+e))()}throw new ss.Exception('Invalid JSON: '+e)};global.tab._jQueryShim=x;var y=function(){};y.__typeName='tab._Param';y.verifyString=function(e,bY){if(ss.isNullOrUndefined(e)||e.length===0){throw G.createInternalStringArgumentException(bY)}};y.verifyValue=function(e,bY){if(ss.isNullOrUndefined(e)){throw G.createInternalNullArgumentException(bY)}};global.tab._Param=y;var z=function(e){this.then=null;this.then=e};z.__typeName='tab._PromiseImpl';global.tab._PromiseImpl=z;var A=function(e,bY,bZ,ca){this.left=0;this.top=0;this.width=0;this.height=0;this.left=e;this.top=bY;this.width=bZ;this.height=ca};A.__typeName='tab._Rect';global.tab._Rect=A;var B=function(e,bY,bZ){this.$5=null;this.$1=0;this.$2=false;this.$3=false;this.$7=null;this.$8=null;this.$9=null;this.$a=null;this.$4=null;this.$6=null;this.$b=0;y.verifyValue(e,'sheetInfoImpl');y.verifyValue(bY,'workbookImpl');y.verifyValue(bZ,'messagingOptions');this.$5=e.name;this.$1=e.index;this.$2=e.isActive;this.$3=e.isHidden;this.$7=e.sheetType;this.$8=e.size;this.$9=e.url;this.$a=bY;this.$4=bZ;this.$b=e.zoneId};B.__typeName='tab._SheetImpl';B.$0=function(e){if(ss.isValue(e)){return H.toInt(e)}return e};B.$1=function(e){var bY=l.$1(Z).call(null,e.behavior,'size.behavior');var bZ=e.minSize;if(ss.isValue(bZ)){bZ=bs.$ctor(B.$0(e.minSize.width),B.$0(e.minSize.height))}var ca=e.maxSize;if(ss.isValue(ca)){ca=bs.$ctor(B.$0(e.maxSize.width),B.$0(e.maxSize.height))}return bq.$ctor(bY,bZ,ca)};global.tab._SheetImpl=B;var C=function(){};C.__typeName='tab._SheetInfoImpl';C.$ctor=function(e,bY,bZ,ca,cb,cc,cd,ce,cf){var cg=new Object;cg.name=null;cg.index=0;cg.workbook=null;cg.url=null;cg.isHidden=false;cg.sheetType=null;cg.zoneId=0;cg.size=null;cg.isActive=false;cg.name=e;cg.sheetType=bY;cg.index=bZ;cg.size=ca;cg.workbook=cb;cg.url=cc;cg.isActive=cd;cg.isHidden=ce;cg.zoneId=cf;return cg};global.tab._SheetInfoImpl=C;var D=function(e,bY,bZ,ca,cb){this.$g=null;this.$h=null;this.$i=null;this.$j=null;this.$2$1=null;B.call(this,e,bY,bZ);y.verifyValue(ca,'storyPm');y.verifyValue(cb,'findSheetFunc');this.$h=cb;this.update(ca)};D.__typeName='tab._StoryImpl';global.tab._StoryImpl=D;var E=function(e,bY){this.$1=null;this.$3=0;this.$4=false;this.$5=false;this.$2=null;this.$6=null;this.$7=null;this.$8=0;this.$4=e.isActive;this.$5=e.isUpdated;this.$1=e.caption;this.$3=e.index;this.$6=e.parentStoryImpl;this.$8=e.storyPointId;this.$2=bY;if(ss.isValue(bY)){this.$2.set_parentStoryPointImpl(this);if(bY.get_sheetType()==='dashboard'){var bZ=this.$2;for(var ca=0;ca<bZ.get_worksheets().get__length();ca++){var cb=bZ.get_worksheets().get_item(ca);cb._impl.set_parentStoryPointImpl(this)}}}};E.__typeName='tab._StoryPointImpl';E.createContainedSheet=function(e,bY,bZ,ca){var cb=O.convertSheetType(e.sheetType);var cc=-1;var cd=br.createAutomatic();var ce=false;var cf=ca(e.name);var cg=ss.isNullOrUndefined(cf);var ch=(cg?'':cf.getUrl());var ci=C.$ctor(e.name,cb,cc,cd,bY.get_workbook(),ch,ce,cg,e.zoneId);if(e.sheetType==='worksheet'){var cj=null;var ck=new L(ci,bY,bZ,cj);return ck}else if(e.sheetType==='dashboard'){var cl=new u(ci,bY,bZ);var cm=K.$0(e.dashboardZones);cl.$c(cm,ca);return cl}else if(e.sheetType==='story'){throw G.createInternalError('Cannot have a story embedded within another story.')}else{throw G.createInternalError("Unknown sheet type '"+e.sheetType+"'")}};global.tab._StoryPointImpl=E;var F=function(){};F.__typeName='tab._StoryPointInfoImpl';F.$ctor=function(e,bY,bZ,ca,cb,cc){var cd=new Object;cd.storyPointId=0;cd.parentStoryImpl=null;cd.caption=null;cd.index=0;cd.isActive=false;cd.isUpdated=false;cd.caption=e;cd.index=bY;cd.storyPointId=bZ;cd.isActive=ca;cd.isUpdated=cb;cd.parentStoryImpl=cc;return cd};global.tab._StoryPointInfoImpl=F;var G=function(){};G.__typeName='tab._TableauException';G.create=function(e,bY){var bZ=new ss.Exception(bY);bZ['tableauSoftwareErrorCode']=e;return bZ};G.createInternalError=function(e){if(ss.isValue(e)){return G.create('internalError','Internal error. Please contact Tableau support with the following information: '+e)}else{return G.create('internalError','Internal error. Please contact Tableau support')}};G.createInternalNullArgumentException=function(e){return G.createInternalError("Null/undefined argument '"+e+"'.")};G.createInternalStringArgumentException=function(e){return G.createInternalError("Invalid string argument '"+e+"'.")};G.createServerError=function(e){return G.create('serverError',e)};G.createNotActiveSheet=function(){return G.create('notActiveSheet','Operation not allowed on non-active sheet')};G.createInvalidCustomViewName=function(e){return G.create('invalidCustomViewName','Invalid custom view name: '+e)};G.createInvalidParameter=function(e){return G.create('invalidParameter','Invalid parameter: '+e)};G.createInvalidFilterFieldNameOrValue=function(e){return G.create('invalidFilterFieldNameOrValue','Invalid filter field name or value: '+e)};G.createInvalidDateParameter=function(e){return G.create('invalidDateParameter','Invalid date parameter: '+e)};G.createNullOrEmptyParameter=function(e){return G.create('nullOrEmptyParameter','Parameter cannot be null or empty: '+e)};G.createMissingMaxSize=function(){return G.create('missingMaxSize','Missing maxSize for SheetSizeBehavior.ATMOST')};G.createMissingMinSize=function(){return G.create('missingMinSize','Missing minSize for SheetSizeBehavior.ATLEAST')};G.createMissingMinMaxSize=function(){return G.create('missingMinMaxSize','Missing minSize or maxSize for SheetSizeBehavior.RANGE')};G.createInvalidRangeSize=function(){return G.create('invalidSize','Missing minSize or maxSize for SheetSizeBehavior.RANGE')};G.createInvalidSizeValue=function(){return G.create('invalidSize','Size value cannot be less than zero')};G.createInvalidSheetSizeParam=function(){return G.create('invalidSize','Invalid sheet size parameter')};G.createSizeConflictForExactly=function(){return G.create('invalidSize','Conflicting size values for SheetSizeBehavior.EXACTLY')};G.createInvalidSizeBehaviorOnWorksheet=function(){return G.create('invalidSizeBehaviorOnWorksheet','Only SheetSizeBehavior.AUTOMATIC is allowed on Worksheets')};G.createNoUrlForHiddenWorksheet=function(){return G.create('noUrlForHiddenWorksheet','Hidden worksheets do not have a URL.')};G.$0=function(e){return G.create('invalidAggregationFieldName',"Invalid aggregation type for field '"+e+"'")};G.createIndexOutOfRange=function(e){return G.create('indexOutOfRange',"Index '"+e+"' is out of range.")};G.createUnsupportedEventName=function(e){return G.create('unsupportedEventName',"Unsupported event '"+e+"'.")};G.createBrowserNotCapable=function(){return G.create('browserNotCapable','This browser is incapable of supporting the Tableau JavaScript API.')};global.tab._TableauException=G;var H=function(){};H.__typeName='tab._Utility';H.isNullOrEmpty=function(e){return ss.isNullOrUndefined(e)||(e['length']||0)<=0};H.isString=function(e){return typeof(e)==='string'};H.isNumber=function(e){return typeof(e)==='number'};H.isDate=function(e){if(typeof(e)==='object'&&ss.isInstanceOfType(e,ss.JsDate)){return true}else if(Object.prototype.toString.call(e)!=='[object Date]'){return false}return!isNaN(e.getTime())};H.isDateValid=function(e){return!isNaN(e.getTime())};H.indexOf=function(e,bY,bZ){if(ss.isValue(Array.prototype['indexOf'])){return e['indexOf'](bY,bZ)}bZ=bZ||0;var ca=e.length;if(ca>0){for(var cb=bZ;cb<ca;cb++){if(ss.referenceEquals(e[cb],bY)){return cb}}}return-1};H.contains=function(e,bY,bZ){var ca=H.indexOf(e,bY,bZ);return ca>=0};H.getTopmostWindow=function(){var e=window.self;while(ss.isValue(e.parent)&&!ss.referenceEquals(e.parent,e)){e=e.parent}return e};H.toInt=function(e){if(H.isNumber(e)){return ss.Int32.trunc(e)}var bY=parseInt(e.toString(),10);if(isNaN(bY)){return 0}return bY};H.hasClass=function(e,bY){var bZ=new RegExp('[\\n\\t\\r]','g');return ss.isValue(e)&&(' '+e.className+' ').replace(bZ,' ').indexOf(' '+bY+' ')>-1};H.findParentWithClassName=function(e,bY,bZ){var ca=(ss.isValue(e)?e.parentNode:null);bZ=bZ||document.body;while(ss.isValue(ca)){if(H.hasClass(ca,bY)){return ca}if(ss.referenceEquals(ca,bZ)){ca=null}else{ca=ca.parentNode}}return ca};H.hasJsonParse=function(){return ss.isValue(JSON)&&ss.isValue(JSON.parse)};H.hasWindowPostMessage=function(){return ss.isValue(window.postMessage)};H.isPostMessageSynchronous=function(){if(H.isIE()){var e=new RegExp('(msie) ([\\w.]+)');var bY=e.exec(window.navigator.userAgent.toLowerCase());var bZ=bY[2]||'0';var ca=parseInt(bZ,10);return ca<=8}return false};H.hasDocumentAttachEvent=function(){return ss.isValue(document.attachEvent)};H.hasWindowAddEventListener=function(){return ss.isValue(window.addEventListener)};H.isElementOfTag=function(e,bY){return ss.isValue(e)&&e.nodeType===1&&ss.referenceEquals(e.tagName.toLowerCase(),bY.toLowerCase())};H.elementToString=function(e){var bY=new ss.StringBuilder;bY.append(e.tagName.toLowerCase());if(!H.isNullOrEmpty(e.id)){bY.append('#').append(e.id)}if(!H.isNullOrEmpty(e.className)){var bZ=e.className.split(' ');bY.append('.').append(bZ.join('.'))}return bY.toString()};H.tableauGCS=function(e){if(typeof(window['getComputedStyle'])==='function'){return window.getComputedStyle(e)}else{return e['currentStyle']}};H.isIE=function(){return window.navigator.userAgent.indexOf('MSIE')>-1&&ss.isNullOrUndefined(window.opera)};H.isSafari=function(){var e=window.navigator.userAgent;var bY=e.indexOf('Chrome')>=0;return e.indexOf('Safari')>=0&&!bY};H.mobileDetect=function(){var e=window.navigator.userAgent;if(e.indexOf('iPad')!==-1){return true}if(e.indexOf('Android')!==-1){return true}if(e.indexOf('AppleWebKit')!==-1&&e.indexOf('Mobile')!==-1){return true}return false};H.visibleContentRectInDocumentCoordinates=function(e){var bY=H.contentRectInDocumentCoordinates(e);for(var bZ=e.parentElement;ss.isValue(bZ)&&ss.isValue(bZ.parentElement);bZ=bZ.parentElement){var ca=H.$0(bZ).overflow;if(ca==='auto'||ca==='scroll'||ca==='hidden'){bY=bY.intersect(H.contentRectInDocumentCoordinates(bZ))}}var cb=H.contentRectInDocumentCoordinates(document.documentElement);var cc=new tab.WindowHelper(window.self);cb.left+=cc.get_pageXOffset();cb.top+=cc.get_pageYOffset();return bY.intersect(cb)};H.contentRectInDocumentCoordinates=function(e){var bY=H.getBoundingClientRect(e);var bZ=H.$0(e);var ca=H.toInt(bZ.paddingLeft);var cb=H.toInt(bZ.paddingTop);var cc=H.toInt(bZ.borderLeftWidth);var cd=H.toInt(bZ.borderTopWidth);var ce=H.computeContentSize(e);var cf=new tab.WindowHelper(window.self);var cg=bY.left+ca+cc+cf.get_pageXOffset();var ch=bY.top+cb+cd+cf.get_pageYOffset();return new A(cg,ch,ce.width,ce.height)};H.getBoundingClientRect=function(e){var bY=e.getBoundingClientRect();var bZ=ss.Int32.trunc(bY.top);var ca=ss.Int32.trunc(bY.left);var cb=ss.Int32.trunc(bY.right);var cc=ss.Int32.trunc(bY.bottom);return new A(ca,bZ,cb-ca,cc-bZ)};H.convertRawValue=function(e,bY){if(ss.isNullOrUndefined(e)){return null}switch(bY){case'bool':{return e}case'date':case'number':{if(ss.isNullOrUndefined(e)){return Number.NaN}return e}default:case'string':{return e}}};H.getDataValue=function(e){if(ss.isNullOrUndefined(e)){return bg.$ctor(null,null,null)}return bg.$ctor(H.convertRawValue(e.value,e.type),e.formattedValue,e.aliasedValue)};H.serializeDateForServer=function(e){var bY='';if(ss.isValue(e)&&H.isDate(e)){var bZ=e.getUTCFullYear();var ca=e.getUTCMonth()+1;var cb=e.getUTCDate();var cc=e.getUTCHours();var cd=e.getUTCMinutes();var ce=e.getUTCSeconds();bY=bZ+'-'+ca+'-'+cb+' '+cc+':'+cd+':'+ce}return bY};H.computeContentSize=function(e){var bY=H.$0(e);var bZ=parseFloat(bY.paddingLeft);var ca=parseFloat(bY.paddingTop);var cb=parseFloat(bY.paddingRight);var cc=parseFloat(bY.paddingBottom);var cd=e.clientWidth-Math.round(bZ+cb);var ce=e.clientHeight-Math.round(ca+cc);return bs.$ctor(cd,ce)};H.$0=function(e){if(typeof(window['getComputedStyle'])==='function'){if(ss.isValue(e.ownerDocument.defaultView.opener)){return e.ownerDocument.defaultView.getComputedStyle(e)}return window.getComputedStyle(e)}else if(ss.isValue(e['currentStyle'])){return e['currentStyle']}return e.style};global.tab._Utility=H;var I=function(){};I.__typeName='tab._VizManagerImpl';I.$4=function(){return I.$5.concat()};I.$0=function(e){I.$3(e);I.$5.push(e)};I.$2=function(e){for(var bY=0,bZ=I.$5.length;bY<bZ;bY++){if(ss.referenceEquals(I.$5[bY],e)){I.$5.splice(bY,1);break}}};I.$1=function(){for(var e=0,bY=I.$5.length;e<bY;e++){I.$5[e]._impl.$J()}};I.$3=function(e){var bY=e.getParentElement();for(var bZ=0,ca=I.$5.length;bZ<ca;bZ++){if(ss.referenceEquals(I.$5[bZ].getParentElement(),bY)){var cb="Another viz is already present in element '"+H.elementToString(bY)+"'.";throw G.create('vizAlreadyInManager',cb)}}};var J=function(e,bY,bZ){this.name='';this.host_url=null;this.tabs=false;this.toolbar=false;this.toolBarPosition=null;this.handlerId=null;this.width=null;this.height=null;this.parentElement=null;this.userSuppliedParameters=null;this.fixedSize=false;this.$2=null;this.$1=null;if(ss.isNullOrUndefined(e)||ss.isNullOrUndefined(bY)){throw G.create('noUrlOrParentElementNotFound','URL is empty or Parent element not found')}if(ss.isNullOrUndefined(bZ)){bZ=new Object;bZ.hideTabs=false;bZ.hideToolbar=false;bZ.onFirstInteractive=null}if(ss.isValue(bZ.height)||ss.isValue(bZ.width)){this.fixedSize=true;if(H.isNumber(bZ.height)){bZ.height=bZ.height.toString()+'px'}if(H.isNumber(bZ.width)){bZ.width=bZ.width.toString()+'px'}this.height=(ss.isValue(bZ.height)?bZ.height.toString():null);this.width=(ss.isValue(bZ.width)?bZ.width.toString():null)}else{this.fixedSize=false}this.tabs=!(bZ.hideTabs||false);this.toolbar=!(bZ.hideToolbar||false);this.parentElement=e;this.$1=bZ;this.toolBarPosition=bZ.toolbarPosition;var ca=bY.split('?');this.$2=ca[0];if(ca.length===2){this.userSuppliedParameters=ca[1]}else{this.userSuppliedParameters=''}var cb=(new RegExp('.*?[^/:]/','')).exec(this.$2);if(ss.isNullOrUndefined(cb)||cb[0].toLowerCase().indexOf('http://')===-1&&cb[0].toLowerCase().indexOf('https://')===-1){throw G.create('invalidUrl','Invalid url')}this.host_url=cb[0].toLowerCase();this.name=this.$2.replace(cb[0],'');this.name=this.name.replace('views/','')};J.__typeName='tab._VizParameters';global.tab._VizParameters=J;var K=function(e,bY,bZ){this.$E=null;this.$D=null;this.$y=null;this.$s=null;this.$r=null;this.$A=new tab._Collection;this.$v=false;this.$x=null;this.$t=null;this.$u=new tab._Collection;this.$C=new tab._Collection;this.$B=new tab._Collection;this.$z=null;this.$w=null;this.$D=e;this.$x=bY;this.$5(bZ)};K.__typeName='tab._WorkbookImpl';K.$0=function(e){e=ss.coalesce(e,[]);var bY=[];for(var bZ=0;bZ<e.length;bZ++){var ca=e[bZ];var cb=O.convertDashboardObjectType(ca.zoneType);var cc=bs.$ctor(ca.width,ca.height);var cd=bp.$ctor(ca.x,ca.y);var ce=ca.name;var cf={name:ce,objectType:cb,position:cd,size:cc,zoneId:ca.zoneId};bY.push(cf)}return bY};K.$2=function(e){if(ss.isNullOrUndefined(e)){return null}if(H.isString(e)){return e}var bY=ss.safeCast(e,bO);if(ss.isValue(bY)){return bY.getName()}var bZ=ss.safeCast(e,bP);if(ss.isValue(bZ)){return bZ.getName()}return null};K.$1=function(e){if(ss.isNullOrUndefined(e)){return br.createAutomatic()}return br.fromSizeConstraints(e.sizeConstraints)};K.$4=function(e){var bY=new tab._Collection;for(var bZ=0;bZ<e.parameters.length;bZ++){var ca=e.parameters[bZ];var cb=new k(ca);bY._add(cb.$7(),cb.$8())}return bY};K.$3=function(e,bY){for(var bZ=0;bZ<bY.parameters.length;bZ++){var ca=bY.parameters[bZ];if(ss.referenceEquals(ca.name,e)){return new k(ca)}}return null};global.tab._WorkbookImpl=K;var L=function(e,bY,bZ,ca){this.$E=null;this.$C=null;this.$B=new tab._Collection;this.$D=new tab._Collection;B.call(this,e,bY,bZ);this.$C=ca};L.__typeName='tab._WorksheetImpl';L.$2=function(e){var bY=e;if(ss.isValue(bY)&&ss.isValue(bY.errorCode)){var bZ=(ss.isValue(bY.additionalInformation)?bY.additionalInformation.toString():'');switch(bY.errorCode){case'invalidFilterFieldName':{return G.create('invalidFilterFieldName',bZ)}case'invalidFilterFieldValue':{return G.create('invalidFilterFieldValue',bZ)}case'invalidAggregationFieldName':{return G.$0(bZ)}default:{return G.createServerError(bZ)}}}return null};L.$3=function(e){if(ss.isNullOrUndefined(e)){throw G.createNullOrEmptyParameter('filterOptions')}if(ss.isNullOrUndefined(e.min)&&ss.isNullOrUndefined(e.max)){throw G.create('invalidParameter','At least one of filterOptions.min or filterOptions.max must be specified.')}var bY=new Object;if(ss.isValue(e.min)){bY.min=e.min}if(ss.isValue(e.max)){bY.max=e.max}if(ss.isValue(e.nullOption)){bY.nullOption=l.$1(U).call(null,e.nullOption,'filterOptions.nullOption')}return bY};L.$4=function(e){if(ss.isNullOrUndefined(e)){throw G.createNullOrEmptyParameter('filterOptions')}var bY=new Object;bY.rangeType=l.$1(N).call(null,e.rangeType,'filterOptions.rangeType');bY.periodType=l.$1(X).call(null,e.periodType,'filterOptions.periodType');if(bY.rangeType==='lastn'||bY.rangeType==='nextn'){if(ss.isNullOrUndefined(e.rangeN)){throw G.create('missingRangeNForRelativeDateFilters','Missing rangeN field for a relative date filter of LASTN or NEXTN.')}bY.rangeN=H.toInt(e.rangeN)}if(ss.isValue(e.anchorDate)){if(!H.isDate(e.anchorDate)||!H.isDateValid(e.anchorDate)){throw G.createInvalidDateParameter('filterOptions.anchorDate')}bY.anchorDate=e.anchorDate}return bY};L.$0=function(e,bY,bZ){return new(ss.makeGenericType(bd,[Object]))(e,1,function(ca){var cb=L.$2(ca);if(ss.isNullOrUndefined(cb)){bZ.resolve(bY)}else{bZ.reject(cb)}},function(ca,cb){if(ca){bZ.reject(G.createInvalidFilterFieldNameOrValue(bY))}else{var cc=G.create('filterCannotBePerformed',cb);bZ.reject(cc)}})};L.$1=function(e){var bY=e;if(ss.isValue(bY)&&ss.isValue(bY.errorCode)){var bZ=(ss.isValue(bY.additionalInformation)?bY.additionalInformation.toString():'');switch(bY.errorCode){case'invalidSelectionFieldName':{return G.create('invalidSelectionFieldName',bZ)}case'invalidSelectionValue':{return G.create('invalidSelectionValue',bZ)}case'invalidSelectionDate':{return G.create('invalidSelectionDate',bZ)}}}return null};global.tab._WorksheetImpl=L;var M=function(){};M.__typeName='tab.ApiDashboardObjectType';global.tab.ApiDashboardObjectType=M;var N=function(){};N.__typeName='tab.ApiDateRangeType';global.tab.ApiDateRangeType=N;var O=function(){};O.__typeName='tab.ApiEnumConverter';O.convertDashboardObjectType=function(e){switch(e){case'blank':{return'blank'}case'image':{return'image'}case'legend':{return'legend'}case'pageFilter':{return'pageFilter'}case'parameterControl':{return'parameterControl'}case'quickFilter':{return'quickFilter'}case'text':{return'text'}case'title':{return'title'}case'webPage':{return'webPage'}case'worksheet':{return'worksheet'}default:{throw G.createInternalError('Unknown ApiCrossDomainDashboardObjectType: '+e)}}};O.convertDateRange=function(e){switch(e){case'curr':{return'curr'}case'last':{return'last'}case'lastn':{return'lastn'}case'next':{return'next'}case'nextn':{return'nextn'}case'todate':{return'todate'}default:{throw G.createInternalError('Unknown ApiCrossDomainDateRangeType: '+e)}}};O.convertFieldAggregation=function(e){switch(e){case'ATTR':{return'ATTR'}case'AVG':{return'AVG'}case'COUNT':{return'COUNT'}case'COUNTD':{return'COUNTD'}case'DAY':{return'DAY'}case'END':{return'END'}case'HOUR':{return'HOUR'}case'INOUT':{return'INOUT'}case'KURTOSIS':{return'KURTOSIS'}case'MAX':{return'MAX'}case'MDY':{return'MDY'}case'MEDIAN':{return'MEDIAN'}case'MIN':{return'MIN'}case'MINUTE':{return'MINUTE'}case'MONTH':{return'MONTH'}case'MONTHYEAR':{return'MONTHYEAR'}case'NONE':{return'NONE'}case'PERCENTILE':{return'PERCENTILE'}case'QUART1':{return'QUART1'}case'QUART3':{return'QUART3'}case'QTR':{return'QTR'}case'SECOND':{return'SECOND'}case'SKEWNESS':{return'SKEWNESS'}case'STDEV':{return'STDEV'}case'STDEVP':{return'STDEVP'}case'SUM':{return'SUM'}case'SUM_XSQR':{return'SUM_XSQR'}case'TRUNC_DAY':{return'TRUNC_DAY'}case'TRUNC_HOUR':{return'TRUNC_HOUR'}case'TRUNC_MINUTE':{return'TRUNC_MINUTE'}case'TRUNC_MONTH':{return'TRUNC_MONTH'}case'TRUNC_QTR':{return'TRUNC_QTR'}case'TRUNC_SECOND':{return'TRUNC_SECOND'}case'TRUNC_WEEK':{return'TRUNC_WEEK'}case'TRUNC_YEAR':{return'TRUNC_YEAR'}case'USER':{return'USER'}case'VAR':{return'VAR'}case'VARP':{return'VARP'}case'WEEK':{return'WEEK'}case'WEEKDAY':{return'WEEKDAY'}case'YEAR':{return'YEAR'}default:{throw G.createInternalError('Unknown ApiCrossDomainFieldAggregationType: '+e)}}};O.convertFieldRole=function(e){switch(e){case'dimension':{return'dimension'}case'measure':{return'measure'}case'unknown':{return'unknown'}default:{throw G.createInternalError('Unknown ApiCrossDomainFieldRoleType: '+e)}}};O.convertFilterType=function(e){switch(e){case'categorical':{return'categorical'}case'hierarchical':{return'hierarchical'}case'quantitative':{return'quantitative'}case'relativedate':{return'relativedate'}default:{throw G.createInternalError('Unknown ApiCrossDomainFilterType: '+e)}}};O.convertParameterAllowableValuesType=function(e){switch(e){case'all':{return'all'}case'list':{return'list'}case'range':{return'range'}default:{throw G.createInternalError('Unknown ApiCrossDomainParameterAllowableValuesType: '+e)}}};O.convertParameterDataType=function(e){switch(e){case'boolean':{return'boolean'}case'date':{return'date'}case'datetime':{return'datetime'}case'float':{return'float'}case'integer':{return'integer'}case'string':{return'string'}default:{throw G.createInternalError('Unknown ApiCrossDomainParameterDataType: '+e)}}};O.convertPeriodType=function(e){switch(e){case'year':{return'year'}case'quarter':{return'quarter'}case'month':{return'month'}case'week':{return'week'}case'day':{return'day'}case'hour':{return'hour'}case'minute':{return'minute'}case'second':{return'second'}default:{throw G.createInternalError('Unknown ApiCrossDomainPeriodType: '+e)}}};O.convertSheetType=function(e){switch(e){case'worksheet':{return'worksheet'}case'dashboard':{return'dashboard'}case'story':{return'story'}default:{throw G.createInternalError('Unknown ApiCrossDomainSheetType: '+e)}}};global.tab.ApiEnumConverter=O;var P=function(){};P.__typeName='tab.ApiErrorCode';global.tab.ApiErrorCode=P;var Q=function(){};Q.__typeName='tab.ApiFieldAggregationType';global.tab.ApiFieldAggregationType=Q;var R=function(){};R.__typeName='tab.ApiFieldRoleType';global.tab.ApiFieldRoleType=R;var S=function(){};S.__typeName='tab.ApiFilterType';global.tab.ApiFilterType=S;var T=function(){};T.__typeName='tab.ApiFilterUpdateType';global.tab.ApiFilterUpdateType=T;var U=function(){};U.__typeName='tab.ApiNullOption';global.tab.ApiNullOption=U;var V=function(){};V.__typeName='tab.ApiParameterAllowableValuesType';global.tab.ApiParameterAllowableValuesType=V;var W=function(){};W.__typeName='tab.ApiParameterDataType';global.tab.ApiParameterDataType=W;var X=function(){};X.__typeName='tab.ApiPeriodType';global.tab.ApiPeriodType=X;var Y=function(){};Y.__typeName='tab.ApiSelectionUpdateType';global.tab.ApiSelectionUpdateType=Y;var Z=function(){};Z.__typeName='tab.ApiSheetSizeBehavior';global.tab.ApiSheetSizeBehavior=Z;var ba=function(){};ba.__typeName='tab.ApiSheetType';global.tab.ApiSheetType=ba;var bb=function(){};bb.__typeName='tab.ApiTableauEventName';global.tab.ApiTableauEventName=bb;var bc=function(){};bc.__typeName='tab.ApiToolbarPosition';global.tab.ApiToolbarPosition=bc;var bd=function(e){var bY=function(bZ,ca,cb,cc){this.$0=null;this.$3=0;this.$2=null;this.$1=null;this.$0=bZ;this.$2=cb;this.$3=ca;this.$1=cc};ss.registerGenericClassInstance(bY,bd,[e],{get_commandName:function(){return this.$0},get_successCallback:function(){return this.$2},get_successCallbackTiming:function(){return this.$3},get_errorCallback:function(){return this.$1}},function(){return null},function(){return[]});return bY};bd.__typeName='tab.CommandReturnHandler$1';ss.initGenericClass(bd,a,1);global.tab.CommandReturnHandler$1=bd;var be=function(e,bY){this.$1=null;this.$0=null;y.verifyValue(e,'router');y.verifyValue(bY,'handler');this.$1=e;this.$0=bY};be.__typeName='tab.CrossDomainMessagingOptions';global.tab.CrossDomainMessagingOptions=be;var bf=function(e,bY,bZ){this.$2=null;bv.call(this,e,bY);this.$2=new f(bY._impl.get__workbookImpl(),bZ)};bf.__typeName='tab.CustomViewEvent';global.tab.CustomViewEvent=bf;var bg=function(){};bg.__typeName='tab.DataValue';bg.$ctor=function(e,bY,bZ){var ca=new Object;ca.value=null;ca.formattedValue=null;ca.value=e;if(H.isNullOrEmpty(bZ)){ca.formattedValue=bY}else{ca.formattedValue=bZ}return ca};global.tab.DataValue=bg;var bh=function(e,bY){this.$0=null;this.$1=null;this.$0=e;this.$1=bY};bh.__typeName='tab.EventContext';global.tab.EventContext=bh;var bi=function(e,bY,bZ,ca,cb){this.$4=null;this.$3=null;bA.call(this,e,bY,bZ);this.$4=cb;this.$3=new g(bY._impl.get__workbookImpl(),bZ,ca,cb)};bi.__typeName='tab.FilterEvent';global.tab.FilterEvent=bi;var bj=function(e,bY,bZ){this.$2=null;bv.call(this,e,bY);this.$2=bZ};bj.__typeName='tab.FirstVizSizeKnownEvent';global.tab.FirstVizSizeKnownEvent=bj;var bk=function(){};bk.__typeName='tab.ICrossDomainMessageHandler';global.tab.ICrossDomainMessageHandler=bk;var bl=function(){};bl.__typeName='tab.ICrossDomainMessageRouter';global.tab.ICrossDomainMessageRouter=bl;var bm=function(){};bm.__typeName='tab.JsonUtil';bm.parseJson=function(e){if(ss.isNullOrEmptyString(e)){return null}return x.parseJSON(e)};bm.toJson=function(e,bY,bZ){bY=bY||false;bZ=bZ||'';var ca=[];return bm.$3(e,bY,bZ,ca)};bm.$2=function(e,bY,bZ){if(ss.isValue(Array.prototype['indexOf'])){return e.indexOf(bY,bZ)}bZ=bZ||0;var ca=e.length;if(ca>0){for(var cb=bZ;cb<ca;cb++){if(ss.referenceEquals(e[cb],bY)){return cb}}}return-1};bm.$0=function(e,bY,bZ){var ca=bm.$2(e,bY,bZ);return ca>=0};bm.$3=function(e,bY,bZ,ca){if(bm.$0(ca,e)){throw new ss.Exception('The object contains recursive reference of sub-objects')}if(typeof(e)==='undefined'){return'undefined'}if(ss.isNullOrUndefined(e)){return'null'}var cb=x.type(e);if(cb==='number'||cb==='boolean'){return e.toString()}if(cb==='string'){return bm.$1(e)}ca.push(e);var cc;bZ=bZ||'';var cd=(bY?(bZ+'\t'):'');var ce=e.__json__||e.json;if(x.isFunction(ce)){var cf=ce;cc=cf(e);if(!ss.referenceEquals(e,cc)){var cg=bm.$3(cc,bY,cd,ca);ca.pop();return cg}}if(ss.isValue(e.nodeType)&&ss.isValue(e.cloneNode)){throw new ss.Exception("Can't serialize DOM nodes")}var ch=(bY?' ':'');var ci=(bY?'\n':'');if(x.isArray(e)){return bm.$4(e,bY,bZ,ca,cd,ci)}if(cb==='function'){ca.pop();return null}return bm.$5(e,bY,bZ,ca,cd,ci,ch)};bm.$5=function(e,bY,bZ,ca,cb,cc,cd){var ce=e;var cf=new ss.StringBuilder('{');var cg=false;var ch=new ss.ObjectEnumerator(ce);try{while(ch.moveNext()){var ci=ch.current();var cj;var ck;if(typeof(ci.key)==='number'){cj='"'+ci.key+'"'}else if(typeof(ci.key)==='string'){cj=bm.$1(ci.key)}else{continue}ck=bm.$3(ci.value,bY,cb,ca);if(ss.isNullOrUndefined(ck)){continue}if(cg){cf.append(',')}cf.append(cc+cb+cj+':'+cd+ck);cg=true}}finally{ch.dispose()}cf.append(cc+bZ+'}');ca.pop();return cf.toString()};bm.$4=function(e,bY,bZ,ca,cb,cc){var cd=false;var ce=new ss.StringBuilder('[');var cf=e;for(var cg=0;cg<cf.length;cg++){var ch=cf[cg];var ci=bm.$3(ch,bY,cb,ca);if(ss.isNullOrUndefined(ci)){ci='undefined'}if(cd){ce.append(',')}ce.append(cc+cb+ci);cd=true}ce.append(cc+bZ+']');ca.pop();return ce.toString()};bm.$1=function(e){e='"'+e.replace(new RegExp('(["\\\\])','g'),'\\$1')+'"';e=e.replace(new RegExp('[\f]','g'),'\\f');e=e.replace(new RegExp('[\b]','g'),'\\b');e=e.replace(new RegExp('[\n]','g'),'\\n');e=e.replace(new RegExp('[\t]','g'),'\\t');e=e.replace(new RegExp('[\r]','g'),'\\r');return e};global.tab.JsonUtil=bm;var bn=function(e,bY,bZ){this.$3=null;bA.call(this,e,bY,bZ);this.$3=new m(bY._impl.get__workbookImpl(),bZ)};bn.__typeName='tab.MarksEvent';global.tab.MarksEvent=bn;var bo=function(e,bY,bZ){this.$2=null;bv.call(this,e,bY);this.$2=new d(bY._impl.get__workbookImpl(),bZ)};bo.__typeName='tab.ParameterEvent';global.tab.ParameterEvent=bo;var bp=function(){};bp.__typeName='tab.Point';bp.$ctor=function(e,bY){var bZ=new Object;bZ.x=0;bZ.y=0;bZ.x=e;bZ.y=bY;return bZ};global.tab.Point=bp;var bq=function(){};bq.__typeName='tab.SheetSize';bq.$ctor=function(e,bY,bZ){var ca=new Object;ca.behavior=null;ca.minSize=null;ca.maxSize=null;ca.behavior=ss.coalesce(e,'automatic');if(ss.isValue(bY)){ca.minSize=bY}else{delete ca['minSize']}if(ss.isValue(bZ)){ca.maxSize=bZ}else{delete ca['maxSize']}return ca};global.tab.SheetSize=bq;var br=function(){};br.__typeName='tab.SheetSizeFactory';br.createAutomatic=function(){var e=bq.$ctor('automatic',null,null);return e};br.fromSizeConstraints=function(e){var bY=e.minHeight;var bZ=e.minWidth;var ca=e.maxHeight;var cb=e.maxWidth;var cc='automatic';var cd=null;var ce=null;if(bY===0&&bZ===0){if(ca===0&&cb===0){}else{cc='atmost';ce=bs.$ctor(cb,ca)}}else if(ca===0&&cb===0){cc='atleast';cd=bs.$ctor(bZ,bY)}else if(ca===bY&&cb===bZ){cc='exactly';cd=bs.$ctor(bZ,bY);ce=bs.$ctor(bZ,bY)}else{cc='range';cd=bs.$ctor(bZ,bY);ce=bs.$ctor(cb,ca)}return bq.$ctor(cc,cd,ce)};global.tab.SheetSizeFactory=br;var bs=function(){};bs.__typeName='tab.Size';bs.$ctor=function(e,bY){var bZ=new Object;bZ.width=0;bZ.height=0;bZ.width=e;bZ.height=bY;return bZ};global.tab.Size=bs;var bt=function(){};bt.__typeName='tab.StoryPointInfoImplUtil';bt.clone=function(e){return F.$ctor(e.caption,e.index,e.storyPointId,e.isActive,e.isUpdated,e.parentStoryImpl)};global.tab.StoryPointInfoImplUtil=bt;var bu=function(e,bY,bZ,ca){this.$3=null;this.$2=null;bv.call(this,e,bY);this.$3=bZ;this.$2=ca};bu.__typeName='tab.StoryPointSwitchEvent';global.tab.StoryPointSwitchEvent=bu;var bv=function(e,bY){this.$1=null;this.$0=null;this.$1=bY;this.$0=e};bv.__typeName='tab.TableauEvent';global.tab.TableauEvent=bv;var bw=function(e,bY,bZ,ca){this.$3=null;this.$2=null;bv.call(this,e,bY);this.$3=bZ;this.$2=ca};bw.__typeName='tab.TabSwitchEvent';global.tab.TabSwitchEvent=bw;var bx=function(e,bY,bZ,ca,cb){this.$15=null;this.$1i=null;this.$18=null;this.$1h=null;this.$19=null;this.$1b=null;this.$1l=null;this.$1f=null;this.$1g=null;this.$1e=false;this.$17=false;this.$1c=false;this.$16=false;this.$1d=null;this.$1j=null;this.$1k=null;this.$1a=false;this.$1$1=null;this.$1$2=null;this.$1$3=null;this.$1$4=null;this.$1$5=null;this.$1$6=null;this.$1$7=null;this.$1$8=null;this.$1$9=null;this.$1$10=null;this.$1$11=null;this.$1$12=null;if(!H.hasWindowPostMessage()||!H.hasJsonParse()){throw G.createBrowserNotCapable()}this.$1d=new be(e,this);this.$1i=bY;if(ss.isNullOrUndefined(bZ)||bZ.nodeType!==1){bZ=document.body}this.$1h=new J(bZ,ca,cb);if(ss.isValue(cb)){this.$1f=cb.onFirstInteractive;this.$1g=cb.onFirstVizSizeKnown}};bx.__typeName='tab.VizImpl';global.tab.VizImpl=bx;var by=function(e,bY,bZ){this.$2=null;bv.call(this,e,bY);this.$2=bZ};by.__typeName='tab.VizResizeEvent';global.tab.VizResizeEvent=by;var bz=function(){};bz.__typeName='tab.VizSize';bz.$ctor=function(e,bY){var bZ=new Object;bZ.sheetSize=null;bZ.chromeHeight=0;bZ.sheetSize=e;bZ.chromeHeight=bY;return bZ};global.tab.VizSize=bz;var bA=function(e,bY,bZ){this.$2=null;bv.call(this,e,bY);this.$2=bZ};bA.__typeName='tab.WorksheetEvent';global.tab.WorksheetEvent=bA;var bB=function(e,bY){this.$a=false;this.$9=null;bH.call(this,e,bY);this.$8(bY)};bB.__typeName='tableauSoftware.CategoricalFilter';global.tableauSoftware.CategoricalFilter=bB;var bC=function(e){this._impl=null;this._impl=e};bC.__typeName='tableauSoftware.CustomView';global.tableauSoftware.CustomView=bC;var bD=function(e){this._impl=null;bO.call(this,e)};bD.__typeName='tableauSoftware.Dashboard';global.tableauSoftware.Dashboard=bD;var bE=function(e,bY,bZ){this.$2=null;this.$0=null;this.$1=null;if(e.objectType==='worksheet'&&ss.isNullOrUndefined(bZ)){throw G.createInternalError('worksheet parameter is required for WORKSHEET objects')}else if(e.objectType!=='worksheet'&&ss.isValue(bZ)){throw G.createInternalError('worksheet parameter should be undefined for non-WORKSHEET objects')}this.$2=e;this.$0=bY;this.$1=bZ};bE.__typeName='tableauSoftware.DashboardObject';global.tableauSoftware.DashboardObject=bE;var bF=function(e){this.$0=null;this.$0=e};bF.__typeName='tableauSoftware.DataSource';global.tableauSoftware.DataSource=bF;var bG=function(e,bY,bZ,ca){this.$0=null;this.$3=null;this.$2=null;this.$1=null;this.$0=e;this.$3=bY;this.$2=bZ;this.$1=ca};bG.__typeName='tableauSoftware.Field';global.tableauSoftware.Field=bG;var bH=function(e,bY){this.$7=null;this.$6=null;this.$1=null;this.$3=null;this.$2=null;this.$5=null;this.$4=null;this.$7=e;this.$0(bY)};bH.__typeName='tableauSoftware.Filter';bH.$0=function(e,bY){switch(bY.filterType){case'categorical':{return new bB(e,bY)}case'relativedate':{return new bN(e,bY)}case'hierarchical':{return new bI(e,bY)}case'quantitative':{return new bM(e,bY)}}return null};bH.$1=function(e,bY){var bZ=new tab._Collection;for(var ca=0;ca<bY.filters.length;ca++){var cb=bY.filters[ca];var cc=bH.$0(e,cb);bZ._add(cb.caption,cc)}return bZ};global.tableauSoftware.Filter=bH;var bI=function(e,bY){this.$9=0;bH.call(this,e,bY);this.$8(bY)};bI.__typeName='tableauSoftware.HierarchicalFilter';global.tableauSoftware.HierarchicalFilter=bI;var bJ=function(e){this.$0=null;this.$0=new j(e)};bJ.__typeName='tableauSoftware.Mark';global.tableauSoftware.Mark=bJ;var bK=function(e,bY){this.fieldName=null;this.value=null;this.formattedValue=null;this.fieldName=e;this.value=bY;this.formattedValue=(ss.isValue(bY)?bY.toString():'')};bK.__typeName='tableauSoftware.Pair';global.tableauSoftware.Pair=bK;var bL=function(e){this._impl=null;this._impl=e};bL.__typeName='tableauSoftware.Parameter';global.tableauSoftware.Parameter=bL;var bM=function(e,bY){this.$a=null;this.$9=null;this.$d=null;this.$c=null;this.$b=false;bH.call(this,e,bY);this.$8(bY)};bM.__typeName='tableauSoftware.QuantitativeFilter';global.tableauSoftware.QuantitativeFilter=bM;var bN=function(e,bY){this.$9=null;this.$b=null;this.$a=0;bH.call(this,e,bY);this.$8(bY)};bN.__typeName='tableauSoftware.RelativeDateFilter';global.tableauSoftware.RelativeDateFilter=bN;var bO=function(e){this._impl=null;y.verifyValue(e,'sheetImpl');this._impl=e};bO.__typeName='tableauSoftware.Sheet';global.tableauSoftware.Sheet=bO;var bP=function(e){this.$0=null;this.$0=e};bP.__typeName='tableauSoftware.SheetInfo';global.tableauSoftware.SheetInfo=bP;var bQ=function(e){this._impl=null;bO.call(this,e)};bQ.__typeName='tableauSoftware.Story';global.tableauSoftware.Story=bQ;var bR=function(e){this.$0=null;this.$0=e};bR.__typeName='tableauSoftware.StoryPoint';global.tableauSoftware.StoryPoint=bR;var bS=function(e){this._impl=null;this._impl=e};bS.__typeName='tableauSoftware.StoryPointInfo';global.tableauSoftware.StoryPointInfo=bS;var bT=function(e,bY,bZ,ca){this.$0=0;this.$2=0;this.$3=0;this.$1=null;this.$0=e;this.$2=bY;this.$3=bZ;this.$1=ss.coalesce(ca,null)};bT.__typeName='tableauSoftware.Version';bT.getCurrent=function(){return bT.$0};global.tableauSoftware.Version=bT;var bU=function(e,bY,bZ){this._impl=null;var ca=p.getCrossDomainMessageRouter();this._impl=new bx(ca,this,e,bY,bZ);this._impl.$4()};bU.__typeName='tableauSoftware.Viz';global.tableauSoftware.Viz=bU;var bV=function(){};bV.__typeName='tableauSoftware.VizManager';bV.getVizs=function(){return I.$4()};global.tableauSoftware.VizManager=bV;var bW=function(e){this.$0=null;this.$0=e};bW.__typeName='tableauSoftware.Workbook';global.tableauSoftware.Workbook=bW;var bX=function(e){this._impl=null;bO.call(this,e)};bX.__typeName='tableauSoftware.Worksheet';global.tableauSoftware.Worksheet=bX;ss.initInterface(bl,a,{registerHandler:null,unregisterHandler:null,sendCommand:null});ss.initClass(b,a,{registerHandler:function(e){var bY='handler'+this.$9;if(ss.isValue(e.get_handlerId())||ss.isValue(this.$8[e.get_handlerId()])){throw G.createInternalError("Handler '"+e.get_handlerId()+"' is already registered.")}this.$9++;e.set_handlerId(bY);this.$8[bY]=e;e.add_customViewsListLoad(ss.mkdel(this,this.$2));e.add_stateReadyForQuery(ss.mkdel(this,this.$4))},unregisterHandler:function(e){if(ss.isValue(e.get_handlerId())||ss.isValue(this.$8[e.get_handlerId()])){delete this.$8[e.get_handlerId()];e.remove_customViewsListLoad(ss.mkdel(this,this.$2));e.remove_stateReadyForQuery(ss.mkdel(this,this.$4))}},sendCommand:function(e){return function(bY,bZ,ca){var cb=bY.get_iframe();var cc=bY.get_handlerId();if(!H.hasWindowPostMessage()||ss.isNullOrUndefined(cb)||ss.isNullOrUndefined(cb.contentWindow)){return}var cd=o.generateNextCommandId();var ce=this.$5[cc];if(ss.isNullOrUndefined(ce)){ce={};this.$5[cc]=ce}ce[cd]=ca;var cf=ca.get_commandName();if(cf==='api.ShowCustomViewCommand'){var cg=this.$7[cc];if(ss.isNullOrUndefined(cg)){cg=[];this.$7[cc]=cg}cg.push(ca)}var ch=null;if(ss.isValue(bZ)){ch=bm.toJson(bZ,false,'')}var ci=new o(cf,cd,cc,ch);var cj=ci.serialize();if(H.isPostMessageSynchronous()){window.setTimeout(function(){cb.contentWindow.postMessage(cj,'*')},0)}else{cb.contentWindow.postMessage(cj,'*')}}},$2:function(e){var bY=e.get_handlerId();var bZ=this.$7[bY];if(ss.isNullOrUndefined(bZ)){return}for(var ca=0;ca<bZ.length;ca++){var cb=bZ[ca];if(!ss.staticEquals(cb.get_successCallback(),null)){cb.get_successCallback()(null)}}delete this.$7[bY]},$4:function(e){var bY=this.$6[e.get_handlerId()];if(H.isNullOrEmpty(bY)){return}while(bY.length>0){var bZ=bY.pop();if(ss.isValue(bZ)){bZ()}}},$0:function(e){var bY=e;if(ss.isNullOrUndefined(bY.data)){return}var bZ=o.parse(bY.data.toString());var ca=bZ.get_rawName();var cb=bZ.get_handlerId();var cc=this.$8[cb];if(ss.isNullOrUndefined(cc)||!ss.referenceEquals(cc.get_handlerId(),bZ.get_handlerId())){cc=new c}if(bZ.get_isApiCommandName()){if(bZ.get_commandId()==='xdomainSourceId'){cc.handleEventNotification(bZ.get_name(),bZ.get_parameters());if(bZ.get_name()==='api.FirstVizSizeKnownEvent'){bY.source.postMessage('tableau.bootstrap'.toString(),'*')}}else{this.$1(bZ)}}else{this.$3(ca,cc)}},$1:function(e){var bY=this.$5[e.get_handlerId()];var bZ=(ss.isValue(bY)?bY[e.get_commandId()]:null);if(ss.isNullOrUndefined(bZ)){return}delete bY[e.get_commandId()];if(e.get_name()!==bZ.get_commandName()){return}var ca=new r(e.get_parameters());var cb=ca.get_data();if(ca.get_result()==='api.success'){switch(bZ.get_successCallbackTiming()){case 0:{if(ss.isValue(bZ.get_successCallback())){bZ.get_successCallback()(cb)}break}case 1:{var cc=function(){if(ss.isValue(bZ.get_successCallback())){bZ.get_successCallback()(cb)}};var cd=this.$6[e.get_handlerId()];if(ss.isNullOrUndefined(cd)){cd=[];this.$6[e.get_handlerId()]=cd}cd.push(cc);break}default:{throw G.createInternalError('Unknown timing value: '+bZ.get_successCallbackTiming())}}}else if(ss.isValue(bZ.get_errorCallback())){var ce=ca.get_result()==='api.remotefailed';var cf=(ss.isValue(cb)?cb.toString():'');bZ.get_errorCallback()(ce,cf)}},$3:function(e,bY){if(ss.referenceEquals(e,'layoutInfoReq'.toString())){I.$1()}else if(ss.referenceEquals(e,'tableau.completed'.toString())||ss.referenceEquals(e,'completed'.toString())){bY.handleVizLoad()}else if(e==='tableau.listening'){bY.handleVizListening()}}},null,[bl]);ss.initInterface(bk,a,{add_customViewsListLoad:null,remove_customViewsListLoad:null,add_stateReadyForQuery:null,remove_stateReadyForQuery:null,get_iframe:null,get_handlerId:null,set_handlerId:null,handleVizLoad:null,handleVizListening:null,handleEventNotification:null});ss.initClass(c,a,{add_customViewsListLoad:function(e){this.$1$1=ss.delegateCombine(this.$1$1,e)},remove_customViewsListLoad:function(e){this.$1$1=ss.delegateRemove(this.$1$1,e)},add_stateReadyForQuery:function(e){this.$1$2=ss.delegateCombine(this.$1$2,e)},remove_stateReadyForQuery:function(e){this.$1$2=ss.delegateRemove(this.$1$2,e)},get_iframe:function(){return null},get_handlerId:function(){return this.$2},set_handlerId:function(e){this.$2=e},$1:function(){return'*'},handleVizLoad:function(){},handleVizListening:function(){},handleEventNotification:function(e,bY){},$0:function(){this.$1$1(null);this.$1$2(null)}},null,[bk]);ss.initClass(bh,a,{get__workbookImpl:function(){return this.$0},get__worksheetImpl:function(){return this.$1}});ss.initClass(d,a,{get__parameterName:function(){return this.$2}},bh);ss.initClass(f,a,{get__customViewImpl:function(){return this.$2}},bh);ss.initClass(g,a,{get__filterFieldName:function(){return this.$3},$2:function(){return this.$4}},bh);ss.initClass(h,a,{});ss.initClass(i,a,{});ss.initClass(j,a,{$2:function(){return this.$5},$3:function(){return this.$6},$1:function(){if(ss.isNullOrUndefined(this.$4)){this.$4=this.$5._toApiCollection()}return this.$4},$0:function(e){this.$5._add(e.fieldName,e)}});ss.initClass(k,a,{$8:function(){if(ss.isNullOrUndefined(this.$i)){this.$i=new bL(this)}return this.$i},$7:function(){return this.$h},$2:function(){return this.$c},$3:function(){return this.$d},$1:function(){return this.$b},$0:function(){return this.$a},$6:function(){return this.$g},$5:function(){return this.$f},$9:function(){return this.$j},$4:function(){return this.$e}});ss.initClass(l,a,{});ss.initClass(m,a,{},bh);ss.initClass(n,a,{});ss.initClass(o,a,{get_name:function(){return this.$2},get_handlerId:function(){return this.$1},get_commandId:function(){return this.$0},get_parameters:function(){return this.$3},get_isApiCommandName:function(){return this.get_rawName().indexOf('api.',0)===0},get_rawName:function(){return this.$2.toString()},serialize:function(){var e=[];e.push(this.$2);e.push(this.$0);e.push(this.$1);if(ss.isValue(this.$3)){e.push(this.$3)}var bY=e.join(',');return bY}});ss.initClass(p,a,{});ss.initClass(q,a,{get_workbookName:function(){return this.$1},get_worksheetName:function(){return this.$2},get_data:function(){return this.$0},serialize:function(){var e={};e['api.workbookName']=this.$1;e['api.worksheetName']=this.$2;e['api.commandData']=this.$0;return JSON.stringify(e)}});ss.initClass(r,a,{get_result:function(){return this.$1},get_data:function(){return this.$0}});ss.initClass(s,a,{get__length:function(){return this.$4.length},get__rawArray:function(){return this.$4},get_item:function(e){return this.$4[e]},_get:function(e){var bY=this.$0(e);if(ss.isValue(this.$3[bY])){return this.$3[bY]}return undefined},_has:function(e){return ss.isValue(this._get(e))},_add:function(e,bY){this.$1(e,bY);var bZ=this.$0(e);this.$4.push(bY);this.$3[bZ]=bY},_addToFirst:function(e,bY){this.$1(e,bY);var bZ=this.$0(e);this.$4.unshift(bY);this.$3[bZ]=bY},_remove:function(e){var bY=this.$0(e);if(ss.isValue(this.$3[bY])){var bZ=this.$3[bY];delete this.$3[bY];for(var ca=0;ca<this.$4.length;ca++){if(ss.referenceEquals(this.$4[ca],bZ)){this.$4.splice(ca,1);break}}}},_toApiCollection:function(){var e=this.$4.concat();e.get=ss.mkdel(this,function(bY){return this._get(bY)});e.has=ss.mkdel(this,function(bY){return this._has(bY)});return e},$2:function(e){if(H.isNullOrEmpty(e)){throw new ss.Exception('Null key')}if(this._has(e)){/*throw new ss.Exception("Duplicate key '"+e+"'")*/}},$1:function(e,bY){this.$2(e);if(ss.isNullOrUndefined(bY)){throw new ss.Exception('Null item')}},$0:function(e){return'_'+e}});ss.initClass(t,a,{$5:function(){if(ss.isNullOrUndefined(this.$c)){this.$c=new bC(this)}return this.$c},$b:function(){return this.$l.get_workbook()},$a:function(){return this.$k},$7:function(){return this.$h},$8:function(e){if(this.$f){throw G.create('staleDataReference','Stale data')}this.$h=e},$9:function(){return this.$i},$3:function(){return this.$e},$4:function(e){if(this.$f){throw G.create('staleDataReference','Stale data')}this.$e=e},$6:function(){return this.$d},$2:function(){if(this.$f||ss.isNullOrUndefined(this.$j)){throw G.create('staleDataReference','Stale data')}this.$j.isPublic=this.$e;this.$j.name=this.$h;var e=new tab._Deferred;var bY={};bY['api.customViewParam']=this.$j;var bZ=t.$0('api.UpdateCustomViewCommand',e,ss.mkdel(this,function(ca){t._processCustomViewUpdate(this.$l,this.$g,ca,true);e.resolve(this.$5())}));this.$g.sendCommand(Object).call(this.$g,bY,bZ);return e.get_promise()},$1:function(){var e=new tab._Deferred;var bY={};bY['api.customViewParam']=this.$j;var bZ=t.$0('api.RemoveCustomViewCommand',e,ss.mkdel(this,function(ca){this.$f=true;t._processCustomViews(this.$l,this.$g,ca);e.resolve(this.$5())}));this.$g.sendCommand(Object).call(this.$g,bY,bZ);return e.get_promise()},_showAsync:function(){if(this.$f||ss.isNullOrUndefined(this.$j)){throw G.create('staleDataReference','Stale data')}return t._showCustomViewAsync(this.$l,this.$g,this.$j)},$0:function(e){return!ss.referenceEquals(this.$i,e.$i)||!ss.referenceEquals(this.$k,e.$k)||this.$e!==e.$e||this.$d!==e.$d}});ss.initClass(B,a,{get_sheet:null,get_name:function(){return this.$5},get_index:function(){return this.$1},get_workbookImpl:function(){return this.$a},get_workbook:function(){return this.$a.get_workbook()},get_url:function(){if(this.$3){throw G.createNoUrlForHiddenWorksheet()}return this.$9},get_size:function(){return this.$8},get_isHidden:function(){return this.$3},get_isActive:function(){return this.$2},set_isActive:function(e){this.$2=e},get_isDashboard:function(){return this.$7==='dashboard'},get_isStory:function(){return this.$7==='story'},get_sheetType:function(){return this.$7},get_parentStoryPoint:function(){if(ss.isValue(this.$6)){return this.$6.get_storyPoint()}return null},get_parentStoryPointImpl:function(){return this.$6},set_parentStoryPointImpl:function(e){if(this.$7==='story'){throw G.createInternalError('A story cannot be a child of another story.')}this.$6=e},get_zoneId:function(){return this.$b},get_messagingOptions:function(){return this.$4},changeSizeAsync:function(e){e=B.$1(e);if(this.$7==='worksheet'&&e.behavior!=='automatic'){throw G.createInvalidSizeBehaviorOnWorksheet()}var bY=new tab._Deferred;if(this.$8.behavior===e.behavior&&e.behavior==='automatic'){bY.resolve(e);return bY.get_promise()}var bZ=this.$0(e);var ca={};ca['api.setSheetSizeName']=this.$5;ca['api.minWidth']=bZ['api.minWidth'];ca['api.minHeight']=bZ['api.minHeight'];ca['api.maxWidth']=bZ['api.maxWidth'];ca['api.maxHeight']=bZ['api.maxHeight'];var cb=new(ss.makeGenericType(bd,[Object]))('api.SetSheetSizeCommand',1,ss.mkdel(this,function(cc){this.get_workbookImpl()._update(ss.mkdel(this,function(){var cd=this.get_workbookImpl().get_publishedSheets()._get(this.get_name()).getSize();bY.resolve(cd)}))}),function(cc,cd){bY.reject(G.createServerError(cd))});this.sendCommand(Object).call(this,ca,cb);return bY.get_promise()},sendCommand:function(e){return function(bY,bZ){this.$4.sendCommand(e).call(this.$4,bY,bZ)}},$0:function(e){var bY=null;if(ss.isNullOrUndefined(e)||ss.isNullOrUndefined(e.behavior)||e.behavior!=='automatic'&&ss.isNullOrUndefined(e.minSize)&&ss.isNullOrUndefined(e.maxSize)){throw G.createInvalidSheetSizeParam()}var bZ=0;var ca=0;var cb=0;var cc=0;var cd={};cd['api.minWidth']=0;cd['api.minHeight']=0;cd['api.maxWidth']=0;cd['api.maxHeight']=0;if(e.behavior==='automatic'){bY=bq.$ctor('automatic',undefined,undefined)}else if(e.behavior==='atmost'){if(ss.isNullOrUndefined(e.maxSize)||ss.isNullOrUndefined(e.maxSize.width)||ss.isNullOrUndefined(e.maxSize.height)){throw G.createMissingMaxSize()}if(e.maxSize.width<0||e.maxSize.height<0){throw G.createInvalidSizeValue()}cd['api.maxWidth']=e.maxSize.width;cd['api.maxHeight']=e.maxSize.height;bY=bq.$ctor('atmost',undefined,e.maxSize)}else if(e.behavior==='atleast'){if(ss.isNullOrUndefined(e.minSize)||ss.isNullOrUndefined(e.minSize.width)||ss.isNullOrUndefined(e.minSize.height)){throw G.createMissingMinSize()}if(e.minSize.width<0||e.minSize.height<0){throw G.createInvalidSizeValue()}cd['api.minWidth']=e.minSize.width;cd['api.minHeight']=e.minSize.height;bY=bq.$ctor('atleast',e.minSize,undefined)}else if(e.behavior==='range'){if(ss.isNullOrUndefined(e.minSize)||ss.isNullOrUndefined(e.maxSize)||ss.isNullOrUndefined(e.minSize.width)||ss.isNullOrUndefined(e.maxSize.width)||ss.isNullOrUndefined(e.minSize.height)||ss.isNullOrUndefined(e.maxSize.height)){throw G.createMissingMinMaxSize()}if(e.minSize.width<0||e.minSize.height<0||e.maxSize.width<0||e.maxSize.height<0||e.minSize.width>e.maxSize.width||e.minSize.height>e.maxSize.height){throw G.createInvalidRangeSize()}cd['api.minWidth']=e.minSize.width;cd['api.minHeight']=e.minSize.height;cd['api.maxWidth']=e.maxSize.width;cd['api.maxHeight']=e.maxSize.height;bY=bq.$ctor('range',e.minSize,e.maxSize)}else if(e.behavior==='exactly'){if(ss.isValue(e.minSize)&&ss.isValue(e.maxSize)&&ss.isValue(e.minSize.width)&&ss.isValue(e.maxSize.width)&&ss.isValue(e.minSize.height)&&ss.isValue(e.maxSize.height)){bZ=e.minSize.width;ca=e.minSize.height;cb=e.maxSize.width;cc=e.maxSize.height;if(bZ!==cb||ca!==cc){throw G.createSizeConflictForExactly()}}else if(ss.isValue(e.minSize)&&ss.isValue(e.minSize.width)&&ss.isValue(e.minSize.height)){bZ=e.minSize.width;ca=e.minSize.height;cb=bZ;cc=ca}else if(ss.isValue(e.maxSize)&&ss.isValue(e.maxSize.width)&&ss.isValue(e.maxSize.height)){cb=e.maxSize.width;cc=e.maxSize.height;bZ=cb;ca=cc}cd['api.minWidth']=bZ;cd['api.minHeight']=ca;cd['api.maxWidth']=cb;cd['api.maxHeight']=cc;bY=bq.$ctor('exactly',bs.$ctor(bZ,ca),bs.$ctor(cb,cc))}this.$8=bY;return cd}});ss.initClass(u,a,{get_sheet:function(){return this.get_dashboard()},get_dashboard:function(){if(ss.isNullOrUndefined(this.$d)){this.$d=new bD(this)}return this.$d},get_worksheets:function(){return this.$f},get_objects:function(){return this.$e},$c:function(e,bY){this.$e=new tab._Collection;this.$f=new tab._Collection;for(var bZ=0;bZ<e.length;bZ++){var ca=e[bZ];var cb=null;if(e[bZ].objectType==='worksheet'){var cc=ca.name;if(ss.isNullOrUndefined(cc)){continue}var cd=this.$f.get__length();var ce=br.createAutomatic();var cf=false;var cg=bY(cc);var ch=ss.isNullOrUndefined(cg);var ci=(ch?'':cg.getUrl());var cj=C.$ctor(cc,'worksheet',cd,ce,this.get_workbook(),ci,cf,ch,ca.zoneId);var ck=new L(cj,this.get_workbookImpl(),this.get_messagingOptions(),this);cb=ck.get_worksheet();this.$f._add(cc,ck.get_worksheet())}var cl=new bE(ca,this.get_dashboard(),cb);this.$e._add(bZ.toString(),cl)}}},B);ss.initClass(v,a,{get_dataSource:function(){if(ss.isNullOrUndefined(this.$0)){this.$0=new bF(this)}return this.$0},get_name:function(){return this.$3},get_fields:function(){return this.$1},get_isPrimary:function(){return this.$2},addField:function(e){this.$1._add(e.getName(),e)}});ss.initClass(w,a,{get_promise:function(){return this.$3},all:function(e){var bY=new w;var bZ=e.length;var ca=bZ;var cb=[];if(bZ===0){bY.resolve(cb);return bY.get_promise()}var cc=function(ce,cf){var cg=i.$0(ce);cg.then(function(ch){cb[cf]=ch;ca--;if(ca===0){bY.resolve(cb)}return null},function(ch){bY.reject(ch);return null})};for(var cd=0;cd<bZ;cd++){cc(e[cd],cd)}return bY.get_promise()},then:function(e,bY){return this.$5(e,bY)},resolve:function(e){return this.$4(e)},reject:function(e){return this.$4(i.$3(e))},$0:function(e,bY){var bZ=new w;this.$2.push(function(ca){ca.then(e,bY).then(ss.mkdel(bZ,bZ.resolve),ss.mkdel(bZ,bZ.reject))});return bZ.get_promise()},$1:function(e){var bY=i.$0(e);this.$5=bY.then;this.$4=i.$0;for(var bZ=0;bZ<this.$2.length;bZ++){var ca=this.$2[bZ];ca(bY)}this.$2=null;return bY}});ss.initClass(x,a,{});ss.initClass(y,a,{});ss.initClass(z,a,{always:function(e){return this.then(e,e)},otherwise:function(e){return this.then(null,e)}});ss.initClass(A,a,{intersect:function(e){var bY=Math.max(this.left,e.left);var bZ=Math.max(this.top,e.top);var ca=Math.min(this.left+this.width,e.left+e.width);var cb=Math.min(this.top+this.height,e.top+e.height);if(ca<=bY||cb<=bZ){return new A(0,0,0,0)}return new A(bY,bZ,ca-bY,cb-bZ)}});ss.initClass(C,a,{},Object);ss.initClass(D,a,{add_activeStoryPointChange:function(e){this.$2$1=ss.delegateCombine(this.$2$1,e)},remove_activeStoryPointChange:function(e){this.$2$1=ss.delegateRemove(this.$2$1,e)},get_activeStoryPointImpl:function(){return this.$g},get_sheet:function(){return this.get_story()},get_story:function(){if(ss.isNullOrUndefined(this.$i)){this.$i=new bQ(this)}return this.$i},get_storyPointsInfo:function(){return this.$j},update:function(e){var bY=null;var bZ=null;this.$j=this.$j||new Array(e.storyPoints.length);for(var ca=0;ca<e.storyPoints.length;ca++){var cb=e.storyPoints[ca];var cc=cb.caption;var cd=ca===e.activeStoryPointIndex;var ce=F.$ctor(cc,ca,cb.storyPointId,cd,cb.isUpdated,this);if(ss.isNullOrUndefined(this.$j[ca])){this.$j[ca]=new bS(ce)}else if(this.$j[ca]._impl.storyPointId===ce.storyPointId){var cf=this.$j[ca]._impl;cf.caption=ce.caption;cf.index=ce.index;cf.isActive=cd;cf.isUpdated=ce.isUpdated}else{this.$j[ca]=new bS(ce)}if(cd){bY=cb.containedSheetInfo;bZ=ce}}var cg=this.$j.length-e.storyPoints.length;this.$j.splice(e.storyPoints.length,cg);var ch=ss.isNullOrUndefined(this.$g)||this.$g.get_storyPointId()!==bZ.storyPointId;if(ss.isValue(this.$g)&&ch){this.$g.set_isActive(false)}var ci=this.$g;if(ch){var cj=E.createContainedSheet(bY,this.get_workbookImpl(),this.get_messagingOptions(),this.$h);this.$g=new E(bZ,cj)}else{this.$g.set_isActive(bZ.isActive);this.$g.set_isUpdated(bZ.isUpdated)}if(ch&&ss.isValue(ci)){this.$d(this.$j[ci.get_index()],this.$g.get_storyPoint())}},activatePreviousStoryPointAsync:function(){return this.$c('api.ActivatePreviousStoryPoint')},activateNextStoryPointAsync:function(){return this.$c('api.ActivateNextStoryPoint')},activateStoryPointAsync:function(e){var bY=new tab._Deferred;if(e<0||e>=this.$j.length){throw G.createIndexOutOfRange(e)}var bZ=this.get_activeStoryPointImpl();var ca={};ca['api.storyPointIndex']=e;var cb=new(ss.makeGenericType(bd,[Object]))('api.ActivateStoryPoint',0,ss.mkdel(this,function(cc){this.$e(bZ,cc);bY.resolve(this.$g.get_storyPoint())}),function(cc,cd){bY.reject(G.createServerError(cd))});this.sendCommand(Object).call(this,ca,cb);return bY.get_promise()},revertStoryPointAsync:function(e){e=e||this.$g.get_index();if(e<0||e>=this.$j.length){throw G.createIndexOutOfRange(e)}var bY=new tab._Deferred;var bZ={};bZ['api.storyPointIndex']=e;var ca=new(ss.makeGenericType(bd,[Object]))('api.RevertStoryPoint',0,ss.mkdel(this,function(cb){this.$f(e,cb);bY.resolve(this.$j[e])}),function(cb,cc){bY.reject(G.createServerError(cc))});this.sendCommand(Object).call(this,bZ,ca);return bY.get_promise()},$c:function(e){if(e!=='api.ActivatePreviousStoryPoint'&&e!=='api.ActivateNextStoryPoint'){throw G.createInternalError("commandName '"+e+"' is invalid.")}var bY=new tab._Deferred;var bZ=this.get_activeStoryPointImpl();var ca={};var cb=new(ss.makeGenericType(bd,[Object]))(e,0,ss.mkdel(this,function(cc){this.$e(bZ,cc);bY.resolve(this.$g.get_storyPoint())}),function(cc,cd){bY.reject(G.createServerError(cd))});this.sendCommand(Object).call(this,ca,cb);return bY.get_promise()},$f:function(e,bY){var bZ=this.$j[e]._impl;if(bZ.storyPointId!==bY.storyPointId){throw G.createInternalError("We should not be updating a story point where the IDs don't match. Existing storyPointID="+bZ.storyPointId+', newStoryPointID='+bY.storyPointId)}bZ.caption=bY.caption;bZ.isUpdated=bY.isUpdated;if(bY.storyPointId===this.$g.get_storyPointId()){this.$g.set_isUpdated(bY.isUpdated)}},$e:function(e,bY){var bZ=bY.index;if(e.get_index()===bZ){return}var ca=this.$j[e.get_index()];var cb=this.$j[bZ]._impl;var cc=E.createContainedSheet(bY.containedSheetInfo,this.get_workbookImpl(),this.get_messagingOptions(),this.$h);cb.isActive=true;this.$g=new E(cb,cc);e.set_isActive(false);ca._impl.isActive=false;this.$d(ca,this.$g.get_storyPoint())},$d:function(e,bY){if(!ss.staticEquals(this.$2$1,null)){this.$2$1(e,bY)}}},B);ss.initClass(E,a,{get_caption:function(){return this.$1},get_containedSheetImpl:function(){return this.$2},get_index:function(){return this.$3},get_isActive:function(){return this.$4},set_isActive:function(e){this.$4=e},get_isUpdated:function(){return this.$5},set_isUpdated:function(e){this.$5=e},get_parentStoryImpl:function(){return this.$6},get_storyPoint:function(){if(ss.isNullOrUndefined(this.$7)){this.$7=new bR(this)}return this.$7},get_storyPointId:function(){return this.$8},$0:function(){return F.$ctor(this.$1,this.$3,this.$8,this.$4,this.$5,this.$6)}});ss.initClass(F,a,{},Object);ss.initClass(G,a,{});ss.initClass(H,a,{});ss.initClass(I,a,{});ss.initClass(J,a,{get_url:function(){return this.$0()},get_baseUrl:function(){return this.$2},$0:function(){var e=[];e.push(this.get_baseUrl());e.push('?');if(this.userSuppliedParameters.length>0){e.push(this.userSuppliedParameters);e.push('&')}e.push(':embed=y');e.push('&:showVizHome=n');if(!this.fixedSize){e.push('&:bootstrapWhenNotified=y')}if(!this.tabs){e.push('&:tabs=n')}if(!this.toolbar){e.push('&:toolbar=n')}else if(!ss.isNullOrUndefined(this.toolBarPosition)){e.push('&:toolbar=');e.push(this.toolBarPosition.toString())}var bY=this.$1;var bZ=new ss.ObjectEnumerator(bY);try{while(bZ.moveNext()){var ca=bZ.current();if(ca.key!=='embed'&&ca.key!=='height'&&ca.key!=='width'&&ca.key!=='autoSize'&&ca.key!=='hideTabs'&&ca.key!=='hideToolbar'&&ca.key!=='onFirstInteractive'&&ca.key!=='onFirstVizSizeKnown'&&ca.key!=='toolbarPosition'&&ca.key!=='instanceIdToClone'){e.push('&');e.push(encodeURIComponent(ca.key));e.push('=');e.push(encodeURIComponent(ca.value.toString()))}}}finally{bZ.dispose()}e.push('&:apiID='+this.handlerId);if(ss.isValue(this.$1.instanceIdToClone)){e.push('#'+this.$1.instanceIdToClone)}return e.join('')}});ss.initClass(K,a,{get_workbook:function(){if(ss.isNullOrUndefined(this.$E)){this.$E=new bW(this)}return this.$E},get_viz:function(){return this.$D.$12()},get_publishedSheets:function(){return this.$A},get_name:function(){return this.$y},get_activeSheetImpl:function(){return this.$s},get_activeCustomView:function(){return this.$t},get_isDownloadAllowed:function(){return this.$v},$4:function(e){if(ss.isNullOrUndefined(this.$s)){return null}var bY=K.$2(e);if(ss.isNullOrUndefined(bY)){return null}if(ss.referenceEquals(bY,this.$s.get_name())){return this.$s}if(this.$s.get_isDashboard()){var bZ=this.$s;var ca=bZ.get_worksheets()._get(bY);if(ss.isValue(ca)){return ca._impl}}return null},_setActiveSheetAsync:function(e){if(H.isNumber(e)){var bY=e;if(bY<this.$A.get__length()&&bY>=0){return this.$1(this.$A.get_item(bY).$0)}else{throw G.createIndexOutOfRange(bY)}}var bZ=K.$2(e);var ca=this.$A._get(bZ);if(ss.isValue(ca)){return this.$1(ca.$0)}else if(this.$s.get_isDashboard()){var cb=this.$s;var cc=cb.get_worksheets()._get(bZ);if(ss.isValue(cc)){this.$r=null;var cd='';if(cc.getIsHidden()){this.$r=cc._impl}else{cd=cc._impl.get_url()}return this.$0(cc._impl.get_name(),cd)}}throw G.create('sheetNotInWorkbook','Sheet is not found in Workbook')},_revertAllAsync:function(){var e=new tab._Deferred;var bY=new(ss.makeGenericType(bd,[Object]))('api.RevertAllCommand',1,function(bZ){e.resolve()},function(bZ,ca){e.reject(G.createServerError(ca))});this.$d(Object).call(this,null,bY);return e.get_promise()},_update:function(e){this.$5(e)},$1:function(e){return this.$0(e.name,e.url)},$0:function(e,bY){var bZ=new tab._Deferred;if(ss.isValue(this.$s)&&ss.referenceEquals(e,this.$s.get_name())){bZ.resolve(this.$s.get_sheet());return bZ.get_promise()}var ca={};ca['api.switchToSheetName']=e;ca['api.switchToRepositoryUrl']=bY;ca['api.oldRepositoryUrl']=this.$s.get_url();var cb=new(ss.makeGenericType(bd,[Object]))('api.SwitchActiveSheetCommand',0,ss.mkdel(this,function(cc){this.$D.$15=ss.mkdel(this,function(){this.$D.$15=null;bZ.resolve(this.$s.get_sheet())})}),function(cc,cd){bZ.reject(G.createServerError(cd))});this.$d(Object).call(this,ca,cb);return bZ.get_promise()},_updateActiveSheetAsync:function(){var e=new tab._Deferred;var bY={};bY['api.switchToSheetName']=this.$s.get_name();bY['api.switchToRepositoryUrl']=this.$s.get_url();bY['api.oldRepositoryUrl']=this.$s.get_url();var bZ=new(ss.makeGenericType(bd,[Object]))('api.UpdateActiveSheetCommand',0,ss.mkdel(this,function(ca){e.resolve(this.$s.get_sheet())}),function(ca,cb){e.reject(G.createServerError(cb))});this.$d(Object).call(this,bY,bZ);return e.get_promise()},$d:function(e){return function(bY,bZ){this.$x.sendCommand(e).call(this.$x,bY,bZ)}},$5:function(e){var bY=new(ss.makeGenericType(bd,[Object]))('api.GetClientInfoCommand',0,ss.mkdel(this,function(bZ){this.$a(bZ);if(ss.isValue(e)){e()}}),null);this.$d(Object).call(this,null,bY)},$a:function(e){this.$y=e.workbookName;this.$v=e.isDownloadAllowed;this.$D.$K(!e.isAutoUpdate);this.$D.set_instanceId(e.instanceId);this.$3(e);this.$9(e)},$9:function(e){var bY=e.currentSheetName;var bZ=this.$A._get(bY);if(ss.isNullOrUndefined(bZ)&&ss.isNullOrUndefined(this.$r)){throw G.createInternalError('The active sheet was not specified in baseSheets')}if(ss.isValue(this.$s)&&ss.referenceEquals(this.$s.get_name(),bY)){return}if(ss.isValue(this.$s)){this.$s.set_isActive(false);var ca=this.$A._get(this.$s.get_name());if(ss.isValue(ca)){ca.$0.isActive=false}if(this.$s.get_sheetType()==='story'){var cb=this.$s;cb.remove_activeStoryPointChange(ss.mkdel(this.$D,this.$D.raiseStoryPointSwitch))}}if(ss.isValue(this.$r)){var cc=C.$ctor(this.$r.get_name(),'worksheet',-1,this.$r.get_size(),this.get_workbook(),'',true,true,4294967295);this.$r=null;this.$s=new L(cc,this,this.$x,null)}else{var cd=null;for(var ce=0,cf=e.publishedSheets.length;ce<cf;ce++){if(ss.referenceEquals(e.publishedSheets[ce].name,bY)){cd=e.publishedSheets[ce];break}}if(ss.isNullOrUndefined(cd)){throw G.createInternalError('No base sheet was found corresponding to the active sheet.')}var cg=ss.mkdel(this,function(ck){return this.$A._get(ck)});if(cd.sheetType==='dashboard'){var ch=new u(bZ.$0,this,this.$x);this.$s=ch;var ci=K.$0(e.dashboardZones);ch.$c(ci,cg)}else if(cd.sheetType==='story'){var cj=new D(bZ.$0,this,this.$x,e.story,cg);this.$s=cj;cj.add_activeStoryPointChange(ss.mkdel(this.$D,this.$D.raiseStoryPointSwitch))}else{this.$s=new L(bZ.$0,this,this.$x,null)}bZ.$0.isActive=true}this.$s.set_isActive(true)},$3:function(e){var bY=e.publishedSheets;if(ss.isNullOrUndefined(bY)){return}for(var bZ=0;bZ<bY.length;bZ++){var ca=bY[bZ];var cb=ca.name;var cc=this.$A._get(cb);var cd=K.$1(ca);if(ss.isNullOrUndefined(cc)){var ce=ss.referenceEquals(cb,e.currentSheetName);var cf=O.convertSheetType(ca.sheetType);var cg=C.$ctor(cb,cf,bZ,cd,this.get_workbook(),ca.repositoryUrl,ce,false,4294967295);cc=new bP(cg);this.$A._add(cb,cc)}else{cc.$0.size=cd}}},$i:function(){return this.$u},$j:function(e){this.$u=e},$p:function(){return this.$C},$q:function(e){this.$C=e},$n:function(){return this.$B},$o:function(e){this.$B=e},$g:function(){return this.$t},$h:function(e){this.$t=e},$6:function(){return t._getCustomViewsAsync(this,this.$x)},$f:function(e){if(ss.isNullOrUndefined(e)||H.isNullOrEmpty(e)){return t._showCustomViewAsync(this,this.$x,null)}else{var bY=this.$u._get(e);if(ss.isNullOrUndefined(bY)){var bZ=new tab._Deferred;bZ.reject(G.createInvalidCustomViewName(e));return bZ.get_promise()}return bY._impl._showAsync()}},$c:function(e){if(H.isNullOrEmpty(e)){throw G.createNullOrEmptyParameter('customViewName')}var bY=this.$u._get(e);if(ss.isNullOrUndefined(bY)){var bZ=new tab._Deferred;bZ.reject(G.createInvalidCustomViewName(e));return bZ.get_promise()}return bY._impl.$1()},$b:function(e){if(H.isNullOrEmpty(e)){throw G.createInvalidParameter('customViewName')}return t._saveNewAsync(this,this.$x,e)},$e:function(){return t._makeCurrentCustomViewDefaultAsync(this,this.$x)},$k:function(){return this.$w},$l:function(e){this.$w=e},$m:function(){return this.$z},$8:function(e){var bY=new tab._Deferred;if(ss.isValue(this.$w)){bY.resolve(this.$w.$8());return bY.get_promise()}var bZ={};var ca=new(ss.makeGenericType(bd,[Object]))('api.FetchParametersCommand',0,ss.mkdel(this,function(cb){var cc=K.$3(e,cb);this.$w=cc;bY.resolve(cc.$8())}),function(cb,cc){bY.reject(G.createServerError(cc))});this.$d(Object).call(this,bZ,ca);return bY.get_promise()},$7:function(){var e=new tab._Deferred;var bY={};var bZ=new(ss.makeGenericType(bd,[Object]))('api.FetchParametersCommand',0,ss.mkdel(this,function(ca){this.$z=K.$4(ca);e.resolve(this.$m()._toApiCollection())}),function(ca,cb){e.reject(G.createServerError(cb))});this.$d(Object).call(this,bY,bZ);return e.get_promise()},$2:function(e,bY){var bZ=new tab._Deferred;var ca=null;if(ss.isValue(this.$z)){if(ss.isNullOrUndefined(this.$z._get(e))){bZ.reject(G.createInvalidParameter(e));return bZ.get_promise()}ca=this.$z._get(e)._impl;if(ss.isNullOrUndefined(ca)){bZ.reject(G.createInvalidParameter(e));return bZ.get_promise()}}var cb={};cb['api.setParameterName']=(ss.isValue(this.$z)?ca.$7():e);if(ss.isValue(bY)&&H.isDate(bY)){var cc=bY;var cd=H.serializeDateForServer(cc);cb['api.setParameterValue']=cd}else{cb['api.setParameterValue']=(ss.isValue(bY)?bY.toString():null)}this.$w=null;var ce=new(ss.makeGenericType(bd,[Object]))('api.SetParameterValueCommand',0,ss.mkdel(this,function(cf){if(ss.isNullOrUndefined(cf)){bZ.reject(G.create('serverError','server error'));return}if(!cf.isValidPresModel){bZ.reject(G.createInvalidParameter(e));return}var cg=new k(cf);this.$w=cg;bZ.resolve(cg.$8())}),function(cf,cg){bZ.reject(G.createInvalidParameter(e))});this.$d(Object).call(this,cb,ce);return bZ.get_promise()}});ss.initClass(L,a,{get_sheet:function(){return this.get_worksheet()},get_worksheet:function(){if(ss.isNullOrUndefined(this.$E)){this.$E=new bX(this)}return this.$E},get_parentDashboardImpl:function(){return this.$C},get_parentDashboard:function(){if(ss.isValue(this.$C)){return this.$C.get_dashboard()}return null},$q:function(){this.$A();var e=new tab._Deferred;var bY={};bY['api.worksheetName']=this.get_name();var bZ=new(ss.makeGenericType(bd,[Object]))('api.GetDataSourcesCommand',0,function(ca){var cb=v.processDataSourcesForWorksheet(ca);e.resolve(cb._toApiCollection())},function(ca,cb){e.reject(G.createServerError(cb))});this.sendCommand(Object).call(this,bY,bZ);return e.get_promise()},$p:function(e){this.$A();var bY=new tab._Deferred;var bZ={};bZ['api.dataSourceName']=e;bZ['api.worksheetName']=this.get_name();var ca=new(ss.makeGenericType(bd,[Object]))('api.GetDataSourceCommand',0,function(cb){var cc=v.processDataSource(cb);if(ss.isValue(cc)){bY.resolve(cc.get_dataSource())}else{bY.reject(G.createServerError("Data source '"+e+"' not found"))}},function(cb,cc){bY.reject(G.createServerError(cc))});this.sendCommand(Object).call(this,bZ,ca);return bY.get_promise()},$A:function(){var e=this.get_isActive();var bY=ss.isValue(this.$C)&&this.$C.get_isActive();var bZ=ss.isValue(this.get_parentStoryPointImpl())&&this.get_parentStoryPointImpl().get_parentStoryImpl().get_isActive();if(!e&&!bY&&!bZ){throw G.createNotActiveSheet()}},$d:function(e){if(ss.isValue(this.get_parentStoryPointImpl())){var bY={};bY.AVP=this.get_name();bY.XwZ=(ss.isValue(this.get_parentDashboardImpl())?this.$C.get_name():this.get_name());bY.WIZ=this.get_parentStoryPointImpl().get_containedSheetImpl().get_zoneId();bY.Hna=this.get_parentStoryPointImpl().get_parentStoryImpl().get_name();bY.hVl=this.get_parentStoryPointImpl().get_storyPointId();e['api.visualId']=bY}else{e['api.worksheetName']=this.get_name();if(ss.isValue(this.get_parentDashboardImpl())){e['api.dashboardName']=this.get_parentDashboardImpl().get_name()}}},get__filters:function(){return this.$B},set__filters:function(e){this.$B=e},$r:function(e,bY,bZ){if(!H.isNullOrEmpty(e)&&!H.isNullOrEmpty(bY)){throw G.createInternalError('Only fieldName OR fieldCaption is allowed, not both.')}bZ=bZ||new Object;var ca=new tab._Deferred;var cb={};this.$d(cb);if(!H.isNullOrEmpty(bY)&&H.isNullOrEmpty(e)){cb['api.fieldCaption']=bY}if(!H.isNullOrEmpty(e)){cb['api.fieldName']=e}cb['api.filterHierarchicalLevels']=0;cb['api.ignoreDomain']=bZ.ignoreDomain||false;var cc=new(ss.makeGenericType(bd,[Object]))('api.GetOneFilterInfoCommand',0,ss.mkdel(this,function(cd){var ce=L.$2(cd);if(ss.isNullOrUndefined(ce)){var cf=cd;var cg=bH.$0(this,cf);ca.resolve(cg)}else{ca.reject(ce)}}),function(cd,ce){ca.reject(G.createServerError(ce))});this.sendCommand(Object).call(this,cb,cc);return ca.get_promise()},$s:function(e){this.$A();e=e||new Object;var bY=new tab._Deferred;var bZ={};this.$d(bZ);bZ['api.ignoreDomain']=e.ignoreDomain||false;var ca=new(ss.makeGenericType(bd,[Object]))('api.GetFiltersListCommand',0,ss.mkdel(this,function(cb){this.set__filters(bH.$1(this,cb));bY.resolve(this.get__filters()._toApiCollection())}),function(cb,cc){bY.reject(G.createServerError(cc))});this.sendCommand(Object).call(this,bZ,ca);return bY.get_promise()},$e:function(e,bY,bZ,ca){return this.$f(e,bY,bZ,ca)},$m:function(e){return this.$n(e)},$i:function(e,bY){var bZ=L.$3(bY);return this.$j(e,bZ)},$k:function(e,bY){var bZ=L.$4(bY);return this.$l(e,bZ)},$g:function(e,bY,bZ,ca){if(ss.isNullOrUndefined(bY)&&bZ!=='all'){throw G.createInvalidParameter('values')}return this.$h(e,bY,bZ,ca)},$n:function(e){this.$A();if(H.isNullOrEmpty(e)){throw G.createNullOrEmptyParameter('fieldName')}var bY=new tab._Deferred;var bZ={};bZ['api.fieldCaption']=e;this.$d(bZ);var ca=L.$0('api.ClearFilterCommand',e,bY);this.sendCommand(Object).call(this,bZ,ca);return bY.get_promise()},$f:function(e,bY,bZ,ca){this.$A();if(H.isNullOrEmpty(e)){throw G.createNullOrEmptyParameter('fieldName')}bZ=l.$1(T).call(null,bZ,'updateType');var cb=[];if(x.isArray(bY)){for(var cc=0;cc<bY.length;cc++){cb.push(bY[cc].toString())}}else if(ss.isValue(bY)){cb.push(bY.toString())}var cd=new tab._Deferred;var ce={};ce['api.fieldCaption']=e;ce['api.filterUpdateType']=bZ;ce['api.exclude']=((ss.isValue(ca)&&ca.isExcludeMode)?true:false);if(bZ!=='all'){ce['api.filterCategoricalValues']=cb}this.$d(ce);var cf=L.$0('api.ApplyCategoricalFilterCommand',e,cd);this.sendCommand(Object).call(this,ce,cf);return cd.get_promise()},$j:function(e,bY){this.$A();if(H.isNullOrEmpty(e)){throw G.createNullOrEmptyParameter('fieldName')}if(ss.isNullOrUndefined(bY)){throw G.createNullOrEmptyParameter('filterOptions')}var bZ={};bZ['api.fieldCaption']=e;if(ss.isValue(bY.min)){if(H.isDate(bY.min)){var ca=bY.min;if(H.isDateValid(ca)){bZ['api.filterRangeMin']=H.serializeDateForServer(ca)}else{throw G.createInvalidDateParameter('filterOptions.min')}}else{bZ['api.filterRangeMin']=bY.min}}if(ss.isValue(bY.max)){if(H.isDate(bY.max)){var cb=bY.max;if(H.isDateValid(cb)){bZ['api.filterRangeMax']=H.serializeDateForServer(cb)}else{throw G.createInvalidDateParameter('filterOptions.max')}}else{bZ['api.filterRangeMax']=bY.max}}if(ss.isValue(bY.nullOption)){bZ['api.filterRangeNullOption']=bY.nullOption}this.$d(bZ);var cc=new tab._Deferred;var cd=L.$0('api.ApplyRangeFilterCommand',e,cc);this.sendCommand(Object).call(this,bZ,cd);return cc.get_promise()},$l:function(e,bY){this.$A();if(H.isNullOrEmpty(e)){throw G.createInvalidParameter('fieldName')}else if(ss.isNullOrUndefined(bY)){throw G.createInvalidParameter('filterOptions')}var bZ={};bZ['api.fieldCaption']=e;if(ss.isValue(bY)){bZ['api.filterPeriodType']=bY.periodType;bZ['api.filterDateRangeType']=bY.rangeType;if(bY.rangeType==='lastn'||bY.rangeType==='nextn'){if(ss.isNullOrUndefined(bY.rangeN)){throw G.create('missingRangeNForRelativeDateFilters','Missing rangeN field for a relative date filter of LASTN or NEXTN.')}bZ['api.filterDateRange']=bY.rangeN}if(ss.isValue(bY.anchorDate)){bZ['api.filterDateArchorValue']=H.serializeDateForServer(bY.anchorDate)}}this.$d(bZ);var ca=new tab._Deferred;var cb=L.$0('api.ApplyRelativeDateFilterCommand',e,ca);this.sendCommand(Object).call(this,bZ,cb);return ca.get_promise()},$h:function(e,bY,bZ,ca){this.$A();if(H.isNullOrEmpty(e)){throw G.createNullOrEmptyParameter('fieldName')}bZ=l.$1(T).call(null,bZ,'updateType');var cb=null;var cc=null;if(x.isArray(bY)){cb=[];var cd=bY;for(var ce=0;ce<cd.length;ce++){cb.push(cd[ce].toString())}}else if(H.isString(bY)){cb=[];cb.push(bY.toString())}else if(ss.isValue(bY)&&ss.isValue(bY['levels'])){var cf=bY['levels'];cc=[];if(x.isArray(cf)){var cg=cf;for(var ch=0;ch<cg.length;ch++){cc.push(cg[ch].toString())}}else{cc.push(cf.toString())}}else if(ss.isValue(bY)){throw G.createInvalidParameter('values')}var ci={};ci['api.fieldCaption']=e;ci['api.filterUpdateType']=bZ;ci['api.exclude']=((ss.isValue(ca)&&ca.isExcludeMode)?true:false);if(ss.isValue(cb)){ci['api.filterHierarchicalValues']=bm.toJson(cb,false,'')}if(ss.isValue(cc)){ci['api.filterHierarchicalLevels']=bm.toJson(cc,false,'')}this.$d(ci);var cj=new tab._Deferred;var ck=L.$0('api.ApplyHierarchicalFilterCommand',e,cj);this.sendCommand(Object).call(this,ci,ck);return cj.get_promise()},get_selectedMarks:function(){return this.$D},set_selectedMarks:function(e){this.$D=e},$o:function(){this.$A();var e=new tab._Deferred;var bY={};this.$d(bY);bY['api.filterUpdateType']='replace';var bZ=new(ss.makeGenericType(bd,[Object]))('api.SelectMarksCommand',1,function(ca){e.resolve()},function(ca,cb){e.reject(G.createServerError(cb))});this.sendCommand(Object).call(this,bY,bZ);return e.get_promise()},$v:function(e,bY,bZ){this.$A();if(ss.isNullOrUndefined(e)&&ss.isNullOrUndefined(bY)){return this.$o()}if(H.isString(e)&&(x.isArray(bY)||H.isString(bY)||!l.$0(Y).call(null,bY))){return this.$w(e,bY,bZ)}else if(x.isArray(e)){return this.$x(e,bY)}else{return this.$y(e,bY)}},$t:function(){this.$A();var e=new tab._Deferred;var bY={};this.$d(bY);var bZ=new(ss.makeGenericType(bd,[Object]))('api.FetchSelectedMarksCommand',0,ss.mkdel(this,function(ca){this.$D=j.$0(ca);e.resolve(this.$D._toApiCollection())}),function(ca,cb){e.reject(G.createServerError(cb))});this.sendCommand(Object).call(this,bY,bZ);return e.get_promise()},$w:function(e,bY,bZ){var ca=[];var cb=[];var cc=[];var cd=[];var ce=[];var cf=[];this.$u(ca,cb,cc,cd,ce,cf,e,bY);return this.$z(null,ca,cb,cc,cd,ce,cf,bZ)},$y:function(e,bY){var bZ=e;var ca=[];var cb=[];var cc=[];var cd=[];var ce=[];var cf=[];var cg=new ss.ObjectEnumerator(bZ);try{while(cg.moveNext()){var ch=cg.current();if(e.hasOwnProperty(ch.key)){if(!x.isFunction(bZ[ch.key])){this.$u(ca,cb,cc,cd,ce,cf,ch.key,ch.value)}}}}finally{cg.dispose()}return this.$z(null,ca,cb,cc,cd,ce,cf,bY)},$x:function(e,bY){var bZ=[];var ca=[];var cb=[];var cc=[];var cd=[];var ce=[];var cf=[];for(var cg=0;cg<e.length;cg++){var ch=e[cg];if(ss.isValue(ch.$0.$3())&&ch.$0.$3()>0){cf.push(ch.$0.$3())}else{var ci=ch.$0.$2();for(var cj=0;cj<ci.get__length();cj++){var ck=ci.get_item(cj);if(ck.hasOwnProperty('fieldName')&&ck.hasOwnProperty('value')&&!x.isFunction(ck.fieldName)&&!x.isFunction(ck.value)){this.$u(bZ,ca,cb,cc,cd,ce,ck.fieldName,ck.value)}}}}return this.$z(cf,bZ,ca,cb,cc,cd,ce,bY)},$u:function(e,bY,bZ,ca,cb,cc,cd,ce){var cf=ce;if(L.$5.test(cd)){this.$c(bZ,ca,cd,ce)}else if(ss.isValue(cf.min)||ss.isValue(cf.max)){var cg=new Object;if(ss.isValue(cf.min)){if(H.isDate(cf.min)){var ch=cf.min;if(H.isDateValid(ch)){cg.min=H.serializeDateForServer(ch)}else{throw G.createInvalidDateParameter('options.min')}}else{cg.min=cf.min}}if(ss.isValue(cf.max)){if(H.isDate(cf.max)){var ci=cf.max;if(H.isDateValid(ci)){cg.max=H.serializeDateForServer(ci)}else{throw G.createInvalidDateParameter('options.max')}}else{cg.max=cf.max}}if(ss.isValue(cf.nullOption)){var cj=l.$1(U).call(null,cf.nullOption,'options.nullOption');cg.nullOption=cj}else{cg.nullOption='allValues'}var ck=bm.toJson(cg,false,'');this.$c(cb,cc,cd,ck)}else{this.$c(e,bY,cd,ce)}},$c:function(e,bY,bZ,ca){var cb=[];if(x.isArray(ca)){var cc=ca;for(var cd=0;cd<cc.length;cd++){cb.push(cc[cd].toString())}}else{cb.push(ca.toString())}bY.push(cb);e.push(bZ)},$z:function(e,bY,bZ,ca,cb,cc,cd,ce){var cf={};this.$d(cf);ce=l.$1(Y).call(null,ce,'updateType');cf['api.filterUpdateType']=ce;if(!H.isNullOrEmpty(e)){cf['api.tupleIds']=bm.toJson(e,false,'')}if(!H.isNullOrEmpty(bY)&&!H.isNullOrEmpty(bZ)){cf['api.categoricalFieldCaption']=bm.toJson(bY,false,'');var cg=[];for(var ch=0;ch<bZ.length;ch++){var ci=bm.toJson(bZ[ch],false,'');cg.push(ci)}cf['api.categoricalMarkValues']=bm.toJson(cg,false,'')}if(!H.isNullOrEmpty(ca)&&!H.isNullOrEmpty(cb)){cf['api.hierarchicalFieldCaption']=bm.toJson(ca,false,'');var cj=[];for(var ck=0;ck<cb.length;ck++){var cl=bm.toJson(cb[ck],false,'');cj.push(cl)}cf['api.hierarchicalMarkValues']=bm.toJson(cj,false,'')}if(!H.isNullOrEmpty(cc)&&!H.isNullOrEmpty(cd)){cf['api.rangeFieldCaption']=bm.toJson(cc,false,'');var cm=[];for(var cn=0;cn<cd.length;cn++){var co=bm.toJson(cd[cn],false,'');cm.push(co)}cf['api.rangeMarkValues']=bm.toJson(cm,false,'')}if(H.isNullOrEmpty(cf['api.tupleIds'])&&H.isNullOrEmpty(cf['api.categoricalFieldCaption'])&&H.isNullOrEmpty(cf['api.hierarchicalFieldCaption'])&&H.isNullOrEmpty(cf['api.rangeFieldCaption'])){throw G.createInvalidParameter('fieldNameOrFieldValuesMap')}var cp=new tab._Deferred;var cq=new(ss.makeGenericType(bd,[Object]))('api.SelectMarksCommand',1,function(cr){var cs=L.$1(cr);if(ss.isNullOrUndefined(cs)){cp.resolve()}else{cp.reject(cs)}},function(cr,cs){cp.reject(G.createServerError(cs))});this.sendCommand(Object).call(this,cf,cq);return cp.get_promise()}},B);ss.initEnum(M,a,{blank:'blank',worksheet:'worksheet',quickFilter:'quickFilter',parameterControl:'parameterControl',pageFilter:'pageFilter',legend:'legend',title:'title',text:'text',image:'image',webPage:'webPage'},true);ss.initEnum(N,a,{last:'last',lastn:'lastn',next:'next',nextn:'nextn',curr:'curr',todate:'todate'},true);ss.initClass(O,a,{});ss.initEnum(P,a,{internalError:'internalError',serverError:'serverError',invalidAggregationFieldName:'invalidAggregationFieldName',invalidParameter:'invalidParameter',invalidUrl:'invalidUrl',staleDataReference:'staleDataReference',vizAlreadyInManager:'vizAlreadyInManager',noUrlOrParentElementNotFound:'noUrlOrParentElementNotFound',invalidFilterFieldName:'invalidFilterFieldName',invalidFilterFieldValue:'invalidFilterFieldValue',invalidFilterFieldNameOrValue:'invalidFilterFieldNameOrValue',filterCannotBePerformed:'filterCannotBePerformed',notActiveSheet:'notActiveSheet',invalidCustomViewName:'invalidCustomViewName',missingRangeNForRelativeDateFilters:'missingRangeNForRelativeDateFilters',missingMaxSize:'missingMaxSize',missingMinSize:'missingMinSize',missingMinMaxSize:'missingMinMaxSize',invalidSize:'invalidSize',invalidSizeBehaviorOnWorksheet:'invalidSizeBehaviorOnWorksheet',sheetNotInWorkbook:'sheetNotInWorkbook',indexOutOfRange:'indexOutOfRange',downloadWorkbookNotAllowed:'downloadWorkbookNotAllowed',nullOrEmptyParameter:'nullOrEmptyParameter',browserNotCapable:'browserNotCapable',unsupportedEventName:'unsupportedEventName',invalidDateParameter:'invalidDateParameter',invalidSelectionFieldName:'invalidSelectionFieldName',invalidSelectionValue:'invalidSelectionValue',invalidSelectionDate:'invalidSelectionDate',noUrlForHiddenWorksheet:'noUrlForHiddenWorksheet',maxVizResizeAttempts:'maxVizResizeAttempts'},true);ss.initEnum(Q,a,{SUM:'SUM',AVG:'AVG',MIN:'MIN',MAX:'MAX',STDEV:'STDEV',STDEVP:'STDEVP',VAR:'VAR',VARP:'VARP',COUNT:'COUNT',COUNTD:'COUNTD',MEDIAN:'MEDIAN',ATTR:'ATTR',NONE:'NONE',PERCENTILE:'PERCENTILE',YEAR:'YEAR',QTR:'QTR',MONTH:'MONTH',DAY:'DAY',HOUR:'HOUR',MINUTE:'MINUTE',SECOND:'SECOND',WEEK:'WEEK',WEEKDAY:'WEEKDAY',MONTHYEAR:'MONTHYEAR',MDY:'MDY',END:'END',TRUNC_YEAR:'TRUNC_YEAR',TRUNC_QTR:'TRUNC_QTR',TRUNC_MONTH:'TRUNC_MONTH',TRUNC_WEEK:'TRUNC_WEEK',TRUNC_DAY:'TRUNC_DAY',TRUNC_HOUR:'TRUNC_HOUR',TRUNC_MINUTE:'TRUNC_MINUTE',TRUNC_SECOND:'TRUNC_SECOND',QUART1:'QUART1',QUART3:'QUART3',SKEWNESS:'SKEWNESS',KURTOSIS:'KURTOSIS',INOUT:'INOUT',SUM_XSQR:'SUM_XSQR',USER:'USER'},true);ss.initEnum(R,a,{dimension:'dimension',measure:'measure',unknown:'unknown'},true);ss.initEnum(S,a,{categorical:'categorical',quantitative:'quantitative',hierarchical:'hierarchical',relativedate:'relativedate'},true);ss.initEnum(T,a,{all:'all',replace:'replace',add:'add',remove:'remove'},true);ss.initEnum(U,a,{nullValues:'nullValues',nonNullValues:'nonNullValues',allValues:'allValues'},true);ss.initEnum(V,a,{all:'all',list:'list',range:'range'},true);ss.initEnum(W,a,{float:'float',integer:'integer',string:'string',boolean:'boolean',date:'date',datetime:'datetime'},true);ss.initEnum(X,a,{year:'year',quarter:'quarter',month:'month',week:'week',day:'day',hour:'hour',minute:'minute',second:'second'},true);ss.initEnum(Y,a,{replace:'replace',add:'add',remove:'remove'},true);ss.initEnum(Z,a,{automatic:'automatic',exactly:'exactly',range:'range',atleast:'atleast',atmost:'atmost'},true);ss.initEnum(ba,a,{worksheet:'worksheet',dashboard:'dashboard',story:'story'},true);ss.initEnum(bb,a,{customviewload:'customviewload',customviewremove:'customviewremove',customviewsave:'customviewsave',customviewsetdefault:'customviewsetdefault',filterchange:'filterchange',firstinteractive:'firstinteractive',firstvizsizeknown:'firstvizsizeknown',marksselection:'marksselection',parametervaluechange:'parametervaluechange',storypointswitch:'storypointswitch',tabswitch:'tabswitch',vizresize:'vizresize'},true);ss.initEnum(bc,a,{top:'top',bottom:'bottom'},true);ss.initClass(be,a,{get_router:function(){return this.$1},get_handler:function(){return this.$0},sendCommand:function(e){return function(bY,bZ){this.$1.sendCommand(e).call(this.$1,this.$0,bY,bZ)}}});ss.initClass(bv,a,{getViz:function(){return this.$1},getEventName:function(){return this.$0}});ss.initClass(bf,a,{getCustomViewAsync:function(){var e=new tab._Deferred;var bY=null;if(ss.isValue(this.$2.get__customViewImpl())){bY=this.$2.get__customViewImpl().$5()}e.resolve(bY);return e.get_promise()}},bv);ss.initClass(bg,a,{},Object);ss.initClass(bA,a,{getWorksheet:function(){return this.$2.get_worksheet()}},bv);ss.initClass(bi,a,{getFieldName:function(){return this.$4},getFilterAsync:function(){return this.$3.get__worksheetImpl().$r(this.$3.get__filterFieldName(),null,null)}},bA);ss.initClass(bj,a,{getVizSize:function(){return this.$2}},bv);ss.initClass(bm,a,{});ss.initClass(bn,a,{getMarksAsync:function(){var e=this.$3.get__worksheetImpl();if(ss.isValue(e.get_selectedMarks())){var bY=new tab._Deferred;return bY.resolve(e.get_selectedMarks()._toApiCollection())}return e.$t()}},bA);ss.initClass(bo,a,{getParameterName:function(){return this.$2.get__parameterName()},getParameterAsync:function(){return this.$2.get__workbookImpl().$8(this.$2.get__parameterName())}},bv);ss.initClass(bp,a,{},Object);ss.initClass(bq,a,{},Object);ss.initClass(br,a,{});ss.initClass(bs,a,{},Object);ss.initClass(bt,a,{});ss.initClass(bu,a,{getOldStoryPointInfo:function(){return this.$3},getNewStoryPoint:function(){return this.$2}},bv);ss.initClass(bw,a,{getOldSheetName:function(){return this.$3},getNewSheetName:function(){return this.$2}},bv);ss.initClass(bx,a,{add_customViewsListLoad:function(e){this.$1$1=ss.delegateCombine(this.$1$1,e)},remove_customViewsListLoad:function(e){this.$1$1=ss.delegateRemove(this.$1$1,e)},add_stateReadyForQuery:function(e){this.$1$2=ss.delegateCombine(this.$1$2,e)},remove_stateReadyForQuery:function(e){this.$1$2=ss.delegateRemove(this.$1$2,e)},$1w:function(e){this.$1$3=ss.delegateCombine(this.$1$3,e)},$1x:function(e){this.$1$3=ss.delegateRemove(this.$1$3,e)},$1u:function(e){this.$1$4=ss.delegateCombine(this.$1$4,e)},$1v:function(e){this.$1$4=ss.delegateRemove(this.$1$4,e)},$1y:function(e){this.$1$5=ss.delegateCombine(this.$1$5,e)},$1z:function(e){this.$1$5=ss.delegateRemove(this.$1$5,e)},$1m:function(e){this.$1$6=ss.delegateCombine(this.$1$6,e)},$1n:function(e){this.$1$6=ss.delegateRemove(this.$1$6,e)},$1q:function(e){this.$1$7=ss.delegateCombine(this.$1$7,e)},$1r:function(e){this.$1$7=ss.delegateRemove(this.$1$7,e)},$1o:function(e){this.$1$8=ss.delegateCombine(this.$1$8,e)},$1p:function(e){this.$1$8=ss.delegateRemove(this.$1$8,e)},$1s:function(e){this.$1$9=ss.delegateCombine(this.$1$9,e)},$1t:function(e){this.$1$9=ss.delegateRemove(this.$1$9,e)},$1C:function(e){this.$1$10=ss.delegateCombine(this.$1$10,e)},$1D:function(e){this.$1$10=ss.delegateRemove(this.$1$10,e)},$1A:function(e){this.$1$11=ss.delegateCombine(this.$1$11,e)},$1B:function(e){this.$1$11=ss.delegateRemove(this.$1$11,e)},$1E:function(e){this.$1$12=ss.delegateCombine(this.$1$12,e)},$1F:function(e){this.$1$12=ss.delegateRemove(this.$1$12,e)},get_handlerId:function(){return this.$1h.handlerId},set_handlerId:function(e){this.$1h.handlerId=e},get_iframe:function(){return this.$18},get_instanceId:function(){return this.$1b},set_instanceId:function(e){this.$1b=e},$12:function(){return this.$1i},$X:function(){return this.$17},$Z:function(){return this.$1c},$Y:function(){return this.$18.style.display==='none'},$10:function(){return this.$1h.parentElement},$11:function(){return this.$1h.get_baseUrl()},$14:function(){return this.$1l.get_workbook()},get__workbookImpl:function(){return this.$1l},$W:function(){return this.$16},$13:function(){return this.$1j},getCurrentUrlAsync:function(){var e=new tab._Deferred;var bY=new(ss.makeGenericType(bd,[String]))('api.GetCurrentUrlCommand',0,function(bZ){e.resolve(bZ)},function(bZ,ca){e.reject(G.createInternalError(ca))});this._sendCommand(String).call(this,null,bY);return e.get_promise()},handleVizListening:function(){this.$7()},handleVizLoad:function(){if(ss.isNullOrUndefined(this.$1l)){this.$1l=new K(this,this.$1d,ss.mkdel(this,function(){this.$t(null)}))}else if(!this.$1a){this.$1l._update(ss.mkdel(this,function(){this.$t(null)}))}},$1:function(e){var bY=this.$1j.chromeHeight;var bZ=this.$1j.sheetSize;var ca=0;var cb=0;if(bZ.behavior==='exactly'){ca=bZ.maxSize.width;cb=bZ.maxSize.height+bY}else{var cc;var cd;var ce;var cf;switch(bZ.behavior){case'range':{cc=bZ.minSize.width;cd=bZ.maxSize.width;ce=bZ.minSize.height+bY;cf=bZ.maxSize.height+bY;ca=Math.max(cc,Math.min(cd,e.width));cb=Math.max(ce,Math.min(cf,e.height));break}case'atleast':{cc=bZ.minSize.width;ce=bZ.minSize.height+bY;ca=Math.max(cc,e.width);cb=Math.max(ce,e.height);break}case'atmost':{cd=bZ.maxSize.width;cf=bZ.maxSize.height+bY;ca=Math.min(cd,e.width);cb=Math.min(cf,e.height);break}case'automatic':{ca=e.width;cb=Math.max(e.height,bY);break}default:{throw G.createInternalError('Unknown SheetSizeBehavior for viz: '+bZ.behavior.toString())}}}return bs.$ctor(ca,cb)},$9:function(){var e;if(ss.isValue(this.$19)){e=this.$19;this.$19=null}else{e=H.computeContentSize(this.$10())}this.$D(e);return this.$1(e)},$F:function(){if(!ss.isValue(this.$1j)){return}var e=this.$9();this.$L(e.width+'px',e.height+'px');var bY=10;for(var bZ=0;bZ<bY;bZ++){var ca=this.$9();if(ss.referenceEquals(JSON.stringify(e),JSON.stringify(ca))){return}e=ca;this.$L(e.width+'px',e.height+'px')}throw G.create('maxVizResizeAttempts','Viz resize limit hit. The calculated iframe size did not stabilize after '+bY+' resizes.')},handleEventNotification:function(e,bY){var bZ=q.deserialize(bY);switch(e){case'api.FirstVizSizeKnownEvent':{this.$g(bZ);break}case'api.VizInteractiveEvent':{this.$m(bZ);break}case'api.MarksSelectionChangedEvent':{this.$i(bZ);break}case'api.FilterChangedEvent':{this.$f(bZ);break}case'api.ParameterChangedEvent':{this.$j(bZ);break}case'api.CustomViewsListLoadedEvent':{this.$e(bZ);break}case'api.CustomViewUpdatedEvent':{this.$d(bZ);break}case'api.CustomViewRemovedEvent':{this.$b();break}case'api.CustomViewSetDefaultEvent':{this.$c(bZ);break}case'api.TabSwitchEvent':{this.$l(bZ);break}case'api.StorytellingStateChangedEvent':{this.$k(bZ);break}}},addEventListener:function(e,bY){var bZ={};if(!l.$2(bb).call(null,e,bZ)){throw G.createUnsupportedEventName(e.toString())}switch(bZ.$){case'marksselection':{this.$1w(bY);break}case'parametervaluechange':{this.$1y(bY);break}case'filterchange':{this.$1u(bY);break}case'customviewload':{this.$1m(bY);break}case'customviewsave':{this.$1q(bY);break}case'customviewremove':{this.$1o(bY);break}case'customviewsetdefault':{this.$1s(bY);break}case'tabswitch':{this.$1C(bY);break}case'storypointswitch':{this.$1A(bY);break}case'vizresize':{this.$1E(bY);break}}},removeEventListener:function(e,bY){var bZ={};if(!l.$2(bb).call(null,e,bZ)){throw G.createUnsupportedEventName(e.toString())}switch(bZ.$){case'marksselection':{this.$1x(bY);break}case'parametervaluechange':{this.$1z(bY);break}case'filterchange':{this.$1v(bY);break}case'customviewload':{this.$1n(bY);break}case'customviewsave':{this.$1r(bY);break}case'customviewremove':{this.$1p(bY);break}case'customviewsetdefault':{this.$1t(bY);break}case'tabswitch':{this.$1D(bY);break}case'storypointswitch':{this.$1B(bY);break}case'vizresize':{this.$1F(bY);break}}},$6:function(){if(ss.isValue(this.$18)){this.$18.parentNode.removeChild(this.$18);this.$18=null}I.$2(this.$1i);this.$1d.get_router().unregisterHandler(this);this.$G()},$N:function(){this.$18.style.display='block';this.$18.style.visibility='visible'},$n:function(){this.$18.style.display='none'},$q:function(){this.$18.style.visibility='hidden'},$R:function(){this.$p('showExportImageDialog')},$Q:function(e){var bY=this.$V(e);this.$p('showExportDataDialog',bY)},$P:function(e){var bY=this.$V(e);this.$p('showExportCrosstabDialog',bY)},$S:function(){this.$p('showExportPDFDialog')},$I:function(){var e=new tab._Deferred;var bY=new(ss.makeGenericType(bd,[Object]))('api.RevertAllCommand',1,function(bZ){e.resolve()},function(bZ,ca){e.reject(G.createServerError(ca))});this._sendCommand(Object).call(this,null,bY);return e.get_promise()},$E:function(){var e=new tab._Deferred;var bY=new(ss.makeGenericType(bd,[Object]))('api.RefreshDataCommand',1,function(bZ){e.resolve()},function(bZ,ca){e.reject(G.createServerError(ca))});this._sendCommand(Object).call(this,null,bY);return e.get_promise()},$T:function(){this.$p('showShareDialog')},$O:function(){if(this.get__workbookImpl().get_isDownloadAllowed()){this.$p('showDownloadWorkbookDialog')}else{throw G.create('downloadWorkbookNotAllowed','Download workbook is not allowed')}},$u:function(){return this.$o('pauseAutomaticUpdates')},$H:function(){return this.$o('resumeAutomaticUpdates')},$U:function(){return this.$o('toggleAutomaticUpdates')},$M:function(e,bY){this.$D(bs.$ctor(-1,-1));this.$L(e,bY);this.$1l._updateActiveSheetAsync()},$K:function(e){this.$16=e},$3:function(){return this.$1h.parentElement},$4:function(){try{I.$0(this.$1i)}catch(bY){var e=ss.Exception.wrap(bY);this.$6();throw e}if(!this.$1h.fixedSize){this.$19=H.computeContentSize(this.$10());if(this.$19.width===0||this.$19.height===0){this.$19=bs.$ctor(800,600)}this.$18=this.$5();this.$q()}else{this.$18=this.$5();this.$N()}if(!H.hasWindowPostMessage()){if(H.isIE()){this.$18['onreadystatechange']=this.$a()}else{this.$18.onload=this.$a()}}this.$1c=!this.$1h.toolbar;this.$17=!this.$1h.tabs;this.$1d.get_router().registerHandler(this);this.$18.src=this.$1h.get_url()},$J:function(){try{if(!H.hasWindowPostMessage()||ss.isNullOrUndefined(this.$18)||!ss.isValue(this.$18.contentWindow)){return}}catch(ca){return}var e=H.visibleContentRectInDocumentCoordinates(this.get_iframe());var bY=H.contentRectInDocumentCoordinates(this.get_iframe());var bZ=[];bZ.push('layoutInfoResp'.toString());bZ.push(e.left-bY.left);bZ.push(e.top-bY.top);bZ.push(e.width);bZ.push(e.height);this.$18.contentWindow.postMessage(bZ.join(','),'*')},$7:function(){if(!H.hasWindowPostMessage()||ss.isNullOrUndefined(this.$18)||!ss.isValue(this.$18.contentWindow)){return}this.$18.contentWindow.postMessage('tableau.enableVisibleRectCommunication'.toString(),'*')},_sendCommand:function(e){return function(bY,bZ){this.$1d.sendCommand(e).call(this.$1d,bY,bZ)}},$A:function(e){if(!ss.staticEquals(this.$1$5,null)){this.$1$5(new bo('parametervaluechange',this.$1i,e))}},$v:function(e){this.get__workbookImpl()._update(ss.mkdel(this,function(){if(!ss.staticEquals(this.$1$6,null)){this.$1$6(new bf('customviewload',this.$1i,(ss.isValue(e)?e._impl:null)))}}))},$x:function(e){this.get__workbookImpl()._update(ss.mkdel(this,function(){if(!ss.staticEquals(this.$1$7,null)){this.$1$7(new bf('customviewsave',this.$1i,e._impl))}}))},$w:function(e){if(!ss.staticEquals(this.$1$8,null)){this.$1$8(new bf('customviewremove',this.$1i,e._impl))}},$y:function(e){if(!ss.staticEquals(this.$1$9,null)){this.$1$9(new bf('customviewsetdefault',this.$1i,e._impl))}},$C:function(e,bY){if(!ss.staticEquals(this.$1$10,null)){this.$1$10(new bw('tabswitch',this.$1i,e,bY))}},raiseStoryPointSwitch:function(e,bY){if(!ss.staticEquals(this.$1$11,null)){this.$1$11(new bu('storypointswitch',this.$1i,e,bY))}},$B:function(){if(!ss.staticEquals(this.$1$2,null)){this.$1$2(this)}},$z:function(){if(!ss.staticEquals(this.$1$1,null)){this.$1$1(this)}},$D:function(e){if(!ss.staticEquals(this.$1$12,null)){this.$1$12(new by('vizresize',this.$1i,e))}},$L:function(e,bY){this.$1h.width=e;this.$1h.height=bY;this.$18.style.width=this.$1h.width;this.$18.style.height=this.$1h.height},$V:function(e){if(ss.isNullOrUndefined(e)){return null}var bY=this.$1l.$4(e);if(ss.isNullOrUndefined(bY)){throw G.createNotActiveSheet()}return bY.get_name()},$o:function(e){if(e!=='pauseAutomaticUpdates'&&e!=='resumeAutomaticUpdates'&&e!=='toggleAutomaticUpdates'){throw G.createInternalError(null)}var bY={};bY['api.invokeCommandName']=e;var bZ=new tab._Deferred;var ca=new(ss.makeGenericType(bd,[Object]))('api.InvokeCommandCommand',0,ss.mkdel(this,function(cb){if(ss.isValue(cb)&&ss.isValue(cb.isAutoUpdate)){this.$16=!cb.isAutoUpdate}bZ.resolve(this.$16)}),function(cb,cc){bZ.reject(G.createServerError(cc))});this._sendCommand(Object).call(this,bY,ca);return bZ.get_promise()},$p:function(e,bY){if(e!=='showExportImageDialog'&&e!=='showExportDataDialog'&&e!=='showExportCrosstabDialog'&&e!=='showExportPDFDialog'&&e!=='showShareDialog'&&e!=='showDownloadWorkbookDialog'){throw G.createInternalError(null)}var bZ={};bZ['api.invokeCommandName']=e;if(ss.isValue(bY)){bZ['api.invokeCommandParam']=bY}var ca=new(ss.makeGenericType(bd,[Object]))('api.InvokeCommandCommand',0,null,null);this._sendCommand(Object).call(this,bZ,ca)},$g:function(e){var bY=JSON.parse(e.get_data());this.$h(bY)},$m:function(e){if(ss.isValue(this.$1l)&&ss.referenceEquals(this.$1l.get_name(),e.get_workbookName())){this.$t(null)}else{this.$B()}},$i:function(e){if(ss.staticEquals(this.$1$3,null)||!ss.referenceEquals(this.$1l.get_name(),e.get_workbookName())){return}var bY=null;var bZ=this.$1l.get_activeSheetImpl();if(bZ.get_isStory()){bZ=bZ.get_activeStoryPointImpl().get_containedSheetImpl()}if(ss.referenceEquals(bZ.get_name(),e.get_worksheetName())){bY=bZ}else if(bZ.get_isDashboard()){var ca=bZ;bY=ca.get_worksheets()._get(e.get_worksheetName())._impl}if(ss.isValue(bY)){bY.set_selectedMarks(null);this.$1$3(new bn('marksselection',this.$1i,bY))}},$f:function(e){if(!ss.staticEquals(this.$1$4,null)){if(ss.referenceEquals(this.$1l.get_name(),e.get_workbookName())){var bY=null;var bZ=this.$1l.get_activeSheetImpl();if(ss.referenceEquals(bZ.get_name(),e.get_worksheetName())){bY=bZ}else if(bZ.get_isDashboard()){var ca=bZ;bY=ca.get_worksheets()._get(e.get_worksheetName())._impl}if(ss.isValue(bY)){var cb=JSON.parse(e.get_data());var cc=cb[0];var cd=cb[1];this.$1$4(new bi('filterchange',this.$1i,bY,cc,cd))}}}},$j:function(e){if(!ss.staticEquals(this.$1$5,null)){if(ss.referenceEquals(this.$1l.get_name(),e.get_workbookName())){this.$1l.$l(null);var bY=e.get_data();this.$A(bY)}}},$e:function(e){var bY=JSON.parse(e.get_data());var bZ=ss.mkdel(this,function(){t._processCustomViews(this.$1l,this.$1d,bY)});var ca=ss.mkdel(this,function(){this.$z();if(!ss.staticEquals(this.$1$6,null)&&!bY.customViewLoaded){this.$v(this.$1l.get_activeCustomView())}});if(ss.isNullOrUndefined(this.$1l)){this.$1a=true;this.$1l=new K(this,this.$1d,ss.mkdel(this,function(){bZ();this.$t(ca);this.$1a=false}))}else{bZ();this.$8(ca)}},$d:function(e){var bY=JSON.parse(e.get_data());if(ss.isNullOrUndefined(this.$1l)){this.$1l=new K(this,this.$1d,null)}if(ss.isValue(this.$1l)){t._processCustomViewUpdate(this.$1l,this.$1d,bY,true)}if(!ss.staticEquals(this.$1$7,null)){var bZ=this.$1l.$p()._toApiCollection();for(var ca=0,cb=bZ.length;ca<cb;ca++){this.$x(bZ[ca])}}},$b:function(){if(!ss.staticEquals(this.$1$8,null)){var e=this.$1l.$n()._toApiCollection();for(var bY=0,bZ=e.length;bY<bZ;bY++){this.$w(e[bY])}}},$c:function(e){var bY=JSON.parse(e.get_data());if(ss.isValue(this.$1l)){t._processCustomViews(this.$1l,this.$1d,bY)}if(!ss.staticEquals(this.$1$9,null)&&ss.isValue(bY.defaultCustomViewId)){var bZ=this.$1l.$i();for(var ca=0;ca<bZ.get__length();ca++){var cb=bZ.get_item(ca);if(cb.getDefault()){this.$y(cb);break}}}},$l:function(e){this.$1l._update(ss.mkdel(this,function(){if(ss.isValue(this.$15)){this.$15()}if(ss.referenceEquals(this.$1l.get_name(),e.get_workbookName())){var bY=e.get_worksheetName();var bZ=e.get_data();this.$C(bY,bZ)}this.$t(null)}))},$k:function(e){var bY=this.$1l.get_activeSheetImpl();if(bY.get_sheetType()==='story'){bY.update(JSON.parse(e.get_data()))}},$t:function(e){if(!this.$1e){var bY=this.$1f;window.setTimeout(ss.mkdel(this,function(){if(!ss.staticEquals(bY,null)){bY(new bv('firstinteractive',this.$1i))}if(!ss.staticEquals(e,null)){e()}}),0);this.$1e=true}this.$B()},$8:function(e){var bY=new Date;var bZ=null;bZ=ss.mkdel(this,function(){var ca=new Date;if(this.$1e){e()}else if(ca-bY>300000){throw G.createInternalError('Timed out while waiting for the viz to become interactive')}else{window.setTimeout(bZ,10)}});bZ()},$2:function(){if(H.isIE()){if(this.$18['readyState']==='complete'){this.handleVizLoad()}}else{this.handleVizLoad()}},$r:function(){window.setTimeout(ss.mkdel(this,this.$2),3000)},$5:function(){if(ss.isNullOrUndefined(this.$3())){return null}var e=document.createElement('IFrame');e.frameBorder='0';e.setAttribute('allowTransparency','true');e.marginHeight='0';e.marginWidth='0';e.style.display='block';if(this.$1h.fixedSize){e.style.width=this.$1h.width;e.style.height=this.$1h.height}else{e.style.width='1px';e.style.height='1px';e.setAttribute('scrolling','no')}if(H.isSafari()){e.addEventListener('mousewheel',ss.mkdel(this,this.$s),false)}this.$3().appendChild(e);return e},$s:function(e){},$a:function(){return ss.mkdel(this,function(e){this.$r()})},$h:function(e){var bY=br.fromSizeConstraints(e.sizeConstraints);this.$1j=bz.$ctor(bY,e.chromeHeight);if(ss.isValue(this.$1g)){this.$1g(new bj('firstvizsizeknown',this.$1i,this.$1j))}if(this.$1h.fixedSize){return}this.$F();this.$0();this.$N()},$G:function(){if(ss.isNullOrUndefined(this.$1k)){return}if(H.hasWindowAddEventListener()){window.removeEventListener('resize',this.$1k,false)}else{window.self.detachEvent('onresize',this.$1k)}this.$1k=null},$0:function(){if(ss.isValue(this.$1k)){return}this.$1k=ss.mkdel(this,function(){this.$F()});if(H.hasWindowAddEventListener()){window.addEventListener('resize',this.$1k,false)}else{window.self.attachEvent('onresize',this.$1k)}}},null,[bk]);ss.initClass(by,a,{getAvailableSize:function(){return this.$2}},bv);ss.initClass(bz,a,{},Object);ss.initClass(bH,a,{getFilterType:function(){return this.$6},getFieldName:function(){return this.$1},getWorksheet:function(){return this.$7.get_worksheet()},getFieldAsync:function(){var e=new tab._Deferred;if(ss.isNullOrUndefined(this.$3)){var bY=function(ca){e.reject(ca);return null};var bZ=ss.mkdel(this,function(ca){this.$3=new bG(ca,this.$1,this.$5,this.$4);e.resolve(this.$3);return null});this.$7.$p(this.$2).then(bZ,bY)}else{window.setTimeout(ss.mkdel(this,function(){e.resolve(this.$3)}),0)}return e.get_promise()},_update:function(e){this.$0(e);this._updateFromJson(e)},_addFieldParams:function(e){},_updateFromJson:null,$0:function(e){this.$1=e.caption;this.$6=O.convertFilterType(e.filterType);this.$3=null;this.$2=e.dataSourceName;this.$5=O.convertFieldRole(ss.coalesce(e.fieldRole,'unknown'));this.$4=O.convertFieldAggregation(ss.coalesce(e.fieldAggregation,'NONE'))}});ss.initClass(bB,a,{getIsExcludeMode:function(){return this.$a},getAppliedValues:function(){return this.$9},_updateFromJson:function(e){this.$8(e)},$8:function(e){this.$a=e.isExclude;if(ss.isValue(e.appliedValues)){this.$9=[];for(var bY=0;bY<e.appliedValues.length;bY++){var bZ=e.appliedValues[bY];this.$9.push(H.getDataValue(bZ))}}}},bH);ss.initClass(bC,a,{getWorkbook:function(){return this._impl.$b()},getUrl:function(){return this._impl.$a()},getName:function(){return this._impl.$7()},setName:function(e){this._impl.$8(e)},getOwnerName:function(){return this._impl.$9()},getAdvertised:function(){return this._impl.$3()},setAdvertised:function(e){this._impl.$4(e)},getDefault:function(){return this._impl.$6()},saveAsync:function(){return this._impl.$2()}});ss.initClass(bO,a,{getName:function(){return this._impl.get_name()},getIndex:function(){return this._impl.get_index()},getWorkbook:function(){return this._impl.get_workbookImpl().get_workbook()},getSize:function(){return this._impl.get_size()},getIsHidden:function(){return this._impl.get_isHidden()},getIsActive:function(){return this._impl.get_isActive()},getSheetType:function(){return this._impl.get_sheetType()},getUrl:function(){return this._impl.get_url()},changeSizeAsync:function(e){return this._impl.changeSizeAsync(e)}});ss.initClass(bD,a,{getParentStoryPoint:function(){return this._impl.get_parentStoryPoint()},getObjects:function(){return this._impl.get_objects()._toApiCollection()},getWorksheets:function(){return this._impl.get_worksheets()._toApiCollection()}},bO);ss.initClass(bE,a,{getObjectType:function(){return this.$2.objectType},getDashboard:function(){return this.$0},getWorksheet:function(){return this.$1},getPosition:function(){return this.$2.position},getSize:function(){return this.$2.size}});ss.initClass(bF,a,{getName:function(){return this.$0.get_name()},getFields:function(){return this.$0.get_fields()._toApiCollection()},getIsPrimary:function(){return this.$0.get_isPrimary()}});ss.initClass(bG,a,{getDataSource:function(){return this.$0},getName:function(){return this.$3},getRole:function(){return this.$2},getAggregation:function(){return this.$1}});ss.initClass(bI,a,{_addFieldParams:function(e){e['api.filterHierarchicalLevels']=this.$9},_updateFromJson:function(e){this.$8(e)},$8:function(e){this.$9=e.levels}},bH);ss.initClass(bJ,a,{getPairs:function(){return this.$0.$1()}});ss.initClass(bK,a,{});ss.initClass(bL,a,{getName:function(){return this._impl.$7()},getCurrentValue:function(){return this._impl.$2()},getDataType:function(){return this._impl.$3()},getAllowableValuesType:function(){return this._impl.$1()},getAllowableValues:function(){return this._impl.$0()},getMinValue:function(){return this._impl.$6()},getMaxValue:function(){return this._impl.$5()},getStepSize:function(){return this._impl.$9()},getDateStepPeriod:function(){return this._impl.$4()}});ss.initClass(bM,a,{getMin:function(){return this.$d},getMax:function(){return this.$c},getIncludeNullValues:function(){return this.$b},getDomainMin:function(){return this.$a},getDomainMax:function(){return this.$9},_updateFromJson:function(e){this.$8(e)},$8:function(e){this.$a=H.getDataValue(e.domainMinValue);this.$9=H.getDataValue(e.domainMaxValue);this.$d=H.getDataValue(e.minValue);this.$c=H.getDataValue(e.maxValue);this.$b=e.includeNullValues}},bH);ss.initClass(bN,a,{getPeriod:function(){return this.$9},getRange:function(){return this.$b},getRangeN:function(){return this.$a},_updateFromJson:function(e){this.$8(e)},$8:function(e){if(ss.isValue(e.periodType)){this.$9=O.convertPeriodType(ss.unbox(e.periodType))}if(ss.isValue(e.rangeType)){this.$b=O.convertDateRange(ss.unbox(e.rangeType))}if(ss.isValue(e.rangeN)){this.$a=ss.unbox(e.rangeN)}}},bH);ss.initClass(bP,a,{getName:function(){return this.$0.name},getSheetType:function(){return this.$0.sheetType},getSize:function(){return this.$0.size},getIndex:function(){return this.$0.index},getUrl:function(){return this.$0.url},getIsActive:function(){return this.$0.isActive},getIsHidden:function(){return this.$0.isHidden},getWorkbook:function(){return this.$0.workbook}});ss.initClass(bQ,a,{getActiveStoryPoint:function(){return this._impl.get_activeStoryPointImpl().get_storyPoint()},getStoryPointsInfo:function(){return this._impl.get_storyPointsInfo()},activatePreviousStoryPointAsync:function(){return this._impl.activatePreviousStoryPointAsync()},activateNextStoryPointAsync:function(){return this._impl.activateNextStoryPointAsync()},activateStoryPointAsync:function(e){return this._impl.activateStoryPointAsync(e)},revertStoryPointAsync:function(e){return this._impl.revertStoryPointAsync(e)}},bO);ss.initClass(bR,a,{getCaption:function(){return this.$0.get_caption()},getContainedSheet:function(){return(ss.isValue(this.$0.get_containedSheetImpl())?this.$0.get_containedSheetImpl().get_sheet():null)},getIndex:function(){return this.$0.get_index()},getIsActive:function(){return this.$0.get_isActive()},getIsUpdated:function(){return this.$0.get_isUpdated()},getParentStory:function(){return this.$0.get_parentStoryImpl().get_story()}});ss.initClass(bS,a,{getCaption:function(){return this._impl.caption},getIndex:function(){return this._impl.index},getIsActive:function(){return this._impl.isActive},getIsUpdated:function(){return this._impl.isUpdated},getParentStory:function(){return this._impl.parentStoryImpl.get_story()}});ss.initClass(bT,a,{getMajor:function(){return this.$0},getMinor:function(){return this.$2},getPatch:function(){return this.$3},getMetadata:function(){return this.$1},toString:function(){var e=this.$0+'.'+this.$2+'.'+this.$3;if(ss.isValue(this.$1)&&this.$1.length>0){e+='-'+this.$1}return e}});ss.initClass(bU,a,{getAreTabsHidden:function(){return this._impl.$X()},getIsToolbarHidden:function(){return this._impl.$Z()},getIsHidden:function(){return this._impl.$Y()},getInstanceId:function(){return this._impl.get_instanceId()},getParentElement:function(){return this._impl.$10()},getUrl:function(){return this._impl.$11()},getVizSize:function(){return this._impl.$13()},getWorkbook:function(){return this._impl.$14()},getAreAutomaticUpdatesPaused:function(){return this._impl.$W()},getCurrentUrlAsync:function(){return this._impl.getCurrentUrlAsync()},addEventListener:function(e,bY){this._impl.addEventListener(e,bY)},removeEventListener:function(e,bY){this._impl.removeEventListener(e,bY)},dispose:function(){this._impl.$6()},show:function(){this._impl.$N()},hide:function(){this._impl.$n()},showExportDataDialog:function(e){this._impl.$Q(e)},showExportCrossTabDialog:function(e){this._impl.$P(e)},showExportImageDialog:function(){this._impl.$R()},showExportPDFDialog:function(){this._impl.$S()},revertAllAsync:function(){return this._impl.$I()},refreshDataAsync:function(){return this._impl.$E()},showShareDialog:function(){this._impl.$T()},showDownloadWorkbookDialog:function(){this._impl.$O()},pauseAutomaticUpdatesAsync:function(){return this._impl.$u()},resumeAutomaticUpdatesAsync:function(){return this._impl.$H()},toggleAutomaticUpdatesAsync:function(){return this._impl.$U()},refreshSize:function(){this._impl.$F()},setFrameSize:function(e,bY){var bZ=e;var ca=bY;if(H.isNumber(e)){bZ=e.toString()+'px'}if(H.isNumber(bY)){ca=bY.toString()+'px'}this._impl.$M(bZ,ca)}});ss.initClass(bV,a,{});ss.initClass(bW,a,{getViz:function(){return this.$0.get_viz()},getPublishedSheetsInfo:function(){return this.$0.get_publishedSheets()._toApiCollection()},getName:function(){return this.$0.get_name()},getActiveSheet:function(){return this.$0.get_activeSheetImpl().get_sheet()},getActiveCustomView:function(){return this.$0.get_activeCustomView()},activateSheetAsync:function(e){return this.$0._setActiveSheetAsync(e)},revertAllAsync:function(){return this.$0._revertAllAsync()},getCustomViewsAsync:function(){return this.$0.$6()},showCustomViewAsync:function(e){return this.$0.$f(e)},removeCustomViewAsync:function(e){return this.$0.$c(e)},rememberCustomViewAsync:function(e){return this.$0.$b(e)},setActiveCustomViewAsDefaultAsync:function(){return this.$0.$e()},getParametersAsync:function(){return this.$0.$7()},changeParameterValueAsync:function(e,bY){return this.$0.$2(e,bY)}});ss.initClass(bX,a,{getParentDashboard:function(){return this._impl.get_parentDashboard()},getParentStoryPoint:function(){return this._impl.get_parentStoryPoint()},getDataSourcesAsync:function(){return this._impl.$q()},getFilterAsync:function(e,bY){return this._impl.$r(null,e,bY)},getFiltersAsync:function(e){return this._impl.$s(e)},applyFilterAsync:function(e,bY,bZ,ca){return this._impl.$e(e,bY,bZ,ca)},clearFilterAsync:function(e){return this._impl.$m(e)},applyRangeFilterAsync:function(e,bY){return this._impl.$i(e,bY)},applyRelativeDateFilterAsync:function(e,bY){return this._impl.$k(e,bY)},applyHierarchicalFilterAsync:function(e,bY,bZ,ca){return this._impl.$g(e,bY,bZ,ca)},clearSelectedMarksAsync:function(){return this._impl.$o()},selectMarksAsync:function(e,bY,bZ){return this._impl.$v(e,bY,bZ)},getSelectedMarksAsync:function(){return this._impl.$t()}},bO);(function(){o.crossDomainEventNotificationId='xdomainSourceId';o.$0=0})();(function(){x.$0='array';x.$1='boolean';x.$2='date';x.$3='function';x.$4='number';x.$5='object';x.$6='regexp';x.$7='string';x.$8=ss.mkdict(['[object Boolean]','boolean','[object Number]','number','[object String]','string','[object Function]','function','[object Array]','array','[object Date]','date','[object RegExp]','regexp','[object Object]','object']);x.$e=String.prototype['trim'];x.$d=Object.prototype['toString'];x.$f=new RegExp('^[\\s\\xA0]+');x.$g=new RegExp('[\\s\\xA0]+$');x.$a=new RegExp('^[\\],:{}\\s]*$');x.$b=new RegExp('\\\\(?:["\\\\\\/bfnrt]|u[0-9a-fA-F]{4})','g');x.$c=new RegExp('"[^"\\\\\\n\\r]*"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?','g');x.$9=new RegExp('(?:^|:|,)(?:\\s*\\[)+','g')})();(function(){bm.$6='\t'})();(function(){I.$5=[]})();(function(){var e=global.tableauSoftware;e.DashboardObjectType={BLANK:'blank',WORKSHEET:'worksheet',QUICK_FILTER:'quickFilter',PARAMETER_CONTROL:'parameterControl',PAGE_FILTER:'pageFilter',LEGEND:'legend',TITLE:'title',TEXT:'text',IMAGE:'image',WEB_PAGE:'webPage'};e.DateRangeType={LAST:'last',LASTN:'lastn',NEXT:'next',NEXTN:'nextn',CURR:'curr',TODATE:'todate'};e.ErrorCode={INTERNAL_ERROR:'internalError',SERVER_ERROR:'serverError',INVALID_AGGREGATION_FIELD_NAME:'invalidAggregationFieldName',INVALID_PARAMETER:'invalidParameter',INVALID_URL:'invalidUrl',STALE_DATA_REFERENCE:'staleDataReference',VIZ_ALREADY_IN_MANAGER:'vizAlreadyInManager',NO_URL_OR_PARENT_ELEMENT_NOT_FOUND:'noUrlOrParentElementNotFound',INVALID_FILTER_FIELDNAME:'invalidFilterFieldName',INVALID_FILTER_FIELDVALUE:'invalidFilterFieldValue',INVALID_FILTER_FIELDNAME_OR_VALUE:'invalidFilterFieldNameOrValue',FILTER_CANNOT_BE_PERFORMED:'filterCannotBePerformed',NOT_ACTIVE_SHEET:'notActiveSheet',INVALID_CUSTOM_VIEW_NAME:'invalidCustomViewName',MISSING_RANGEN_FOR_RELATIVE_DATE_FILTERS:'missingRangeNForRelativeDateFilters',MISSING_MAX_SIZE:'missingMaxSize',MISSING_MIN_SIZE:'missingMinSize',MISSING_MINMAX_SIZE:'missingMinMaxSize',INVALID_SIZE:'invalidSize',INVALID_SIZE_BEHAVIOR_ON_WORKSHEET:'invalidSizeBehaviorOnWorksheet',SHEET_NOT_IN_WORKBOOK:'sheetNotInWorkbook',INDEX_OUT_OF_RANGE:'indexOutOfRange',DOWNLOAD_WORKBOOK_NOT_ALLOWED:'downloadWorkbookNotAllowed',NULL_OR_EMPTY_PARAMETER:'nullOrEmptyParameter',BROWSER_NOT_CAPABLE:'browserNotCapable',UNSUPPORTED_EVENT_NAME:'unsupportedEventName',INVALID_DATE_PARAMETER:'invalidDateParameter',INVALID_SELECTION_FIELDNAME:'invalidSelectionFieldName',INVALID_SELECTION_VALUE:'invalidSelectionValue',INVALID_SELECTION_DATE:'invalidSelectionDate',NO_URL_FOR_HIDDEN_WORKSHEET:'noUrlForHiddenWorksheet',MAX_VIZ_RESIZE_ATTEMPTS:'maxVizResizeAttempts'};e.FieldAggregationType={SUM:'SUM',AVG:'AVG',MIN:'MIN',MAX:'MAX',STDEV:'STDEV',STDEVP:'STDEVP',VAR:'VAR',VARP:'VARP',COUNT:'COUNT',COUNTD:'COUNTD',MEDIAN:'MEDIAN',ATTR:'ATTR',NONE:'NONE',PERCENTILE:'PERCENTILE',YEAR:'YEAR',QTR:'QTR',MONTH:'MONTH',DAY:'DAY',HOUR:'HOUR',MINUTE:'MINUTE',SECOND:'SECOND',WEEK:'WEEK',WEEKDAY:'WEEKDAY',MONTHYEAR:'MONTHYEAR',MDY:'MDY',END:'END',TRUNC_YEAR:'TRUNC_YEAR',TRUNC_QTR:'TRUNC_QTR',TRUNC_MONTH:'TRUNC_MONTH',TRUNC_WEEK:'TRUNC_WEEK',TRUNC_DAY:'TRUNC_DAY',TRUNC_HOUR:'TRUNC_HOUR',TRUNC_MINUTE:'TRUNC_MINUTE',TRUNC_SECOND:'TRUNC_SECOND',QUART1:'QUART1',QUART3:'QUART3',SKEWNESS:'SKEWNESS',KURTOSIS:'KURTOSIS',INOUT:'INOUT',SUM_XSQR:'SUM_XSQR',USER:'USER'};e.FieldRoleType={DIMENSION:'dimension',MEASURE:'measure',UNKNOWN:'unknown'};e.FilterUpdateType={ALL:'all',REPLACE:'replace',ADD:'add',REMOVE:'remove'};e.FilterType={CATEGORICAL:'categorical',QUANTITATIVE:'quantitative',HIERARCHICAL:'hierarchical',RELATIVEDATE:'relativedate'};e.NullOption={NULL_VALUES:'nullValues',NON_NULL_VALUES:'nonNullValues',ALL_VALUES:'allValues'};e.ParameterAllowableValuesType={ALL:'all',LIST:'list',RANGE:'range'};e.ParameterDataType={FLOAT:'float',INTEGER:'integer',STRING:'string',BOOLEAN:'boolean',DATE:'date',DATETIME:'datetime'};e.PeriodType={YEAR:'year',QUARTER:'quarter',MONTH:'month',WEEK:'week',DAY:'day',HOUR:'hour',MINUTE:'minute',SECOND:'second'};e.SelectionUpdateType={REPLACE:'replace',ADD:'add',REMOVE:'remove'};e.SheetSizeBehavior={AUTOMATIC:'automatic',EXACTLY:'exactly',RANGE:'range',ATLEAST:'atleast',ATMOST:'atmost'};e.SheetType={WORKSHEET:'worksheet',DASHBOARD:'dashboard',STORY:'story'};e.TableauEventName={CUSTOM_VIEW_LOAD:'customviewload',CUSTOM_VIEW_REMOVE:'customviewremove',CUSTOM_VIEW_SAVE:'customviewsave',CUSTOM_VIEW_SET_DEFAULT:'customviewsetdefault',FILTER_CHANGE:'filterchange',FIRST_INTERACTIVE:'firstinteractive',FIRST_VIZ_SIZE_KNOWN:'firstvizsizeknown',MARKS_SELECTION:'marksselection',PARAMETER_VALUE_CHANGE:'parametervaluechange',STORY_POINT_SWITCH:'storypointswitch',TAB_SWITCH:'tabswitch',VIZ_RESIZE:'vizresize'};e.ToolbarPosition={TOP:'top',BOTTOM:'bottom'}})();(function(){p.$4=null;p.$5=null})();(function(){B.noZoneId=4294967295})();(function(){L.$5=new RegExp('\\[[^\\]]+\\]\\.','g')})();(function(){bT.$0=new bT(2,0,3,'null')})()})();window.tableau=window.tableauSoftware=global.tableauSoftware;tableauSoftware.Promise=tab._PromiseImpl;tab._Deferred=tab._DeferredImpl;tab._Collection=tab._CollectionImpl;tab._ApiBootstrap.initialize()})();
module.exports = global.tableauSoftware;